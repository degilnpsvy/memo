<H3 class=docSection1Title>6.4. Editing a Macro</H3>
<P class=docText><FONT class=extract>You can edit a macro and </FONT><A name=gnu3-CHP-6-ITERM-2269></A><A name=gnu3-CHP-6-ITERM-2270></A><FONT class=extract>make changes to it in a few different ways. For this example, we chose an all-purpose editing command, <SPAN class=docEmphBold>edit-kbd-macro</SPAN>, which is bound to <SPAN class=docEmphBold>C-x C-k e</SPAN>. Several macro editing commands are available, but this one works for all types of macros, so it's good to learn.</FONT></P>
<P class=docText>Our macro could use a bit of tweaking. First of all, finding references to Emacs in our copy of the Emacs <SPAN class=docEmphasis>NEWS</SPAN> file is pretty lame. Perhaps we're interested in using a mouse more frequently with Emacs and would like to know about changes to that part of the interface. We'll edit the macro to search for the word <SPAN class=docEmphasis>mouse</SPAN>. We'll also modify it so it marks a paragraph rather than a sentence since a sentence doesn't really provide enough context to be helpful.</P>
<P class=docText>Let's start editing the macro.</P><A name=ch06-6-fm2xml></A>
<TABLE cellSpacing=0 cellPadding=4 rules=all width="100%" border=1>
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>Type: <SPAN class=docEmphBold>C-x C-k e</SPAN></P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn04.gif" width=425 height=138> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>Emacs prompts you for the type of macro to edit.</P></TD></TR></TBODY></TABLE><BR>
<P class=docText><FONT class=extract>Emacs asks you if you want to edit the last keyboard macro (<SPAN class=docEmphBold>C-x e</SPAN>), a named macro (<SPAN class=docEmphBold>M-x</SPAN>), the last 100 keystrokes as a macro, termed "lossage" (<SPAN class=docEmphBold>C-h l</SPAN>), or keys (meaning the keystrokes you bound a macro to).</FONT> Yes, that's a lot of choices, and later in the chapter we describe named macros and binding macros to keys (you can experiment on your own with creating a macro from lossage). For now, just choose <SPAN class=docEmphBold>C-x e</SPAN> to edit the last keyboard macro.</P><A name=ch06-7-fm2xml></A>
<TABLE cellSpacing=0 cellPadding=4 rules=all width="100%" border=1>
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>Type: <SPAN class=docEmphBold>C-x e</SPAN></P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn05.gif" width=384 height=295> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>Emacs opens an <TT>*Edit Macro*</TT> buffer.</P></TD></TR></TBODY></TABLE><BR>
<P class=docText>Notice two fields near the top of this buffer, <TT>Command</TT>: and <TT>Key</TT>:. Right now, <TT>Command</TT>: says <TT>last-kbd-macro</TT>. If this were a named macro, the command would be the name you gave your macro. Additionally, for frequent use, you can bind your macro to a key, at which point the <TT>Key</TT>: field lists the keystrokes to execute this macro. Right now it says <TT>none</TT> because we haven't defined any keystrokes yet.</P>
<P class=docText>Note that Emacs inserts comments all through the macro. It's attempting to map keystrokes to commands. You do not need to update these comments or add comments if you add commands to your macro; Emacs does that itself.</P>
<P class=docText>To tweak our macro, we change the search string on the second line from <SPAN class=docEmphasis>emacs</SPAN> to <SPAN class=docEmphasis>mouse</SPAN>. Note that we can just press <SPAN class=docEmphBold>C-k</SPAN> to wipe out the line and type mouse. Now change <SPAN class=docEmphBold>M-a</SPAN> to <SPAN class=docEmphBold>M-{</SPAN> and <SPAN class=docEmphBold>M-e</SPAN> to <SPAN class=docEmphBold>M-}</SPAN>. We change the buffer name from <TT>emacsrefs</TT> to <TT>mouseinfo</TT>.</P><A name=ch06-8-fm2xml></A>
<TABLE cellSpacing=0 cellPadding=4 rules=all width="100%" border=1>
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>We've made the edits from the previous paragraph. The screen looks like this:</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn06.gif" width=384 height=295> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>A modified macro that captures information about using a mouse in Emacs.</P></TD></TR></TBODY></TABLE><BR>
<P class=docText><FONT class=extract>To exit the macro editing buffer, we have to type <SPAN class=docEmphBold>C-c C-c</SPAN> and go back to our <TT>NEWS</TT> buffer.</FONT> Let's do that and then execute the macro again to see what happens.</P><A name=ch06-9-fm2xml></A>
<TABLE cellSpacing=0 cellPadding=4 rules=all width="100%" border=1>
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>Type: <SPAN class=docEmphBold>C-c C-c C-x b Enter M-&lt; M-5 F4 C-x b Enter M-&lt;</SPAN></P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn07.gif" width=425 height=257> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>The <TT>mouseinfo</TT> buffer shows paragraphs from our copied <SPAN class=docEmphasis>NEWS</SPAN> file that mention the mouse.</P></TD></TR></TBODY></TABLE>