<H3 class=docSection1Title>6.10. Beyond Macros</H3>
<P class=docText>Macros are an important tool for streamlining repetitive editing. They let you write your own commands for performing complex tasks without needing to know anything more than you already know: the basic Emacs commands for moving around and manipulating text. Even if you're an Emacs novice, you should be able to use macros with little difficulty.</P>
<P class=docText>However, Emacs is almost infinitely flexible, and macros cannot do everything. In many situations, there's no substitute for writing a Lisp function that does exactly what you want. If you know Lisp or would like to learn some, you can write your own Lisp functions to do more complex tasks than keyboard macros can handle. <A class=docLink href="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/gnu3-chp-11.html#gnu3-chp-11">Chapter 11</A> covers the basics of writing Lisp functions.</P>
<P class=docText><A class=docLink href="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/gnu3-chp-6-sect-10.html#gnu3-chp-6-table-6">Table 6-6</A> summarizes <A name=gnu3-CHP-6-ITERM-2294></A><A name=gnu3-CHP-6-ITERM-2295></A>macro commands.</P><A name=gnu3-CHP-6-TABLE-6></A>
<H5 class=docTableTitle>Table 6-6. Macro commands</H5>
<TABLE border=1 rules=all cellSpacing=0 cellPadding=4 width="100%">
<COLGROUP>
<COL>
<COL>
<COL></COLGROUP>
<THEAD>
<TR>
<TH class=thead scope=col>
<P class=docText>Keystrokes</P></TH>
<TH class=thead scope=col>
<P class=docText>Command name</P></TH>
<TH class=thead scope=col>
<P class=docText>Action</P></TH></TR></THEAD>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x (</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-start-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Start macro definition.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>F3</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-start-macro-or-insert-counter</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Start macro definition. If pressed while defining a macro, insert a counter.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x )</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-end-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>End macro definition.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>F4</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-end-or-call-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>End macro definition (if definition is in progress) or invoke last keyboard macro.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x e</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-end-and-call-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Execute last keyboard macro defined. Can type <SPAN class=docEmphBold>e</SPAN> to repeat macro.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k n</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>name-last-kbd-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Name the last macro you created (before saving it).</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>(<SPAN class=docEmphasis>none</SPAN>)</P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>insert-kbd-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Insert the macro you named into a file.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>(<SPAN class=docEmphasis>none</SPAN>)</P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphasis>macroname</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Execute a named keyboard macro.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x q</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kbd-macro-query</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Insert a query in a macro definition.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-u C-x q</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>(none)</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Insert a recursive edit in a macro definition.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-M-c</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>exit-recursive-edit</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Exit a recursive edit.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k b</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-bind-to-key</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Bind a macro to a key (<SPAN class=docEmphBold>C-x C-k</SPAN> <SPAN class=docEmphBold>0</SPAN>-<SPAN class=docEmphBold>9</SPAN> and <SPAN class=docEmphBold>A</SPAN>-<SPAN class=docEmphBold>Z</SPAN> are reserved for macro bindings). Lasts for current session only.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k Space</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-step-edit-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Edit a macro while stepping through it (in our opinion, the interface is overly complex).</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k l</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-edit-lossage</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Turn the last 100 keystrokes into a keyboard macro. If any mouse clicks are among the last 100 keystrokes, does not work.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k e</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>edit-kbd-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Edit a keyboard macro by typing C-x e for the last keyboard macro defined, M-x for a named macro, C-h l for lossage, or keystrokes for a macro bound to a key.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k Enter</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-edit-macro</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Edit the last keyboard macro.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k C-e</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-edit-macro-repeat</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Edit the last keyboard macro again.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k C-t</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-swap-ring</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Transpose last keyboard macro with previous keyboard macro.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k C-d</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-delete-ring-head</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Delete last keyboard macro from the macro ring.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k C-p</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-cycle-ring-previous</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move to the previous macro in the macro ring.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k C-n</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>kmacro-cycle-ring-next</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move to the next macro in the macro ring.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-x C-k r</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>apply-macro-to-region-lines</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Apply this macro to each line in a region.</P></TD></TR></TBODY></TABLE>