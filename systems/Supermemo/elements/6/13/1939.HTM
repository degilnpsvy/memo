<H3 class=docSection1Title>6.9. Executing Macros on a Region</H3>
<P class=docText>A special command <A name=gnu3-CHP-6-ITERM-2290></A><A name=gnu3-CHP-6-ITERM-2291></A><A name=gnu3-CHP-6-ITERM-2292></A>lets you execute a macro on each line in a region. How frequently do you encounter an email with text that you want to yank, but that is quoted several indentation levels? Of course, we can think of several ways to delete the indentation quickly, but a line-oriented macro is a quick approach too. <FONT class=extract><FONT class=extract>You define the macro and execute it on a region by typing <SPAN class=docEmphBold>C-x C-k r</SPAN> (for <SPAN class=docEmphBold>apply-macro-to-region-lines</SPAN>).</FONT> Remember that earlier we said that macros should set themselves up to repeat? This command is different because it expects to work on one line at a time. You don't want to set it up to repeat by moving to the next line; it does that automatically.</FONT></P>
<P class=docText><A class=docLink href="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/gnu3-chp-6-sect-9.html#gnu3-chp-6-table-5">Table 6-5</A> shows a quick line-oriented macro that deletes indentation marks from text quoted in an email or <A name=gnu3-CHP-6-ITERM-2293></A>newsgroup message.</P><A name=gnu3-CHP-6-TABLE-5></A>
<H5 class=docTableTitle>Table 6-5. Macro for deleting indentation marks</H5>
<TABLE border=1 rules=all cellSpacing=0 cellPadding=4 width="100%">
<COLGROUP>
<COL>
<COL></COLGROUP>
<THEAD>
<TR>
<TH class=thead scope=col>
<P class=docText>Keystrokes</P></TH>
<TH class=thead scope=col>
<P class=docText>Action</P></TH></TR></THEAD>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>F3</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Start the macro definition.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-a</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move to the beginning of the line.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>M-f</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move forward one word.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>M-b</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move to the beginning of this word.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-Space</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Set the mark.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-a</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Move to the beginning of the line.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>C-w</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>Delete the extraneous indentation characters.</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><SPAN class=docEmphBold>F4</SPAN> </P></TD>
<TD class=docTableCell>
<P class=docText>End the macro definition.</P></TD></TR></TBODY></TABLE><BR><A name=ch06-16-fm2xml></A>
<TABLE border=1 rules=all cellSpacing=0 cellPadding=4 width="100%">
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>Initial state:</P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn12.gif" width=425 height=214> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>Text indented at various levels (Mac OS X).</P></TD></TR></TBODY></TABLE><BR><A name=ch06-17-fm2xml></A>
<TABLE border=1 rules=all cellSpacing=0 cellPadding=4 width="100%">
<COLGROUP>
<COL></COLGROUP>
<TBODY>
<TR>
<TD class=docTableCell>
<P class=docText>Mark the text as a region, move to the beginning of the region, then type: <SPAN class=docEmphBold>C-x C-k r</SPAN></P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText><IMG border=0 alt="" src="file:///D:/&#25105;&#30340;&#37239;&#30424;/&#24037;&#20316;&#30446;&#24405;/Now/learning-gnu-emacs-3rd/0596006489/images/0596006489/figs/ge3_ch06scrn13.gif" width=425 height=211> </P></TD></TR>
<TR>
<TD class=docTableCell>
<P class=docText>Indentation is deleted (Mac OS X).</P></TD></TR></TBODY></TABLE>