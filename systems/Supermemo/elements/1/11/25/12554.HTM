<B><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">3.7.3 Using the user mode network stack</SPAN></B></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">By using the option &#8216;</SPAN><SPAN lang=EN-US style="FONT-SIZE: 15.5pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">-net user</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&#8217; (default configuration if no &#8216;</SPAN><SPAN lang=EN-US style="FONT-SIZE: 15.5pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">-net</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&#8217; option is specified), QEMU uses a completely user mode network stack (you don&#8217;t need root privilege to use the virtual network). The virtual network configuration is the following:</SPAN></P>
<TABLE class=MsoNormalTable style="mso-cellspacing: 1.5pt" cellPadding=0 border=0>
<TBODY>
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes; mso-yfti-lastrow: yes">
<TD style="BORDER-RIGHT: #ffffff; PADDING-RIGHT: 0.75pt; BORDER-TOP: #ffffff; PADDING-LEFT: 0.75pt; PADDING-BOTTOM: 0.75pt; BORDER-LEFT: #ffffff; PADDING-TOP: 0.75pt; BORDER-BOTTOM: #ffffff; BACKGROUND-COLOR: transparent">
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&nbsp;</SPAN></P></TD>
<TD style="BORDER-RIGHT: #ffffff; PADDING-RIGHT: 0.75pt; BORDER-TOP: #ffffff; PADDING-LEFT: 0.75pt; PADDING-BOTTOM: 0.75pt; BORDER-LEFT: #ffffff; PADDING-TOP: 0.75pt; BORDER-BOTTOM: #ffffff; BACKGROUND-COLOR: transparent">
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>QEMU VLAN<SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</SPAN>&lt;------&gt;<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Firewall/DHCP server &lt;-----&gt; Internet</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>|<SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>(10.0.2.2)</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>|</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>----&gt;<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>DNS server (10.0.2.3)</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>|</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>----&gt;<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>SMB server (10.0.2.4)</SPAN></P></TD></TR></TBODY></TABLE>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">The QEMU VM behaves as if it was behind a firewall which blocks all incoming connections. You can use a DHCP client to automatically configure the network in the QEMU VM. The DHCP server assign addresses to the hosts starting from 10.0.2.15.</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">In order to check that the user mode network is working, you can ping the address 10.0.2.2 and verify that you got an address in the range 10.0.2.x from the QEMU virtual DHCP server.</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">Note that</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&nbsp;</SPAN><SPAN lang=EN-US style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">ping</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&nbsp;</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">is not supported reliably to the internet as it would require root privileges. It means you can only ping the local router (10.0.2.2).</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">When using the built-in TFTP server, the router is also the TFTP server.</SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">When using the &#8216;</SPAN><SPAN lang=EN-US style="FONT-SIZE: 15.5pt; COLOR: black; FONT-FAMILY: &#23435;&#20307;; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">-redir</SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; COLOR: black; FONT-FAMILY: Simsun; mso-bidi-font-size: 13.5pt; mso-bidi-font-family: &#23435;&#20307;; mso-font-kerning: 0pt">&#8217; option, TCP or UDP connections can be redirected from the host to the guest. It allows for example to redirect X11, telnet or SSH connections.</SPAN>