<B><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; FONT-FAMILY: Arial; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">4.3.4 Rules </SPAN></B><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; FONT-FAMILY: Arial; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"></SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">a) Calls to <B>transport_dbg </B>shall follow the same forward path as the transport interface used for normal transactions. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">b) The <B>trans </B>argument shall pass a reference to a debug transaction object. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">c) The initiator shall be responsible for constructing and managing the debug transaction object, and for setting the appropriate attributes of the object before passing it as an argument to <B>transport_dbg</B>. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">d) The command attribute of the transaction object shall be set by the initiator to indicate the kind of debug access being requested, and shall not be modified by any interconnect component or target. For the base protocol, the permitted values are TLM_READ_COMMAND for read access to the target, TLM_WRITE_COMMAND for write access to the target, and TLM_IGNORE_COMMAND. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">e) On receipt of a transaction with the command attribute equal to TLM_IGNORE_COMMAND, the target should not execute a read or a write, but may use the value of any attribute in the generic payload, including any extensions, in executing an extended debug transaction. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">f) As is the case for the transport interface, the use of any non-ignorable or mandatory generic payload extension with the debug transport interface requires the definition of a new protocol traits class. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">g) The address attribute shall be set by the initiator to the first address in the region to be read or written. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">h) An interconnect component passing the debug transaction object along the forward path should decode and where necessary modify the address attribute of the transaction object exactly as it would for the corresponding transport interface of the same socket. For example, an interconnect component may need to mask the address (reducing the number of significant bits) according to the address width of the target and its location in the system memory map. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">i) An interconnect component need not pass on the <B>transport_dbg </B>call in the event that it detects an addressing error. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">j) The address attribute may be modified several times if a debug payload is forwarded through several interconnect components. When the debug payload is returned to the initiator, the original value of the address attribute may have been overwritten. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">k) The data length attribute shall be set by the initiator to the number of bytes to be read or written and shall not be modified by any interconnect component or target. The data length attribute may be 0, in which case the target shall not read or write any bytes, and the data pointer attribute may be null. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">l) The data pointer attribute shall be set by the initiator to the address of an array from which values are to be copied to the target (for a write), or to which values are to be copied from the target (for a read), and shall not be modified by any interconnect component or target. This array shall be allocated by the initiator, and shall not be deleted before the return from <B>transport_dbg</B>. The size of the array shall be at least equal to the value of the data length attribute. If the data length attribute is 0, the data pointer attribute may be the null pointer and the array need not be allocated. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">m) The implementation of transport_dbg in the target shall read or write the given number of bytes using the given address (after address translation through the interconnect), if it is able. In the case of a write command, the target shall not modify the contents of the data array. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">n) The data array shall have the same organization as the data array of the generic payload when used with the transport interface. The implementation of <B>transport_dbg </B>shall be responsible for converting between the organization of the local data storage within the target and the generic payload organization. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">o) In the case of the base protocol, the initiator is not obliged to set any other attributes of the generic payload aside from command, address, data length and data pointer, and the target and any interconnect components may ignore all other attributes. In particular, the response status attribute may be ignored. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">p) The initiator may re-use a transaction object from one call to the next and across calls to the debug transport interface, the transport interfaces, and DMI. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">q) <B>transport_dbg </B>shall return a count of the number of bytes actually read or written, which may be less than the value of the data length attribute. If the target is not able to perform the operation, it shall return a value of 0. </SPAN></P>
<p><SPAN lang=EN-US style="FONT-SIZE: 15pt; COLOR: black; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt">r) Directly or indirectly, <B>transport_dbg </B>shall not call <B>wait</B>, and should not cause any state changes in any interconnect component or in the target aside from the immediate effect of executing a debug write command. </SPAN>