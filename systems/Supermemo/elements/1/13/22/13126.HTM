<DIV class=navheader style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">
<TABLE width="100%" summary="Navigation header">
<TBODY>
<TR>
<TH align=middle colSpan=3>15.7.&nbsp;CPU Exception Response</TH></TR>
<TR>
<TD align=left width="20%"><A accessKey=p href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch15s06.html">Prev</A>&nbsp;</TD>
<TH align=middle width="60%">Chapter&nbsp;15.&nbsp;Exceptions</TH>
<TD align=right width="20%">&nbsp;<A accessKey=n href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch15s08.html">Next</A></TD></TR></TBODY></TABLE>
<HR>
</DIV>
<DIV class=section title="15.7.&nbsp;CPU Exception Response" style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=id286966526></A>15.7.&nbsp;CPU Exception Response</H2></DIV></DIV></DIV>
<P>The SPIM<SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN class=quote>&#8220;<SPAN class=quote>hardware</SPAN>&#8221;</SPAN><SPAN class=Apple-converted-space>&nbsp;</SPAN>takes the following actions with respect to exceptions:</P>
<DIV class=procedure>
<OL class=procedure type=1>
<LI class=step title="Step 1">Hardware: CPU checks for exceptions before every instruction cycle</LI>
<LI class=step title="Step 2">Hardware: Cause register set to indicate source of exception</LI>
<LI class=step title="Step 3">Hardware: Status register updated by hardware to indicate interrupt type</LI>
<LI class=step title="Step 4">Hardware: All interrupts disabled</LI>
<LI class=step title="Step 5">Hardware: Save current PC to EPC (in CP0)</LI>
<LI class=step title="Step 6">Hardware: If bad address exception, load address into badvaddress</LI>
<LI class=step title="Step 7">Hardware: Branch to exception handler routine (fixed at 0x80000180 in MIPS)</LI>
<LI class=step title="Step 8">Software: Check bits in cause register for exception type</LI>
<LI class=step title="Step 9">Software: If interrupt, check bits in status register to determine interrupt type (which device)</LI>
<LI class=step title="Step 10">Software: Process input or output (queue input, dequeue output, etc)</LI>
<LI class=step title="Step 11">Software: Execute eret instruction to return to interrupted instruction</LI></OL></DIV>
<P>Complete sequence for keyboard interrupt:</P></DIV>
<DIV class=navfooter style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">
<HR>

<TABLE width="100%" summary="Navigation footer">
<TBODY>
<TR>
<TD align=left width="40%"><A accessKey=p href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch15s06.html">Prev</A>&nbsp;</TD>
<TD align=middle width="20%"><A accessKey=u href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch15.html">Up</A></TD>
<TD align=right width="40%">&nbsp;<A accessKey=n href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch15s08.html">Next</A></TD></TR>
<TR>
<TD vAlign=top align=left width="40%">15.6.&nbsp;Exceptions in SPIM&nbsp;</TD>
<TD align=middle width="20%"><A accessKey=h href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/index.html">Home</A></TD>
<TD vAlign=top align=right width="40%">&nbsp;15.8.&nbsp;The Exception Handler</TD></TR></TBODY></TABLE></DIV>