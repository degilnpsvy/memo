<H4><A name=SECTION03140040000000000000>Constraining parameters</A> </H4>
<P>Fortunately, it is fine to use different frames when following different chains; however, one extra piece of information is needed. Imagine transforming the whole tree. The variable <SPAN class=MATH><IMG height=34 alt="$ \theta _7$" src="http://planning.cs.uiuc.edu/img36.gif" width=21 align=middle border=0></SPAN> will appear twice, once from each of the upper and lower chains. Let <!-- MATH
 $\theta_{7u}$
 --><SPAN class=MATH><IMG height=34 alt="$ \theta_{7u}$" src="http://planning.cs.uiuc.edu/img930.gif" width=29 align=middle border=0></SPAN> and <!-- MATH
 $\theta_{7l}$
 --><SPAN class=MATH><IMG height=34 alt="$ \theta_{7l}$" src="http://planning.cs.uiuc.edu/img931.gif" width=25 align=middle border=0></SPAN> denote these <SPAN class=MATH><IMG height=17 alt="$ \theta $" src="http://planning.cs.uiuc.edu/img47.gif" width=14 align=bottom border=0></SPAN>'s. Can <SPAN class=MATH><IMG height=17 alt="$ \theta $" src="http://planning.cs.uiuc.edu/img47.gif" width=14 align=bottom border=0></SPAN> really be chosen two different ways? This would imply that the tree is instead as pictured in Figure <A href="http://planning.cs.uiuc.edu/node116.html#fig:linkjunct3">3.24</A>, in which there are two independently moving links, <!-- MATH
 ${\cal A}_{7u}$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_{7u}$" src="http://planning.cs.uiuc.edu/img932.gif" width=35 align=middle border=0></SPAN> and <!-- MATH
 ${\cal A}_{7l}$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_{7l}$" src="http://planning.cs.uiuc.edu/img933.gif" width=32 align=middle border=0></SPAN>. 
<DIV align=center><A name=fig:linkjunct3></A><A name=8539></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 3.24:</STRONG> Choosing each <SPAN class=MATH><IMG height=34 alt="$ \theta _7$" src="http://planning.cs.uiuc.edu/img36.gif" width=21 align=middle border=0></SPAN> independently would result in a tree that ignores that fact that <!-- MATH
 ${\cal A}_7$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_7$" src="http://planning.cs.uiuc.edu/img33.gif" width=28 align=middle border=0></SPAN> is rigid.</CAPTION>
<TBODY>
<TR>
<TD><IMG height=244 alt="\begin{figure}\begin{center}&#10;\centerline{\psfig{file=figs/linkjunct3.eps,width=4.5in}}&#10;\end{center}&#10;\end{figure}" src="http://planning.cs.uiuc.edu/img934.gif" width=518 border=0></TD></TR></TBODY></TABLE></DIV>To fix this problem, a constraint must be imposed. Suppose that <!-- MATH
 $\theta_{7l}$
 --><SPAN class=MATH><IMG height=34 alt="$ \theta_{7l}$" src="http://planning.cs.uiuc.edu/img931.gif" width=25 align=middle border=0></SPAN> is treated as an independent variable. The parameter <!-- MATH
 $\theta_{7u}$
 --><SPAN class=MATH><IMG height=34 alt="$ \theta_{7u}$" src="http://planning.cs.uiuc.edu/img930.gif" width=29 align=middle border=0></SPAN> must then be chosen as <!-- MATH
 $\theta_{7l} + \phi$
 --><SPAN class=MATH><IMG height=34 alt="$ \theta_{7l} + \phi$" src="http://planning.cs.uiuc.edu/img935.gif" width=59 align=middle border=0></SPAN>, in which <SPAN class=MATH><IMG height=34 alt="$ \phi $" src="http://planning.cs.uiuc.edu/img675.gif" width=16 align=middle border=0></SPAN> is as shown in Figure <A href="http://planning.cs.uiuc.edu/node115.html#fig:linkjunct2">3.23</A>. 
<P>
<DIV align=center><A name=fig:kinetree2></A><A name=8541></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 3.25:</STRONG> A tree of bodies in which the joints are attached in different places.</CAPTION>
<TBODY>
<TR>
<TD><IMG height=327 alt="\begin{figure}\begin{center}&#10;\centerline{\psfig{file=figs/articulate3.eps,width=4.0in}}&#10;\end{center}&#10;\end{figure}" src="http://planning.cs.uiuc.edu/img936.gif" width=461 border=0></TD></TR></TBODY></TABLE></DIV>
<P>
<P>
<DIV><A name=exa:kinetree><B>Example <SPAN class=arabic>3</SPAN>..<SPAN class=arabic>6</SPAN></B></A> (A 2D Tree of Bodies) &nbsp; Figure <A href="http://planning.cs.uiuc.edu/node116.html#fig:kinetree2">3.25</A> shows a 2D example that involves six links. To transform <!-- MATH
 $(x,y) \in {\cal A}_6$
 --><SPAN class=MATH><IMG height=37 alt="$ (x,y) \in {\cal A}_6$" src="http://planning.cs.uiuc.edu/img937.gif" width=94 align=middle border=0></SPAN>, the only relevant links are <!-- MATH
 ${\cal A}_5$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_5$" src="http://planning.cs.uiuc.edu/img924.gif" width=28 align=middle border=0></SPAN>, <!-- MATH
 ${\cal A}_2$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_2$" src="http://planning.cs.uiuc.edu/img61.gif" width=28 align=middle border=0></SPAN>, and <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN>. The chain of transformations is 
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:chainmats3></A><!-- MATH
 \begin{equation}
T_1 T_{2l} T_5 T_6 
\begin{pmatrix}
x \\y \\1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_1 T_{2l} T_5 T_6 \begin{pmatrix}x  y  1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img938.gif" width=139 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>70</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>in which 
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:chainmats4></A><!-- MATH
 \begin{equation}
T_1 = 
\begin{pmatrix}
\cos\theta_1 & -\sin\theta_1 & x_t\\
\sin\theta_1 & \cos\theta_1 & y_t\\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_1 & -\sin\theta_1 & 0 \\
\sin\theta_1 & \cos\theta_1 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_1 = \begin{pmatrix}\cos\theta_1 &amp; -\sin\theta_1 &amp; x_t \sin\th...&#10;...\theta_1 &amp; 0  \sin\theta_1 &amp; \cos\theta_1 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img939.gif" width=448 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>71</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>
<P>
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:t2l></A><!-- MATH
 \begin{equation}
T_{2l} = 
\begin{pmatrix}
\cos\theta_{2l} & -\sin\theta_{2l} & a_1 \\
\sin\theta_{2l} & \cos\theta_{2l} & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_2 & -\sin\theta_2 & 1 \\
\sin\theta_2 & \cos\theta_2 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_{2l} = \begin{pmatrix}\cos\theta_{2l} &amp; -\sin\theta_{2l} &amp; a_1 ...&#10;...\theta_2 &amp; 1  \sin\theta_2 &amp; \cos\theta_2 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img940.gif" width=462 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>72</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>
<P>
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
T_5 =
\begin{pmatrix}
\cos\theta_5 & -\sin\theta_5 & a_2 \\
\sin\theta_5 & \cos\theta_5 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_5 & -\sin\theta_5 & \sqrt{2} \\
\sin\theta_5 & \cos\theta_5 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=88 alt="$\displaystyle T_5 = \begin{pmatrix}\cos\theta_5 &amp; -\sin\theta_5 &amp; a_2  \sin\t...&#10;...5 &amp; \sqrt{2}  \sin\theta_5 &amp; \cos\theta_5 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img941.gif" width=465 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>73</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>and 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
T_6 =
\begin{pmatrix}
\cos\theta_6 & -\sin\theta_6 & a_5 \\
\sin\theta_6 & \cos\theta_6 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_6 & -\sin\theta_6 & 1 \\
\sin\theta_6 & \cos\theta_6 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} .
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_6 = \begin{pmatrix}\cos\theta_6 &amp; -\sin\theta_6 &amp; a_5  \sin\t...&#10;...\theta_6 &amp; 1  \sin\theta_6 &amp; \cos\theta_6 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} .$" src="http://planning.cs.uiuc.edu/img942.gif" width=449 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>74</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>The matrix <SPAN class=MATH><IMG height=34 alt="$ T_{2l}$" src="http://planning.cs.uiuc.edu/img943.gif" width=27 align=middle border=0></SPAN> in (<A href="http://planning.cs.uiuc.edu/node116.html#eqn:t2l">3.72</A>) denotes the fact that the lower chain was followed. The transformation for points in <!-- MATH
 ${\cal A}_4$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_4$" src="http://planning.cs.uiuc.edu/img944.gif" width=28 align=middle border=0></SPAN> is 
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:chainmats5></A><!-- MATH
 \begin{equation}
T_1 T_{2u} T_4 T_5 
\begin{pmatrix}
x \\y \\1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_1 T_{2u} T_4 T_5 \begin{pmatrix}x  y  1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img945.gif" width=142 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>75</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>in which <SPAN class=MATH><IMG height=34 alt="$ T_1$" src="http://planning.cs.uiuc.edu/img21.gif" width=23 align=middle border=0></SPAN> is the same as in (<A href="http://planning.cs.uiuc.edu/node116.html#eqn:chainmats4">3.71</A>), and 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
T_3 =
\begin{pmatrix}
\cos\theta_3 & -\sin\theta_3 & a_2 \\
\sin\theta_3 & \cos\theta_3 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_3 & -\sin\theta_3 & \sqrt{2} \\
\sin\theta_3 & \cos\theta_3 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=88 alt="$\displaystyle T_3 = \begin{pmatrix}\cos\theta_3 &amp; -\sin\theta_3 &amp; a_2  \sin\t...&#10;...3 &amp; \sqrt{2}  \sin\theta_3 &amp; \cos\theta_3 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img946.gif" width=465 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>76</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>and 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
T_4 =
\begin{pmatrix}
\cos\theta_4 & -\sin\theta_4 & a_4 \\
\sin\theta_4 & \cos\theta_4 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos\theta_4 & -\sin\theta_4 & 0 \\
\sin\theta_4 & \cos\theta_4 & 0 \\
0 & 0 & 1 \\
\end{pmatrix} .
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle T_4 = \begin{pmatrix}\cos\theta_4 &amp; -\sin\theta_4 &amp; a_4  \sin\t...&#10;...\theta_4 &amp; 0  \sin\theta_4 &amp; \cos\theta_4 &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} .$" src="http://planning.cs.uiuc.edu/img947.gif" width=449 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>77</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>The interesting case is 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
T_{2u} = 
\begin{pmatrix}
\cos\theta_{2u} & -\sin\theta_{2u} & a_1 \\
\sin\theta_{2u} & \cos\theta_{2u} & 0 \\
0 & 0 & 1 \\
\end{pmatrix} =
\begin{pmatrix}
\cos(\theta_{2l} + \pi/4) & -\sin(\theta_{2l}+\pi/4) & a_1 \\
\sin(\theta_{2l} + \pi/4) & \cos(\theta_{2l}+\pi/4) & 0 \\
0 & 0 & 1 \\
\end{pmatrix} ,
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=88 alt="$\displaystyle T_{2u} = \begin{pmatrix}\cos\theta_{2u} &amp; -\sin\theta_{2u} &amp; a_1 ...&#10;...eta_{2l} + \pi/4) &amp; \cos(\theta_{2l}+\pi/4) &amp; 0  0 &amp; 0 &amp; 1  \end{pmatrix} ,$" src="http://planning.cs.uiuc.edu/img948.gif" width=615 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>3</SPAN>.<SPAN class=arabic>78</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>in which the constraint <!-- MATH
 $\theta_{2u} = \theta_{2l} + \pi/4$
 --><SPAN class=MATH><IMG height=37 alt="$ \theta_{2u} = \theta_{2l} + \pi/4$" src="http://planning.cs.uiuc.edu/img949.gif" width=128 align=middle border=0></SPAN> is imposed to enforce the fact that <!-- MATH
 ${\cal A}_2$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_2$" src="http://planning.cs.uiuc.edu/img61.gif" width=28 align=middle border=0></SPAN> is a junction. <!-- MATH
 $\blacksquare$
 --><SPAN class=MATH><IMG height=16 alt="$ \blacksquare$" src="http://planning.cs.uiuc.edu/img282.gif" width=20 align=bottom border=0></SPAN> <BR></DIV>
<P></P>
<P>For a 3D tree of bodies the same general principles may be followed. In some cases, there will not be any complications that involve special considerations of junctions and constraints. One example of this is the transformation of flexible molecules because all consecutive rotation axes intersect, and junctions occur directly at these points of intersection. In general, however, the DH parameter technique may be applied for each chain, and then the appropriate constraints have to be determined and applied to represent the true degrees of freedom of the tree. The Khalil-Kleinfinger parameterization conveniently captures the resulting solution [<A href="http://planning.cs.uiuc.edu/node858.html#KhaKle86">524</A>].