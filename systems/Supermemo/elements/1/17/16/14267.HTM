<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>3</SPAN> Defining the Variety for General Linkages 
<P><A name=13023></A>
<P>We now describe a general methodology for defining the variety. Keeping the previous examples in mind will help in understanding the formulation. In the general case, each constraint can be thought of as a statement of the form: 
<P>
<BLOCKQUOTE><I>The <SPAN class=MATH><IMG height=16 alt="$ i$" src="http://planning.cs.uiuc.edu/img70.gif" width=11 align=bottom border=0></SPAN></I></BLOCKQUOTE>th 
<BLOCKQUOTE><I>coordinate of a point <!-- MATH
 $p \in {\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ p \in {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1623.gif" width=60 align=middle border=0></SPAN> needs to be held at the value <SPAN class=MATH><IMG height=17 alt="$ x$" src="http://planning.cs.uiuc.edu/img86.gif" width=15 align=bottom border=0></SPAN> in the body frame<A name=14668></A> of <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN>.</I> </BLOCKQUOTE>For the variety in Figure <A href="http://planning.cs.uiuc.edu/node176.html#fig:threebar">4.23</A>b, the first coordinate of a point <!-- MATH
 $p \in {\cal A}_2$
 --><SPAN class=MATH><IMG height=34 alt="$ p \in {\cal A}_2$" src="http://planning.cs.uiuc.edu/img1625.gif" width=60 align=middle border=0></SPAN> was held at the value <SPAN class=MATH>0</SPAN> in <SPAN class=MATH><IMG height=18 alt="$ {\cal W}$" src="http://planning.cs.uiuc.edu/img22.gif" width=25 align=bottom border=0></SPAN> in the body frame of <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN>. The general form must also allow a point to be fixed with respect to the body frames of links other than <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN>; this did not occur for the example in Section <A href="http://planning.cs.uiuc.edu/node173.html#sec:bars">4.4.2</A> 
<P>Suppose that <SPAN class=MATH><IMG height=17 alt="$ n$" src="http://planning.cs.uiuc.edu/img57.gif" width=16 align=bottom border=0></SPAN> links, <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN>,<SPAN class=MATH><IMG height=17 alt="$ \ldots $" src="http://planning.cs.uiuc.edu/img94.gif" width=27 align=bottom border=0></SPAN>,<!-- MATH
 ${\cal A}_n$
 --> <SPAN class=MATH><IMG height=34 alt="$ {\cal A}_n$" src="http://planning.cs.uiuc.edu/img1553.gif" width=29 align=middle border=0></SPAN>, move in <!-- MATH
 ${\cal W}= {\mathbb{R}}^2$
 --><SPAN class=MATH><IMG height=20 alt="$ {\cal W}= {\mathbb{R}}^2$" src="http://planning.cs.uiuc.edu/img217.gif" width=72 align=bottom border=0></SPAN> or <!-- MATH
 ${\cal W}= {\mathbb{R}}^3$
 --><SPAN class=MATH><IMG height=20 alt="$ {\cal W}= {\mathbb{R}}^3$" src="http://planning.cs.uiuc.edu/img640.gif" width=72 align=bottom border=0></SPAN>. One link, <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN> for convenience, is designated as the root as defined in Section <A href="http://planning.cs.uiuc.edu/node112.html#sec:ttrees">3.4</A>. Some links are attached in pairs to form joints. A <EM>linkage graph</EM><A name=14684></A>, <!-- MATH
 ${\cal G}(V,E)$
 --><SPAN class=MATH><IMG height=37 alt="$ {\cal G}(V,E)$" src="http://planning.cs.uiuc.edu/img339.gif" width=67 align=middle border=0></SPAN>, is constructed from the links and joints. Each vertex of <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN> represents a link in <SPAN class=MATH><IMG height=17 alt="$ L$" src="http://planning.cs.uiuc.edu/img83.gif" width=18 align=bottom border=0></SPAN>. Each edge in <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN> represents a joint. This definition may seem somewhat backward, especially in the plane because links often look like edges and joints look like vertices. This alternative assignment is also possible, but it is not easy to generalize to the case of a single link that has more than two joints. If more than two links are attached at the same point, each generates an edge of <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN>. 
<P>
<DIV align=center><A name=fig:kingraph></A><A name=13224></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 4.27:</STRONG> A complicated linkage that has <SPAN class=MATH><IMG height=17 alt="$ 29$" src="http://planning.cs.uiuc.edu/img69.gif" width=23 align=bottom border=0></SPAN> links, several loops, links with more than two bodies, and bodies with more than two links. Each integer <SPAN class=MATH><IMG height=16 alt="$ i$" src="http://planning.cs.uiuc.edu/img70.gif" width=11 align=bottom border=0></SPAN> indicates link <!-- MATH
 ${\cal A}_i$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_i$" src="http://planning.cs.uiuc.edu/img15.gif" width=25 align=middle border=0></SPAN>.</CAPTION>
<TBODY>
<TR>
<TD><IMG height=483 alt="\begin{figure}\begin{center}&#10;\centerline{\psfig{file=figs/kingraph.eps,width=5.0in}}&#10;\end{center}&#10;\end{figure}" src="http://planning.cs.uiuc.edu/img1626.gif" width=575 border=0></TD></TR></TBODY></TABLE></DIV>
<P>
<DIV align=center><A name=fig:kingraph2></A><A name=13225></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 4.28:</STRONG> (a) One way to make the linkage graph that corresponds to the linkage in Figure <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph">4.27</A>. (b) A spanning tree is indicated by showing the removed edges with dashed lines.</CAPTION>
<TBODY>
<TR>
<TD><IMG height=260 alt="\begin{figure}\begin{center}&#10;\begin{tabular}{cc}&#10;\psfig{file=figs/kingraph2.eps,...&#10;...graph3.eps,width=2.7in} \\&#10;(a) &amp; (b) \\&#10;\end{tabular}\end{center}&#10;\end{figure}" src="http://planning.cs.uiuc.edu/img1627.gif" width=639 border=0></TD></TR></TBODY></TABLE></DIV>
<P>The steps to determine the polynomial constraints that express the variety are as follows: 
<OL>
<LI>Define the linkage graph <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN> with one vertex per link and one edge per joint. If a joint connects more than two bodies, then one body must be designated as a junction. See Figures <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph">4.27</A> and <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph2">4.28</A>a. In Figure <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph2">4.28</A>, links <SPAN class=MATH><IMG height=17 alt="$ 4$" src="http://planning.cs.uiuc.edu/img6.gif" width=14 align=bottom border=0></SPAN>, <SPAN class=MATH><IMG height=17 alt="$ 13$" src="http://planning.cs.uiuc.edu/img1628.gif" width=23 align=bottom border=0></SPAN>, and <SPAN class=MATH><IMG height=17 alt="$ 23$" src="http://planning.cs.uiuc.edu/img1629.gif" width=23 align=bottom border=0></SPAN> are designated as junctions in this way. 
<LI>Designate one link as the root, <!-- MATH
 ${\cal A}_1$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_1$" src="http://planning.cs.uiuc.edu/img846.gif" width=28 align=middle border=0></SPAN>. This link may either be fixed in <SPAN class=MATH><IMG height=18 alt="$ {\cal W}$" src="http://planning.cs.uiuc.edu/img22.gif" width=25 align=bottom border=0></SPAN>, or transformations may be applied. In the latter case, the set of transformations could be <SPAN class=MATH><IMG height=37 alt="$ SE(2)$" src="http://planning.cs.uiuc.edu/img45.gif" width=56 align=middle border=0></SPAN> or <SPAN class=MATH><IMG height=37 alt="$ SE(3)$" src="http://planning.cs.uiuc.edu/img46.gif" width=56 align=middle border=0></SPAN>, depending on the dimension of <SPAN class=MATH><IMG height=18 alt="$ {\cal W}$" src="http://planning.cs.uiuc.edu/img22.gif" width=25 align=bottom border=0></SPAN>. This enables the entire linkage to move independently of its internal motions. 
<LI>Eliminate the loops by constructing a spanning tree <SPAN class=MATH><IMG height=17 alt="$ T$" src="http://planning.cs.uiuc.edu/img105.gif" width=18 align=bottom border=0></SPAN> of the linkage graph, <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN>. This implies that every vertex (or link) is reachable by a path from the root). Any spanning tree may be used. Figure <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph2">4.28</A>b shows a resulting spanning tree after deleting the edges shown with dashed lines. 
<LI>Apply the techniques of Section <A href="http://planning.cs.uiuc.edu/node112.html#sec:ttrees">3.4</A> to assign body frames and transformations to the resulting tree of links. 
<LI>For each edge of <SPAN class=MATH><IMG height=34 alt="$ {\cal G}$" src="http://planning.cs.uiuc.edu/img77.gif" width=17 align=middle border=0></SPAN> that does not appear in <SPAN class=MATH><IMG height=17 alt="$ T$" src="http://planning.cs.uiuc.edu/img105.gif" width=18 align=bottom border=0></SPAN>, write a set of constraints between the two corresponding links. In Figure <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph2">4.28</A>b, it can be seen that constraints are needed between four pairs of links: <SPAN class=MATH><IMG height=17 alt="$ 14$" src="http://planning.cs.uiuc.edu/img82.gif" width=23 align=bottom border=0></SPAN>-<SPAN class=MATH><IMG height=17 alt="$ 15$" src="http://planning.cs.uiuc.edu/img1630.gif" width=23 align=bottom border=0></SPAN>, <SPAN class=MATH><IMG height=17 alt="$ 21$" src="http://planning.cs.uiuc.edu/img1631.gif" width=23 align=bottom border=0></SPAN>-<SPAN class=MATH><IMG height=17 alt="$ 22$" src="http://planning.cs.uiuc.edu/img1632.gif" width=23 align=bottom border=0></SPAN>, <SPAN class=MATH><IMG height=17 alt="$ 23$" src="http://planning.cs.uiuc.edu/img1629.gif" width=23 align=bottom border=0></SPAN>-<SPAN class=MATH><IMG height=17 alt="$ 24$" src="http://planning.cs.uiuc.edu/img1633.gif" width=23 align=bottom border=0></SPAN>, and <SPAN class=MATH><IMG height=17 alt="$ 19$" src="http://planning.cs.uiuc.edu/img164.gif" width=23 align=bottom border=0></SPAN>-<SPAN class=MATH><IMG height=17 alt="$ 23$" src="http://planning.cs.uiuc.edu/img1629.gif" width=23 align=bottom border=0></SPAN>. 
<P>This is perhaps the trickiest part. For examples like the one shown in Figure <A href="http://planning.cs.uiuc.edu/node117.html#fig:loopex2">3.27</A>, the constraint may be formulated as in (<A href="http://planning.cs.uiuc.edu/node117.html#eqn:bothchains">3.81</A>). This is equivalent to what was done to obtain the example in Figure <A href="http://planning.cs.uiuc.edu/node177.html#fig:onedof">4.26</A>, which means that there are actually two constraints, one for each of the <SPAN class=MATH><IMG height=17 alt="$ x$" src="http://planning.cs.uiuc.edu/img86.gif" width=15 align=bottom border=0></SPAN> and <SPAN class=MATH><IMG height=33 alt="$ y$" src="http://planning.cs.uiuc.edu/img166.gif" width=15 align=middle border=0></SPAN> coordinates. This will also work for the example shown in Figure <A href="http://planning.cs.uiuc.edu/node178.html#fig:kingraph">4.27</A> if all joints are revolute. Suppose instead that two bodies, <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> and <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN>, must be rigidly attached. This requires adding one more constraint that prevents mutual rotation. This could be achieved by selecting another point on <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> and ensuring that one of its coordinates is in the correct position in the body frame<A name=14700></A> of <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN>. If four equations are added, two from each point, then one of them would be redundant because there are only three degrees of freedom possible for <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> relative to <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN> (which comes from the dimension of <SPAN class=MATH><IMG height=37 alt="$ SE(2)$" src="http://planning.cs.uiuc.edu/img45.gif" width=56 align=middle border=0></SPAN>). 
<P>A similar but more complicated situation occurs for <!-- MATH
 ${\cal W}= {\mathbb{R}}^3$
 --><SPAN class=MATH><IMG height=20 alt="$ {\cal W}= {\mathbb{R}}^3$" src="http://planning.cs.uiuc.edu/img640.gif" width=72 align=bottom border=0></SPAN>. Holding a single point fixed produces three constraints. If a single point is held fixed, then <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> may achieve any rotation in <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN> with respect to <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN>. This implies that <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> and <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN> are attached by a spherical joint. If they are attached by a revolute joint, then two more constraints are needed, which can be chosen from the coordinates of a second point. If <!-- MATH
 ${\cal A}_j$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_j$" src="http://planning.cs.uiuc.edu/img1634.gif" width=27 align=middle border=0></SPAN> and <!-- MATH
 ${\cal A}_k$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal A}_k$" src="http://planning.cs.uiuc.edu/img1624.gif" width=28 align=middle border=0></SPAN> are rigidly attached, then one constraint from a third point is needed. In total, however, there can be no more than six independent constraints because this is the dimension of <SPAN class=MATH><IMG height=37 alt="$ SE(3)$" src="http://planning.cs.uiuc.edu/img46.gif" width=56 align=middle border=0></SPAN>. 
<P></P>
<LI>Convert the trigonometric functions to polynomials. For any 2D transformation, the familiar substitution of complex numbers may be made. If the DH parameterization<A name=13063></A> is used for the 3D case, then each of the <!-- MATH
 $\cos\theta_i$
 --><SPAN class=MATH><IMG height=34 alt="$ \cos\theta_i$" src="http://planning.cs.uiuc.edu/img1635.gif" width=47 align=middle border=0></SPAN>, <!-- MATH
 $\sin\theta_i$
 --><SPAN class=MATH><IMG height=34 alt="$ \sin\theta_i$" src="http://planning.cs.uiuc.edu/img1636.gif" width=45 align=middle border=0></SPAN> expressions can be parameterized with one complex number, and each of the <!-- MATH
 $\cos\alpha_i$
 --><SPAN class=MATH><IMG height=33 alt="$ \cos\alpha_i$" src="http://planning.cs.uiuc.edu/img1637.gif" width=50 align=middle border=0></SPAN>, <!-- MATH
 $\sin\alpha_i$
 --><SPAN class=MATH><IMG height=33 alt="$ \sin\alpha_i$" src="http://planning.cs.uiuc.edu/img1638.gif" width=48 align=middle border=0></SPAN> expressions can be parameterized with another. If the rotation matrix for <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN> is directly used in the parameterization, then the quaternion parameterization should be used. In all of these cases, polynomial expressions are obtained. 
<LI>List the constraints as polynomial equations of the form <SPAN class=MATH><IMG height=34 alt="$ f = 0$" src="http://planning.cs.uiuc.edu/img1575.gif" width=50 align=middle border=0></SPAN>. To write the description of the variety, all of the polynomials must be set equal to zero, as was done for the examples in Section <A href="http://planning.cs.uiuc.edu/node173.html#sec:bars">4.4.2</A>. </LI></OL>
<P>Is it possible to determine the dimension of the variety from the number of independent constraints? The answer is generally <EM>no</EM>, which can be easily seen from the chains of links in Section <A href="http://planning.cs.uiuc.edu/node173.html#sec:bars">4.4.2</A>; they produced varieties of various dimensions, depending on the particular equations. Techniques for computing the dimension exist but require much more machinery than is presented here (see the literature overview at the end of the chapter). However, there is a way to provide a simple upper bound on the number of degrees of freedom. Suppose the total degrees of freedom of the linkage in spanning tree form is <SPAN class=MATH><IMG height=17 alt="$ m$" src="http://planning.cs.uiuc.edu/img112.gif" width=21 align=bottom border=0></SPAN>. Each independent constraint can remove at most one degree of freedom. Thus, if there are <SPAN class=MATH><IMG height=17 alt="$ l$" src="http://planning.cs.uiuc.edu/img549.gif" width=11 align=bottom border=0></SPAN> independent constraints, then the variety can have no more than <SPAN class=MATH><IMG height=34 alt="$ m -&#10;l$" src="http://planning.cs.uiuc.edu/img1639.gif" width=50 align=middle border=0></SPAN> dimensions. One expression of this for a general class of mechanisms is the Kutzbach criterion<A name=14715></A>; the planar version of this is called Gr&#252;bler's formula<A name=14717></A> [<A href="http://planning.cs.uiuc.edu/node858.html#ErdSanKot01">310</A>]. 
<P>One final concern is the obstacle region, <!-- MATH
 ${\cal C}_{obs}$
 --><SPAN class=MATH><IMG height=34 alt="$ {\cal C}_{obs}$" src="http://planning.cs.uiuc.edu/img53.gif" width=34 align=middle border=0></SPAN>. Once the variety has been identified, the obstacle region and motion planning definitions in (<A href="http://planning.cs.uiuc.edu/node158.html#eqn:cobs">4.34</A>) and Formulation <A href="http://planning.cs.uiuc.edu/node160.html#for:pmp">4.1</A> do not need to be changed. The configuration space <SPAN class=MATH><IMG height=17 alt="$ {\cal C}$" src="http://planning.cs.uiuc.edu/img116.gif" width=16 align=bottom border=0></SPAN> must be redefined, however, to be the set of configurations that satisfy the closure constraints.