<H4><A name=SECTION03222020000000000000>Quaternions</A> </H4>
<P><A name=12337></A><A name=12338></A>
<P>The manner in which complex numbers were used to represent 2D rotations will now be adapted to using quaternions to represent 3D rotations. Let <!-- MATH
 ${\mathbb{H}}$
 --><SPAN class=MATH><IMG height=17 alt="$ {\mathbb{H}}$" src="http://planning.cs.uiuc.edu/img1268.gif" width=20 align=bottom border=0></SPAN> represent the set of <EM>quaternions</EM>, in which each quaternion, <!-- MATH
 $h \in {\mathbb{H}}$
 --><SPAN class=MATH><IMG height=34 alt="$ h \in {\mathbb{H}}$" src="http://planning.cs.uiuc.edu/img1269.gif" width=54 align=middle border=0></SPAN>, is represented as <!-- MATH
 $h = a + b i + c j + d
k$
 --><SPAN class=MATH><IMG height=34 alt="$ h = a + b i + c j + d&#10;k$" src="http://planning.cs.uiuc.edu/img1270.gif" width=171 align=middle border=0></SPAN>, and <!-- MATH
 $a,b,c,d \in {\mathbb{R}}$
 --><SPAN class=MATH><IMG height=34 alt="$ a,b,c,d \in {\mathbb{R}}$" src="http://planning.cs.uiuc.edu/img686.gif" width=103 align=middle border=0></SPAN>. A quaternion can be considered as a four-dimensional vector. The symbols <SPAN class=MATH><IMG height=16 alt="$ i$" src="http://planning.cs.uiuc.edu/img70.gif" width=11 align=bottom border=0></SPAN>, <SPAN class=MATH><IMG height=33 alt="$ j$" src="http://planning.cs.uiuc.edu/img148.gif" width=14 align=middle border=0></SPAN>, and <SPAN class=MATH><IMG height=17 alt="$ k$" src="http://planning.cs.uiuc.edu/img91.gif" width=15 align=bottom border=0></SPAN> are used to denote three ``imaginary'' components of the quaternion. The following relationships are defined: <!-- MATH
 $i^2 = j^2 = k^2 = ijk = -1$
 --><SPAN class=MATH><IMG height=38 alt="$ i^2 = j^2 = k^2 = ijk = -1$" src="http://planning.cs.uiuc.edu/img1271.gif" width=203 align=middle border=0></SPAN>, from which it follows that <SPAN class=MATH><IMG height=34 alt="$ i j = k$" src="http://planning.cs.uiuc.edu/img1272.gif" width=55 align=middle border=0></SPAN>, <SPAN class=MATH><IMG height=34 alt="$ j k = i$" src="http://planning.cs.uiuc.edu/img1273.gif" width=55 align=middle border=0></SPAN>, and <SPAN class=MATH><IMG height=34 alt="$ k i = j$" src="http://planning.cs.uiuc.edu/img1274.gif" width=55 align=middle border=0></SPAN>. Using these, multiplication of two quaternions, <!-- MATH
 $h_1 = a_1 + b_1 i + c_1 j +
d_1 k$
 --><SPAN class=MATH><IMG height=34 alt="$ h_1 = a_1 + b_1 i + c_1 j +&#10;d_1 k$" src="http://planning.cs.uiuc.edu/img1275.gif" width=209 align=middle border=0></SPAN> and <!-- MATH
 $h_2 = a_2 + b_2 i + c_2 j + d_2 k$
 --><SPAN class=MATH><IMG height=34 alt="$ h_2 = a_2 + b_2 i + c_2 j + d_2 k$" src="http://planning.cs.uiuc.edu/img1276.gif" width=209 align=middle border=0></SPAN>, can be derived to obtain <!-- MATH
 $h_1 \cdot h_2= a_3 + b_3 i + c_3 j + d_3 k$
 --><SPAN class=MATH><IMG height=34 alt="$ h_1 \cdot h_2= a_3 + b_3 i + c_3 j + d_3 k$" src="http://planning.cs.uiuc.edu/img1277.gif" width=241 align=middle border=0></SPAN>, in which 
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:quatmultformula></A><!-- MATH
 \begin{equation}
\begin{split}
a_3 & = a_1 a_2 - b_1 b_2 - c_1 c_2 - d_1 d_2 \\
b_3 & = a_1 b_2 + a_2 b_1 + c_1 d_2 - c_2 d_1 \\
c_3 & = a_1 c_2 + a_2 c_1 + b_2 d_1 - b_1 d_2 \\
d_3 & = a_1 d_2 + a_2 d_1 + b_1 c_2 - b_2 c_1 .
\end{split}
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=114 alt="\begin{displaymath}\begin{split}a_3 &amp; = a_1 a_2 - b_1 b_2 - c_1 c_2 - d_1 d_2 \\...&#10;...  d_3 &amp; = a_1 d_2 + a_2 d_1 + b_1 c_2 - b_2 c_1 . \end{split}\end{displaymath}" src="http://planning.cs.uiuc.edu/img1278.gif" width=247 border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>19</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>Using this operation, it can be shown that <!-- MATH
 ${\mathbb{H}}$
 --><SPAN class=MATH><IMG height=17 alt="$ {\mathbb{H}}$" src="http://planning.cs.uiuc.edu/img1268.gif" width=20 align=bottom border=0></SPAN> is a group with respect to quaternion multiplication. Note, however, that the multiplication is not commutative! This is also true of 3D rotations; there must be a good reason. 
<P>For convenience, quaternion multiplication can be expressed in terms of vector multiplications, a dot product, and a cross product. Let <!-- MATH
 $v
= [b \;\; c \;\; d]$
 --><SPAN class=MATH><IMG height=37 alt="$ v&#10;= [b \;\; c \;\; d]$" src="http://planning.cs.uiuc.edu/img1279.gif" width=97 align=middle border=0></SPAN> be a three-dimensional vector that represents the final three quaternion components. The first component of <!-- MATH
 $h_1 \cdot
h_2$
 --><SPAN class=MATH><IMG height=34 alt="$ h_1 \cdot&#10;h_2$" src="http://planning.cs.uiuc.edu/img1280.gif" width=55 align=middle border=0></SPAN> is <!-- MATH
 $a_1 a_2 - v_1 \cdot v_2$
 --><SPAN class=MATH><IMG height=33 alt="$ a_1 a_2 - v_1 \cdot v_2$" src="http://planning.cs.uiuc.edu/img1281.gif" width=110 align=middle border=0></SPAN>. The final three components are given by the three-dimensional vector <!-- MATH
 $a_1 v_2 + a_2 v_1 + v_1 \times
v_2$
 --><SPAN class=MATH><IMG height=33 alt="$ a_1 v_2 + a_2 v_1 + v_1 \times&#10;v_2$" src="http://planning.cs.uiuc.edu/img1282.gif" width=175 align=middle border=0></SPAN>. 
<P>In the same way that <EM>unit</EM> complex numbers were needed for <SPAN class=MATH><IMG height=37 alt="$ SO(2)$" src="http://planning.cs.uiuc.edu/img1234.gif" width=56 align=middle border=0></SPAN>, <EM>unit quaternions</EM><A name=13871></A> are needed for <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN>, which means that <!-- MATH
 ${\mathbb{H}}$
 --><SPAN class=MATH><IMG height=17 alt="$ {\mathbb{H}}$" src="http://planning.cs.uiuc.edu/img1268.gif" width=20 align=bottom border=0></SPAN> is restricted to quaternions for which <!-- MATH
 $a^2 + b^2 + c^2 + d^2 = 1$
 --><SPAN class=MATH><IMG height=38 alt="$ a^2 + b^2 + c^2 + d^2 = 1$" src="http://planning.cs.uiuc.edu/img1283.gif" width=174 align=middle border=0></SPAN>. Note that this forms a subgroup because the multiplication of unit quaternions yields a unit quaternion, and the other group axioms hold. 
<P>
<DIV align=center><A name=fig:thetav></A><A name=13186></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 4.9:</STRONG> Any 3D rotation can be considered as a rotation by an angle <SPAN class=MATH><IMG height=17 alt="$ \theta $" src="http://planning.cs.uiuc.edu/img47.gif" width=14 align=bottom border=0></SPAN> about the axis given by the unit direction vector <!-- MATH
 $v = [v_1 \;\; v_2 \;\; v_3]$
 --><SPAN class=MATH><IMG height=37 alt="$ v = [v_1 \;\; v_2 \;\; v_3]$" src="http://planning.cs.uiuc.edu/img1284.gif" width=121 align=middle border=0></SPAN>.</CAPTION>
<TBODY>
<TR>
<TD><IMG height=121 alt=\begin{figure}\centerline{\psfig{file=figs/thetav.eps,width=1.5in}}\end{figure} src="http://planning.cs.uiuc.edu/img1285.gif" width=172 border=0></TD></TR></TBODY></TABLE></DIV>
<P>
<DIV align=center><A name=fig:thetav2></A><A name=13188></A>
<TABLE>
<CAPTION align=bottom><STRONG>Figure 4.10:</STRONG> There are two ways to encode the same rotation. </CAPTION>
<TBODY>
<TR>
<TD><IMG height=99 alt=\begin{figure}\centerline{\psfig{file=figs/thetav2.eps,width=3.0in}}\end{figure} src="http://planning.cs.uiuc.edu/img1286.gif" width=345 border=0></TD></TR></TBODY></TABLE></DIV>
<P>The next step is to describe a mapping from unit quaternions to <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN>. Let the unit quaternion <!-- MATH
 $h = a + bi + cj + dk$
 --><SPAN class=MATH><IMG height=34 alt="$ h = a + b i + c j + d&#10;k$" src="http://planning.cs.uiuc.edu/img1270.gif" width=171 align=middle border=0></SPAN> map to the matrix 
<P></P>
<DIV class=mathdisplay align=center><A name=eqn:quatmat></A><!-- MATH
 \begin{equation}
R(h) =
\begin{pmatrix}
2 (a^2 + b^2) - 1 & 2 (b c - a d) & 2 (b d + a c) \\2 ( bc + a d) & 2
(a^2 + c^2) -1 & 2 (c d - a b) \\2 (b d - a c) & 2 (c d + a b) & 2
(a^2 + d^2) - 1
\end{pmatrix},
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=87 alt="$\displaystyle R(h) = \begin{pmatrix}2 (a^2 + b^2) - 1 &amp; 2 (b c - a d) &amp; 2 (b d ...&#10;...(c d - a b)  2 (b d - a c) &amp; 2 (c d + a b) &amp; 2 (a^2 + d^2) - 1 \end{pmatrix},$" src="http://planning.cs.uiuc.edu/img1287.gif" width=482 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>20</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>which can be verified as orthogonal and <!-- MATH
 $\det R(h) = 1$
 --><SPAN class=MATH><IMG height=37 alt="$ \det R(h) = 1$" src="http://planning.cs.uiuc.edu/img1288.gif" width=108 align=middle border=0></SPAN>. Therefore, it belongs to <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN>. It is not shown here, but it conveniently turns out that <SPAN class=MATH><IMG height=17 alt="$ h$" src="http://planning.cs.uiuc.edu/img764.gif" width=16 align=bottom border=0></SPAN> represents the rotation shown in Figure <A href="http://planning.cs.uiuc.edu/node151.html#fig:thetav">4.9</A>, by making the assignment 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
h = \cos \frac{\theta}{2} 
+ \left( v_1 \sin \frac{\theta}{2} \right) \, i
+ \left( v_2 \sin \frac{\theta}{2} \right) \, j
+ \left( v_3 \sin \frac{\theta}{2} \right) \, k .
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=63 alt="$\displaystyle h = \cos \frac{\theta}{2} + \left( v_1 \sin \frac{\theta}{2} \rig...&#10;...\frac{\theta}{2} \right)   j + \left( v_3 \sin \frac{\theta}{2} \right)   k .$" src="http://planning.cs.uiuc.edu/img1289.gif" width=463 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>21</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>
<P>Unfortunately, this representation is not unique. It can be verified in (<A href="http://planning.cs.uiuc.edu/node151.html#eqn:quatmat">4.20</A>) that <!-- MATH
 $R(h) = R(-h)$
 --><SPAN class=MATH><IMG height=37 alt="$ R(h) = R(-h)$" src="http://planning.cs.uiuc.edu/img1290.gif" width=124 align=middle border=0></SPAN>. A nice geometric interpretation is given in Figure <A href="http://planning.cs.uiuc.edu/node151.html#fig:thetav2">4.10</A>. The quaternions <SPAN class=MATH><IMG height=17 alt="$ h$" src="http://planning.cs.uiuc.edu/img764.gif" width=16 align=bottom border=0></SPAN> and <SPAN class=MATH><IMG height=34 alt="$ -h$" src="http://planning.cs.uiuc.edu/img1291.gif" width=30 align=middle border=0></SPAN> represent the same rotation because a rotation of <SPAN class=MATH><IMG height=17 alt="$ \theta $" src="http://planning.cs.uiuc.edu/img47.gif" width=14 align=bottom border=0></SPAN> about the direction <SPAN class=MATH><IMG height=17 alt="$ v$" src="http://planning.cs.uiuc.edu/img58.gif" width=14 align=bottom border=0></SPAN> is equivalent to a rotation of <!-- MATH
 $2 \pi
- \theta$
 --><SPAN class=MATH><IMG height=34 alt="$ 2 \pi&#10;- \theta$" src="http://planning.cs.uiuc.edu/img1292.gif" width=58 align=middle border=0></SPAN> about the direction <SPAN class=MATH><IMG height=33 alt="$ -v$" src="http://planning.cs.uiuc.edu/img1293.gif" width=29 align=middle border=0></SPAN>. Consider the quaternion representation of the second expression of rotation with respect to the first. The real part is 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
\cos\left(\frac{2 \pi - \theta}{2}\right) = 
\cos\left(\pi - \frac{\theta}{2}\right) = 
-\cos\left(\frac{\theta}{2}\right) = -a.
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=63 alt="$\displaystyle \cos\left(\frac{2 \pi - \theta}{2}\right) = \cos\left(\pi - \frac{\theta}{2}\right) = -\cos\left(\frac{\theta}{2}\right) = -a.$" src="http://planning.cs.uiuc.edu/img1294.gif" width=415 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>22</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>The <SPAN class=MATH><IMG height=16 alt="$ i$" src="http://planning.cs.uiuc.edu/img70.gif" width=11 align=bottom border=0></SPAN>, <SPAN class=MATH><IMG height=33 alt="$ j$" src="http://planning.cs.uiuc.edu/img148.gif" width=14 align=middle border=0></SPAN>, and <SPAN class=MATH><IMG height=17 alt="$ k$" src="http://planning.cs.uiuc.edu/img91.gif" width=15 align=bottom border=0></SPAN> components are 
<P></P>
<DIV class=mathdisplay align=center><!-- MATH
 \begin{equation}
- v \sin\left(\frac{2 \pi - \theta}{2}\right) = 
- v \sin\left(\pi - \frac{\theta}{2}\right) = 
- v \sin\left(\frac{\theta}{2}\right) = [ -b \;\; -c \;\; -d].
\end{equation}
 -->
<TABLE class=equation cellPadding=0 width="100%" align=center>
<TBODY>
<TR vAlign=center>
<TD noWrap align=middle><SPAN class=MATH><IMG height=64 alt="$\displaystyle - v \sin\left(\frac{2 \pi - \theta}{2}\right) = - v \sin\left(\pi...&#10;...eta}{2}\right) = - v \sin\left(\frac{\theta}{2}\right) = [ -b \;\; -c \;\; -d].$" src="http://planning.cs.uiuc.edu/img1295.gif" width=565 align=middle border=0></SPAN></TD>
<TD class=eqno noWrap align=right width=10>(<SPAN class=arabic>4</SPAN>.<SPAN class=arabic>23</SPAN>)</TD></TR></TBODY></TABLE></DIV><BR clear=all>
<P></P>The quaternion <SPAN class=MATH><IMG height=34 alt="$ -h$" src="http://planning.cs.uiuc.edu/img1291.gif" width=30 align=middle border=0></SPAN> has been constructed. Thus, <SPAN class=MATH><IMG height=17 alt="$ h$" src="http://planning.cs.uiuc.edu/img764.gif" width=16 align=bottom border=0></SPAN> and <SPAN class=MATH><IMG height=34 alt="$ -h$" src="http://planning.cs.uiuc.edu/img1291.gif" width=30 align=middle border=0></SPAN> represent the same rotation. Luckily, this is the only problem, and the mapping given by (<A href="http://planning.cs.uiuc.edu/node151.html#eqn:quatmat">4.20</A>) is two-to-one from the set of unit quaternions to <SPAN class=MATH><IMG height=37 alt="$ SO(3)$" src="http://planning.cs.uiuc.edu/img71.gif" width=56 align=middle border=0></SPAN>. 
<P>This can be fixed by the identification trick. Note that the set of unit quaternions is homeomorphic to <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN> because of the constraint <!-- MATH
 $a^2 + b^2 + c^2 + d^2 = 1$
 --><SPAN class=MATH><IMG height=38 alt="$ a^2 + b^2 + c^2 + d^2 = 1$" src="http://planning.cs.uiuc.edu/img1283.gif" width=174 align=middle border=0></SPAN>. The algebraic properties of quaternions are not relevant at this point. Just imagine each <SPAN class=MATH><IMG height=17 alt="$ h$" src="http://planning.cs.uiuc.edu/img764.gif" width=16 align=bottom border=0></SPAN> as an element of <!-- MATH
 ${\mathbb{R}}^4$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{R}}^4$" src="http://planning.cs.uiuc.edu/img1109.gif" width=26 align=bottom border=0></SPAN>, and the constraint <!-- MATH
 $a^2 + b^2 + c^2 + d^2 = 1$
 --><SPAN class=MATH><IMG height=38 alt="$ a^2 + b^2 + c^2 + d^2 = 1$" src="http://planning.cs.uiuc.edu/img1283.gif" width=174 align=middle border=0></SPAN> forces the points to lie on <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN>. Using identification, declare <SPAN class=MATH><IMG height=34 alt="$ h \sim -h$" src="http://planning.cs.uiuc.edu/img1297.gif" width=67 align=middle border=0></SPAN> for all unit quaternions. This means that the antipodal points of <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN> are identified. Recall from the end of Section <A href="http://planning.cs.uiuc.edu/node131.html#sec:manifolds">4.1.2</A> that when antipodal points are identified, <!-- MATH
 ${\mathbb{RP}}^n
{ \;\cong\; }{\mathbb{S}}^n {/\sim}$
 --><SPAN class=MATH><IMG height=37 alt="$ {\mathbb{RP}}^n&#10;{ \;\cong\; }{\mathbb{S}}^n {/\sim}$" src="http://planning.cs.uiuc.edu/img1298.gif" width=114 align=middle border=0></SPAN>. Hence, <!-- MATH
 $SO(3) { \;\cong\; }{\mathbb{RP}}^3$
 --><SPAN class=MATH><IMG height=41 alt="$ SO(3) { \;\cong\; }{\mathbb{RP}}^3$" src="http://planning.cs.uiuc.edu/img1299.gif" width=114 align=middle border=0></SPAN>, which can be considered as the set of all lines through the origin of <!-- MATH
 ${\mathbb{R}}^4$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{R}}^4$" src="http://planning.cs.uiuc.edu/img1109.gif" width=26 align=bottom border=0></SPAN>, but this is hard to visualize. The representation of <!-- MATH
 ${\mathbb{RP}}^2$
 --><SPAN class=MATH><IMG height=21 alt="$ {\mathbb{RP}}^2$" src="http://planning.cs.uiuc.edu/img1110.gif" width=38 align=bottom border=0></SPAN> in Figure <A href="http://planning.cs.uiuc.edu/node136.html#fig:2dmanifolds">4.5</A> can be extended to <!-- MATH
 ${\mathbb{RP}}^3$
 --><SPAN class=MATH><IMG height=21 alt="$ {\mathbb{RP}}^3$" src="http://planning.cs.uiuc.edu/img1111.gif" width=38 align=bottom border=0></SPAN>. Start with <!-- MATH
 $(0,1)^3
\subset {\mathbb{R}}^3$
 --><SPAN class=MATH><IMG height=38 alt="$ (0,1)^3 \subset {\mathbb{R}}^3$" src="http://planning.cs.uiuc.edu/img1242.gif" width=101 align=middle border=0></SPAN>, and make three different kinds of identifications, one for each pair of opposite cube faces, and add all of the points to the manifold. For each kind of identification a twist needs to be made (without the twist, <!-- MATH
 ${\mathbb{T}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{T}}^3$" src="http://planning.cs.uiuc.edu/img1300.gif" width=25 align=bottom border=0></SPAN> would be obtained). For example, in the <SPAN class=MATH><IMG height=17 alt="$ z$" src="http://planning.cs.uiuc.edu/img704.gif" width=14 align=bottom border=0></SPAN> direction, let <!-- MATH
 $(x,y,0) \sim (1-x,1-y,1)$
 --><SPAN class=MATH><IMG height=37 alt="$ (x,y,0) \sim (1-x,1-y,1)$" src="http://planning.cs.uiuc.edu/img1301.gif" width=218 align=middle border=0></SPAN> for all <!-- MATH
 $x,y \in [0,1]$
 --><SPAN class=MATH><IMG height=37 alt="$ x,y \in [0,1]$" src="http://planning.cs.uiuc.edu/img1302.gif" width=94 align=middle border=0></SPAN>. 
<P>One way to force uniqueness of rotations is to require staying in the ``upper half'' of <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN>. For example, require that <SPAN class=MATH><IMG height=33 alt="$ a \geq 0$" src="http://planning.cs.uiuc.edu/img1303.gif" width=49 align=middle border=0></SPAN>, as long as the boundary case of <SPAN class=MATH><IMG height=17 alt="$ a = 0$" src="http://planning.cs.uiuc.edu/img1304.gif" width=49 align=bottom border=0></SPAN> is handled properly because of antipodal points at the equator of <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN>. If <SPAN class=MATH><IMG height=17 alt="$ a = 0$" src="http://planning.cs.uiuc.edu/img1304.gif" width=49 align=bottom border=0></SPAN>, then require that <SPAN class=MATH><IMG height=34 alt="$ b \geq 0$" src="http://planning.cs.uiuc.edu/img1305.gif" width=48 align=middle border=0></SPAN>. However, if <SPAN class=MATH><IMG height=17 alt="$ a=b=0$" src="http://planning.cs.uiuc.edu/img1306.gif" width=82 align=bottom border=0></SPAN>, then require that <SPAN class=MATH><IMG height=33 alt="$ c \geq 0$" src="http://planning.cs.uiuc.edu/img1307.gif" width=48 align=middle border=0></SPAN> because points such as <!-- MATH
 $(0,0,-1,0)$
 --><SPAN class=MATH><IMG height=37 alt="$ (0,0,-1,0)$" src="http://planning.cs.uiuc.edu/img1308.gif" width=97 align=middle border=0></SPAN> and <SPAN class=MATH><IMG height=37 alt="$ (0,0,1,0)$" src="http://planning.cs.uiuc.edu/img1309.gif" width=82 align=middle border=0></SPAN> are the same rotation. Finally, if <SPAN class=MATH><IMG height=17 alt="$ a=b=c=0$" src="http://planning.cs.uiuc.edu/img1310.gif" width=115 align=bottom border=0></SPAN>, then only <SPAN class=MATH><IMG height=17 alt="$ d=1$" src="http://planning.cs.uiuc.edu/img1311.gif" width=49 align=bottom border=0></SPAN> is allowed. If such restrictions are made, it is important, however, to remember the connectivity of <!-- MATH
 ${\mathbb{RP}}^3$
 --><SPAN class=MATH><IMG height=21 alt="$ {\mathbb{RP}}^3$" src="http://planning.cs.uiuc.edu/img1111.gif" width=38 align=bottom border=0></SPAN>. If a path travels across the equator of <!-- MATH
 ${\mathbb{S}}^3$
 --><SPAN class=MATH><IMG height=19 alt="$ {\mathbb{S}}^3$" src="http://planning.cs.uiuc.edu/img1296.gif" width=23 align=bottom border=0></SPAN>, it must be mapped to the appropriate place in the ``northern hemisphere.'' At the instant it hits the equator, it must move to the antipodal point. These concepts are much easier to visualize if you remove a dimension and imagine them for <!-- MATH
 ${\mathbb{S}}^2 \subset {\mathbb{R}}^3$
 --><SPAN class=MATH><IMG height=38 alt="$ {\mathbb{S}}^2 \subset {\mathbb{R}}^3$" src="http://planning.cs.uiuc.edu/img1312.gif" width=70 align=middle border=0></SPAN>, as described at the end of Section <A href="http://planning.cs.uiuc.edu/node131.html#sec:manifolds">4.1.2</A>.