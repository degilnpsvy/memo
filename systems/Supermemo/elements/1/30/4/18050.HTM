<H4 style="LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-VARIANT: normal; FONT-STYLE: normal; TEXT-INDENT: 0px; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); FONT-SIZE: medium; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=appendixsubsec>C.2.3 Porting<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to a New Operating System</H4><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-portability_002c-gawk></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-operating-systems_002c-porting-gawk-to></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-porting-gawk></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">If you want to port<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to a new operating system, there are several steps:</P>
<OL style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">
<LI>Follow the guidelines in the previous section concerning coding style, submission of diffs, and so on.</LI>
<LI>Be prepared to sign the appropriate paperwork. In order for the FSF to distribute your code, you must either place your code in the public domain and submit a signed statement to that effect, or assign the copyright in your code to the FSF. Both of these actions are easy to do and<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>many</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>people have done so already. If you have questions, please contact me, or<SPAN class=Apple-converted-space>&nbsp;</SPAN><A href="mailto:gnu@gnu.org">gnu@gnu.org</A>.</LI>
<LI>When doing a port, bear in mind that your code must coexist peacefully with the rest of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and the other ports. Avoid gratuitous changes to the system-independent parts of the code. If at all possible, avoid sprinkling &#8216;<SAMP>#ifdef</SAMP>&#8217;s just for your port throughout the code.
<P>If the changes needed for a particular system affect too much of the code, I probably will not accept them. In such a case, you can, of course, distribute your changes on your own, as long as you comply with the GPL (see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A href="http://www.gnu.org/software/gawk/manual/gawk.html#Copying">Copying</A>).</P></LI>
<LI>A number of the files that come with<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>are maintained by other people. Thus, you should not change them unless it is for a very good reason; i.e., changes are not out of the question, but changes to these files are scrutinized extra carefully. The files are<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>dfa.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>dfa.h</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>getopt1.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>getopt.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>getopt.h</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>install-sh</SAMP>,<SAMP>mkinstalldirs</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regcomp.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regex.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regexec.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regexex.c</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regex.h</SAMP>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regex_internal.c</SAMP>, and<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>regex_internal.h</SAMP>.</LI>
<LI>Be willing to continue to maintain the port. Non-Unix operating systems are supported by volunteers who maintain the code needed to compile and run<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>on their systems. If noone volunteers to maintain a port, it becomes unsupported and it may be necessary to remove it from the distribution.</LI>
<LI>Supply an appropriate<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.???</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file. Each port has its own<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.???</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>that implements certain operating system specific functions. This is cleaner than a plethora of &#8216;<SAMP>#ifdef</SAMP>&#8217;s scattered throughout the code. The<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.c</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>in the main source directory includes the appropriate<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.???</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file from each subdirectory. Be sure to update it as well.
<P>Each port&#8217;s<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.???</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file has a suffix reminiscent of the machine or operating system for the port&#8212;for example,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>pc/gawkmisc.pc</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>vms/gawkmisc.vms</SAMP>. The use of separate suffixes, instead of plain<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.c</SAMP>, makes it possible to move files from a port&#8217;s subdirectory into the main subdirectory, without accidentally destroying the real<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>gawkmisc.c</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file. (Currently, this is only an issue for the PC operating system ports.)</P></LI>
<LI>Supply a<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>Makefile</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>as well as any other C source and header files that are necessary for your operating system. All your code should be in a separate subdirectory, with a name that is the same as, or reminiscent of, either your operating system or the computer system. If possible, try to structure things so that it is not necessary to move files out of the subdirectory into the main source directory. If that is not possible, then be sure to avoid using names for your files that duplicate the names of files in the main source directory.</LI>
<LI>Update the documentation. Please write a section (or sections) for this Web page describing the installation and compilation steps needed to compile and/or install<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>for your system.</LI></OL>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Following these steps makes it much easier to integrate your changes into<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and have them coexist happily with other operating systems&#8217; code that is already there.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">In the code that you supply and maintain, feel free to use a coding style and brace layout that suits your taste.