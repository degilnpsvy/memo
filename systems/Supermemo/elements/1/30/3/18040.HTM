<H4 style="LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-VARIANT: normal; FONT-STYLE: normal; TEXT-INDENT: 0px; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); FONT-SIZE: medium; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=appendixsubsubsec>B.3.2.4 Running<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>on VMS</H4>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Command-line parsing and quoting conventions are significantly different on VMS, so examples in this Web page or from other sources often need minor changes. They<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>are</EM>minor though, and all<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>programs should run correctly.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Here are a couple of trivial tests:</P>
<DIV style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); MARGIN-LEFT: 3.2em; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=example><PRE class=example>$ <KBD style="FONT-STYLE: oblique">gawk -- "BEGIN {print ""Hello, World!""}"</KBD>
$ <KBD style="FONT-STYLE: oblique">gawk -"W" version</KBD>
! could also be -"W version" or "-W version"
</PRE></DIV>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Note that uppercase and mixed-case text must be quoted.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">The VMS port of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>includes a<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>DCL</CODE>-style interface in addition to the original shell-style interface (see the help entry for details). One side effect of dual command-line parsing is that if there is only a single parameter (as in the quoted string program above), the command becomes ambiguous. To work around this, the normally optional<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>--</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>flag is required to force Unix-style parsing rather than<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>DCL</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>parsing. If any other dash-type options (or multiple parameters such as data files to process) are present, there is no ambiguity and<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>--</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>can be omitted.</P><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-exit-status_002c-of-VMS></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>exit</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>value is a Unix-style value and is encoded to a VMS exit status value when the program exits.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">The VMS severity bits will be set based on the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>exit</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>value. A failure is indicated by 1 and VMS sets the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>ERROR</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>status. A fatal error is indicated by 2 and VMS will set the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>FATAL</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>status. All other values will have the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>SUCCESS</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>status. The exit value is encoded to comply with VMS coding standards and will have the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>C_FACILITY_NO</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>0x350000</CODE>with the constant<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>0xA000</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>added to the number shifted over by 3 bits to make room for the severity codes.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">To extract the actual<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>exit code from the VMS status use:</P>
<DIV style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); MARGIN-LEFT: 3.2em; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=example><PRE class=example>unix_status = (vms_status .and. &amp;x7f8) / 8
</PRE></DIV>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">A C program that uses<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>exec()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to call<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>will get the original Unix-style exit value.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Older versions of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>treated a Unix exit code 0 as 1, a failure as 2, a fatal error as 4, and passed all the other numbers through. This violated the VMS exit status coding requirements.</P><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-floating_002dpoint_002c-VAX_002fVMS></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">VAX/VMS floating point uses unbiased rounding. See<SPAN class=Apple-converted-space>&nbsp;</SPAN><A href="http://www.gnu.org/software/gawk/manual/gawk.html#Round-Function">Round Function</A>.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">VMS reports time values in GMT unless one of the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>SYS$TIMEZONE_RULE</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>or<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TZ</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>logical names is set. Older versions of VMS, such as VAX/VMS 7.3 do not set these logical names.</P><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-search-paths-2></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-search-paths_002c-for-source-files-3></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">The default search path, when looking for<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>program files specified by the<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>-f</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>option, is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>"SYS$DISK:[],AWK_LIBRARY:"</CODE>. The logical name<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>AWKPATH</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>can be used to override this default. The format of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>AWKPATH</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is a comma-separated list of directory specifications. When defining it, the value should be quoted so that it retains a single translation and not a multitranslation<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>RMS</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>searchlist.