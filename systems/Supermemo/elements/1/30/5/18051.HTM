<H4 style="LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-VARIANT: normal; FONT-STYLE: normal; TEXT-INDENT: 0px; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); FONT-SIZE: medium; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=appendixsubsec>C.2.4 Why Generated Files Are Kept In<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>git</CODE></H4><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-git_002c-use-of-for-gawk-source-code></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">If you look at the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>source in the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>git</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>repository, you will notice that it includes files that are automatically generated by GNU infrastructure tools, such as<SAMP>Makefile.in</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>from<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>automake</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and even<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>configure</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>from<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>autoconf</CODE>.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">This is different from many Free Software projects that do not store the derived files, because that keeps the repository less cluttered, and it is easier to see the substantive changes when comparing versions and trying to understand what changed between commits.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">However, there are two reasons why the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>maintainer likes to have everything in the repository.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">First, because it is then easy to reproduce any given version completely, without relying upon the availability of (older, likely obsolete, and maybe even impossible to find) other tools.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">As an extreme example, if you ever even think about trying to compile, oh, say, the V7<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE>, you will discover that not only do you have to bootstrap the V7<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>yacc</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to do so, but you also need the V7<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>lex</CODE>. And the latter is pretty much impossible to bring up on a modern GNU/Linux system.<A href="http://www.gnu.org/software/gawk/manual/gawk.html#FOOT110" name=DOCF110><SUP>110</SUP></A></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">(Or, let&#8217;s say<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>1.2 required<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>bison</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>whatever-it-was in 1989 and that there was no<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>awkgram.c</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file in the repository. Is there a guarantee that we could find that<CODE>bison</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>version? Or that<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>it</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>would build?)</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">If the repository has all the generated files, then it&#8217;s easy to just check them out and build. (Or<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>easier</EM>, depending upon how far back we go.<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>:-)</CODE>)</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">And that brings us to the second (and stronger) reason why all the files really need to be in<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>git</CODE>. It boils down to who do you cater to&#8212;the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>developer(s), or the user who just wants to check out a version and try it out?</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>maintainer wants it to be possible for any interested<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>user in the world to just clone the repository, check out the branch of interest and build it. Without their having to have the correct version(s) of the autotools.<A href="http://www.gnu.org/software/gawk/manual/gawk.html#FOOT111" name=DOCF111><SUP>111</SUP></A><SPAN class=Apple-converted-space>&nbsp;</SPAN>That is the point of the<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>bootstrap.sh</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file. It touches the various other files in the right order such that</P>
<DIV style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); MARGIN-LEFT: 3.2em; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=example><PRE class=example># The canonical incantation for building GNU software:
./bootstrap.sh &amp;&amp; ./configure &amp;&amp; make
</PRE></DIV>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">will<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>just work</EM>.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">This is extremely important for the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>master</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk-<VAR>X</VAR>.<VAR>Y</VAR>-stable</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>branches.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Further, the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>maintainer would argue that it&#8217;s also important for the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>developers. When he tried to check out the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>xgawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>branch<A href="http://www.gnu.org/software/gawk/manual/gawk.html#FOOT112" name=DOCF112><SUP>112</SUP></A><SPAN class=Apple-converted-space>&nbsp;</SPAN>to build it, he couldn&#8217;t. (No<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>ltmain.sh</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file, and he had no idea how to create it, and that was not the only problem.)</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">He felt<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>extremely</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>frustrated. With respect to that branch, the maintainer is no different than Jane User who wants to try to build<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk-4.0-stable</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>or<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>master</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>from the repository.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Thus, the maintainer thinks that it&#8217;s not just important, but critical, that for any given branch, the above incantation<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>just works</EM>.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">What are some of the consequences and/or actions to take?</P>
<OL style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">
<LI>We don&#8217;t mind that there are differing files in the different branches as a result of different versions of the autotools.
<OL>
<LI>It&#8217;s the maintainer&#8217;s job to merge them and he will deal with it.</LI>
<LI>He is really good at &#8216;<SAMP>git diff x y &gt; /tmp/diff1 ; gvim /tmp/diff1</SAMP>&#8217; to remove the diffs that aren&#8217;t of interest in order to review code.<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>:-)</CODE></LI></OL></LI>
<LI>It would certainly help if everyone used the same versions of the GNU tools as he does, which in general are the latest released versions of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>automake</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>autoconf</CODE>,<CODE>bison</CODE>, and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gettext</CODE>.
<OL>
<LI>Installing from source is quite easy. It&#8217;s how the maintainer worked for years under Fedora. He had<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>/usr/local/bin</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>at the front of his<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>PATH</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and just did:
<DIV style="MARGIN-LEFT: 3.2em" class=example><PRE class=example>wget http://ftp.gnu.org/gnu/<VAR>package</VAR>/<VAR>package</VAR>-<VAR>x</VAR>.<VAR>y</VAR>.<VAR>z</VAR>.tar.gz
tar -xpzvf <VAR>package</VAR>-<VAR>x</VAR>.<VAR>y</VAR>.<VAR>z</VAR>.tar.gz
cd <VAR>package</VAR>-<VAR>x</VAR>.<VAR>y</VAR>.<VAR>z</VAR>
./configure &amp;&amp; make &amp;&amp; make check
make install    # as root
</PRE></DIV></LI>
<LI>These days the maintainer uses Ubuntu 12.04 which is medium current, but he is already doing the above for<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>autoconf</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>automake</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>bison</CODE>.</LI></OL></LI></OL>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Most of the above was originally written by the maintainer to other<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>developers. It raised the objection from one of the developers &#8220;&#8230; that anybody pulling down the source from<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>git</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is not an end user.&#8221;</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">However, this is not true. There are &#8220;power<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>users&#8221; who can build<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>(using the magic incantation shown previously) but who can&#8217;t program in C. Thus, the major branches should be kept buildable all the time.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">It was then suggested that there be a<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>cron</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>job to create nightly tarballs of &#8220;the source.&#8221; Here, the problem is that there are source trees, corresponding to the various branches! So, nightly tar balls aren&#8217;t the answer, especially as the repository can go for weeks without significant change being introduced.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">Fortunately, the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>git</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>server can meet this need. For any given branch named<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>branchname</VAR>, use:</P>
<DIV style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); MARGIN-LEFT: 3.2em; WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=example><PRE class=example>wget http://git.savannah.gnu.org/cgit/gawk.git/snapshot/gawk-<VAR>branchname</VAR>.tar.gz
</PRE></DIV>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">to retrieve a snapshot of the given branch.