<H1 class=postTitle><A id=cb_post_title_url class=postTitle2 href="http://www.cnblogs.com/vamei/p/3794388.html">Python&#26631;&#20934;&#24211;14 &#25968;&#25454;&#24211; (sqlite3)</A> </H1>
<DIV class=clear></DIV>
<DIV class=postBody>
<DIV id=cnblogs_post_body>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#20316;&#32773;&#65306;Vamei &#20986;&#22788;&#65306;http://www.cnblogs.com/vamei &#27426;&#36814;&#36716;&#36733;&#65292;&#20063;&#35831;&#20445;&#30041;&#36825;&#27573;&#22768;&#26126;&#12290;&#35874;&#35874;&#65281;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&nbsp;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">Python&#33258;&#24102;&#19968;&#20010;&#36731;&#37327;&#32423;&#30340;&#20851;&#31995;&#22411;&#25968;&#25454;&#24211;SQLite&#12290;&#36825;&#19968;&#25968;&#25454;&#24211;&#20351;&#29992;SQL&#35821;&#35328;&#12290;SQLite&#20316;&#20026;&#21518;&#31471;&#25968;&#25454;&#24211;&#65292;&#21487;&#20197;&#25645;&#37197;Python&#24314;&#32593;&#31449;&#65292;&#25110;&#32773;&#21046;&#20316;&#26377;&#25968;&#25454;&#23384;&#20648;&#38656;&#27714;&#30340;&#24037;&#20855;&#12290;SQLite&#36824;&#22312;&#20854;&#23427;&#39046;&#22495;&#26377;&#24191;&#27867;&#30340;&#24212;&#29992;&#65292;&#27604;&#22914;HTML5&#21644;&#31227;&#21160;&#31471;&#12290;Python&#26631;&#20934;&#24211;&#20013;&#30340;<SPAN style="COLOR: #800000">sqlite3<SPAN style="COLOR: #000000">&#25552;&#20379;</SPAN></SPAN>&#35813;&#25968;&#25454;&#24211;&#30340;&#25509;&#21475;&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#25105;&#23558;&#21019;&#24314;&#19968;&#20010;&#31616;&#21333;&#30340;&#20851;&#31995;&#22411;&#25968;&#25454;&#24211;&#65292;&#20026;&#19968;&#20010;&#20070;&#24215;&#23384;&#20648;&#20070;&#30340;&#20998;&#31867;&#21644;&#20215;&#26684;&#12290;&#25968;&#25454;&#24211;&#20013;&#21253;&#21547;&#20004;&#20010;&#34920;&#65306;category&#29992;&#20110;&#35760;&#24405;&#20998;&#31867;&#65292;book&#29992;&#20110;&#35760;&#24405;&#26576;&#20010;&#20070;&#30340;&#20449;&#24687;&#12290;&#19968;&#26412;&#20070;&#24402;&#23646;&#20110;&#26576;&#19968;&#20010;&#20998;&#31867;&#65292;&#22240;&#27492;book&#26377;&#19968;&#20010;&#22806;&#38190;(foreign key)&#65292;&#25351;&#21521;catogory&#34920;&#30340;&#20027;&#38190;id&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier"><IMG style="DISPLAY: block; MARGIN-LEFT: auto; MARGIN-RIGHT: auto" alt="" src="http://images.cnitblog.com/i/413416/201406/191548418481935.png" jQuery1705495169777225115="1"></SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&nbsp;</SPAN></P>
<H3><SPAN style="FONT-FAMILY: 'courier new', courier">&#21019;&#24314;&#25968;&#25454;&#24211;</SPAN></H3>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#25105;&#39318;&#20808;&#26469;&#21019;&#24314;&#25968;&#25454;&#24211;&#65292;&#20197;&#21450;&#25968;&#25454;&#24211;&#20013;&#30340;&#34920;&#12290;&#22312;&#20351;&#29992;<SPAN style="COLOR: #800000">connect()</SPAN>&#36830;&#25509;&#25968;&#25454;&#24211;&#21518;&#65292;&#25105;&#23601;&#21487;&#20197;&#36890;&#36807;&#23450;&#20301;&#25351;&#38024;cursor&#65292;&#26469;&#25191;&#34892;SQL&#21629;&#20196;&#65306;</SPAN></P>
<DIV class=cnblogs_code>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV><PRE><SPAN style="FONT-FAMILY: 'courier new', courier"><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> By Vamei</SPAN>
<SPAN style="COLOR: #0000ff">import</SPAN><SPAN style="COLOR: #000000"> sqlite3

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> test.db is a file in the working directory.</SPAN>
conn = sqlite3.connect(<SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">test.db</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)

c </SPAN>=<SPAN style="COLOR: #000000"> conn.cursor()

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> create tables</SPAN>
c.execute(<SPAN style="COLOR: #800000">'''</SPAN><SPAN style="COLOR: #800000">CREATE TABLE category
      (id int primary key, sort int, name text)</SPAN><SPAN style="COLOR: #800000">'''</SPAN><SPAN style="COLOR: #000000">)
c.execute(</SPAN><SPAN style="COLOR: #800000">'''</SPAN><SPAN style="COLOR: #800000">CREATE TABLE book
      (id int primary key, 
       sort int, 
       name text, 
       price real, 
       category int,
       FOREIGN KEY (category) REFERENCES category(id))</SPAN><SPAN style="COLOR: #800000">'''</SPAN><SPAN style="COLOR: #000000">)

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> save the changes</SPAN>
<SPAN style="COLOR: #000000">conn.commit()

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> close the connection with the database</SPAN>
conn.close()</SPAN></PRE>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV></DIV>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">SQLite&#30340;&#25968;&#25454;&#24211;&#26159;&#19968;&#20010;&#30913;&#30424;&#19978;&#30340;&#25991;&#20214;&#65292;&#22914;&#19978;&#38754;&#30340;test.db&#65292;&#22240;&#27492;&#25972;&#20010;&#25968;&#25454;&#24211;&#21487;&#20197;&#26041;&#20415;&#30340;&#31227;&#21160;&#25110;&#22797;&#21046;&#12290;test.db&#19968;&#24320;&#22987;&#19981;&#23384;&#22312;&#65292;&#25152;&#20197;SQLite&#23558;&#33258;&#21160;&#21019;&#24314;&#19968;&#20010;&#26032;&#25991;&#20214;&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#21033;&#29992;<SPAN style="COLOR: #800000">execute()</SPAN>&#21629;&#20196;&#65292;&#25105;&#25191;&#34892;&#20102;&#20004;&#20010;SQL&#21629;&#20196;&#65292;&#21019;&#24314;&#25968;&#25454;&#24211;&#20013;&#30340;&#20004;&#20010;&#34920;&#12290;&#21019;&#24314;&#23436;&#25104;&#21518;&#65292;&#20445;&#23384;&#24182;&#26029;&#24320;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&nbsp;</SPAN></P>
<H3><SPAN style="FONT-FAMILY: 'courier new', courier">&#25554;&#20837;&#25968;&#25454;</SPAN></H3>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#19978;&#38754;&#21019;&#24314;&#20102;&#25968;&#25454;&#24211;&#21644;&#34920;&#65292;&#30830;&#31435;&#20102;&#25968;&#25454;&#24211;&#30340;&#25277;&#35937;&#32467;&#26500;&#12290;&#19979;&#38754;&#23558;&#22312;&#21516;&#19968;&#25968;&#25454;&#24211;&#20013;&#25554;&#20837;&#25968;&#25454;&#65306;</SPAN></P>
<DIV class=cnblogs_code>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV><PRE><SPAN style="FONT-FAMILY: 'courier new', courier"><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> By Vamei</SPAN>

<SPAN style="COLOR: #0000ff">import</SPAN><SPAN style="COLOR: #000000"> sqlite3

conn </SPAN>= sqlite3.connect(<SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">test.db</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)
c    </SPAN>=<SPAN style="COLOR: #000000"> conn.cursor()
</SPAN><SPAN style="COLOR: #000000">
books </SPAN>= [(1, 1, <SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">Cook Recipe</SPAN><SPAN style="COLOR: #800000">'</SPAN>, 3.12, 1<SPAN style="COLOR: #000000">),
            (</SPAN>2, 3, <SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">Python Intro</SPAN><SPAN style="COLOR: #800000">'</SPAN>, 17.5, 2<SPAN style="COLOR: #000000">),
            (</SPAN>3, 2, <SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">OS Intro</SPAN><SPAN style="COLOR: #800000">'</SPAN>, 13.6, 2<SPAN style="COLOR: #000000">),
           ]

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> execute "INSERT" </SPAN>
c.execute(<SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">INSERT INTO category VALUES (1, 1, 'kitchen')</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> using the placeholder</SPAN>
c.execute(<SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">INSERT INTO category VALUES (?, ?, ?)</SPAN><SPAN style="COLOR: #800000">"</SPAN>, [(2, 2, <SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">computer</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)])

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> execute multiple commands</SPAN>
c.executemany(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">INSERT INTO book VALUES (?, ?, ?, ?, ?)</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">, books)

conn.commit()
conn.close()</SPAN></SPAN></PRE>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV></DIV>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#25554;&#20837;&#25968;&#25454;&#21516;&#26679;&#21487;&#20197;&#20351;&#29992;execute()&#26469;&#25191;&#34892;&#23436;&#25972;&#30340;SQL&#35821;&#21477;&#12290;SQL&#35821;&#21477;&#20013;&#30340;&#21442;&#25968;&#65292;&#20351;&#29992;"?"&#20316;&#20026;&#26367;&#20195;&#31526;&#21495;&#65292;&#24182;&#22312;&#21518;&#38754;&#30340;&#21442;&#25968;&#20013;&#32473;&#20986;&#20855;&#20307;&#20540;&#12290;&#36825;&#37324;&#19981;&#33021;&#29992;Python&#30340;&#26684;&#24335;&#21270;&#23383;&#31526;&#20018;&#65292;&#22914;"%s"&#65292;&#22240;&#20026;&#36825;&#19968;&#29992;&#27861;&#23481;&#26131;&#21463;&#21040;SQL&#27880;&#20837;&#25915;&#20987;&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#25105;&#20063;&#21487;&#20197;&#29992;<SPAN style="COLOR: #800000">executemany()</SPAN>&#30340;&#26041;&#27861;&#26469;&#25191;&#34892;&#22810;&#27425;&#25554;&#20837;&#65292;&#22686;&#21152;&#22810;&#20010;&#35760;&#24405;&#12290;&#27599;&#20010;&#35760;&#24405;&#26159;&#34920;&#20013;&#30340;&#19968;&#20010;&#20803;&#32032;&#65292;&#22914;&#19978;&#38754;&#30340;books&#34920;&#20013;&#30340;&#20803;&#32032;&#12290;</SPAN></P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&nbsp;</SPAN></P>
<H3><SPAN style="FONT-FAMILY: 'courier new', courier">&#26597;&#35810;</SPAN></H3>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#22312;&#25191;&#34892;&#26597;&#35810;&#35821;&#21477;&#21518;&#65292;Python&#23558;&#36820;&#22238;&#19968;&#20010;&#24490;&#29615;&#22120;&#65292;&#21253;&#21547;&#26377;&#26597;&#35810;&#33719;&#24471;&#30340;&#22810;&#20010;&#35760;&#24405;&#12290;&#20320;&#24490;&#29615;&#35835;&#21462;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992;sqlite3&#25552;&#20379;&#30340;fetchone()&#21644;fetchall()&#26041;&#27861;&#35835;&#21462;&#35760;&#24405;&#65306;</SPAN></P>
<DIV class=cnblogs_code>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV><PRE><SPAN style="FONT-FAMILY: 'courier new', courier"><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> By Vamei</SPAN>

<SPAN style="COLOR: #0000ff">import</SPAN><SPAN style="COLOR: #000000"> sqlite3

conn </SPAN>= sqlite3.connect(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">test.db</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)
c </SPAN>=<SPAN style="COLOR: #000000"> conn.cursor()

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> retrieve one record</SPAN>
c.execute(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">SELECT name FROM category ORDER BY sort</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)
</SPAN><SPAN style="COLOR: #0000ff">print</SPAN><SPAN style="COLOR: #000000">(c.fetchone())
</SPAN><SPAN style="COLOR: #0000ff">print</SPAN><SPAN style="COLOR: #000000">(c.fetchone())

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> retrieve all records as a list</SPAN>
c.execute(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">SELECT * FROM book WHERE book.category=1</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)
</SPAN><SPAN style="COLOR: #0000ff">print</SPAN><SPAN style="COLOR: #000000">(c.fetchall())

</SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> iterate through the records</SPAN>
<SPAN style="COLOR: #0000ff">for</SPAN> row <SPAN style="COLOR: #0000ff">in</SPAN> c.execute(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">SELECT name, price FROM book ORDER BY sort</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">):
    </SPAN><SPAN style="COLOR: #0000ff">print</SPAN>(row)</SPAN></PRE>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV></DIV>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&nbsp;</SPAN></P>
<H3><SPAN style="FONT-FAMILY: 'courier new', courier">&#26356;&#26032;&#19982;&#21024;&#38500;</SPAN></H3>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#20320;&#21487;&#20197;&#26356;&#26032;&#26576;&#20010;&#35760;&#24405;&#65292;&#25110;&#32773;&#21024;&#38500;&#35760;&#24405;&#65306;</SPAN></P>
<DIV class=cnblogs_code>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV><PRE><SPAN style="FONT-FAMILY: 'courier new', courier"><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000"> By Vamei</SPAN>
<SPAN style="COLOR: #000000">
conn </SPAN>= sqlite3.connect(<SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">test.db</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)
c </SPAN>=<SPAN style="COLOR: #000000"> conn.cursor()

c.execute(</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">UPDATE book SET price=? WHERE id=?</SPAN><SPAN style="COLOR: #800000">'</SPAN>,(1000, 1<SPAN style="COLOR: #000000">))
c.execute(</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">DELETE FROM book WHERE id=2</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)

conn.commit()
conn.close()</SPAN></SPAN></PRE>
<DIV class=cnblogs_code_toolbar><SPAN class=cnblogs_code_copy><A title=&#22797;&#21046;&#20195;&#30721; void(0);"><IMG alt=&#22797;&#21046;&#20195;&#30721; src="http://common.cnblogs.com/images/copycode.gif"></A></SPAN></DIV></DIV>
<P>&nbsp;</P>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#20320;&#20063;&#21487;&#20197;&#30452;&#25509;&#21024;&#38500;&#25972;&#24352;&#34920;&#65306;</SPAN></P>
<DIV class=cnblogs_code><PRE><SPAN style="FONT-FAMILY: 'courier new', courier">c.execute(<SPAN style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">DROP TABLE book</SPAN><SPAN style="COLOR: #800000">'</SPAN>)</SPAN></PRE></DIV>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">&#22914;&#26524;&#21024;&#38500;test.db&#65292;&#37027;&#20040;&#25972;&#20010;&#25968;&#25454;&#24211;&#20250;&#34987;&#21024;&#38500;&#12290;</SPAN></P>
<P>&nbsp;</P>
<H3><SPAN style="FONT-FAMILY: 'courier new', courier">&#24635;&#32467;</SPAN></H3>
<P><SPAN style="FONT-FAMILY: 'courier new', courier">sqlite3&#21482;&#26159;&#19968;&#20010;SQLite&#30340;&#25509;&#21475;&#12290;&#24819;&#35201;&#29087;&#32451;&#30340;&#20351;&#29992;SQLite&#25968;&#25454;&#24211;&#65292;&#36824;&#38656;&#35201;&#23398;&#20064;&#26356;&#22810;&#30340;&#20851;&#31995;&#22411;&#25968;&#25454;&#24211;&#30340;&#30693;&#35782;&#12290;</SPAN></P></DIV></DIV>