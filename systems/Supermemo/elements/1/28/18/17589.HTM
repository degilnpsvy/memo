<TABLE width="100%">
<TBODY>
<TR>
<TD vAlign=top>
<H2><SPAN class=refentrytitle>Changes to GLib</SPAN></H2>
<P>Changes to GLib &#8212; Incompatible changes made between successing versions of GLib </P></TD>
<TD class=gallery_image vAlign=top align=right></TD></TR></TBODY></TABLE>
<DIV class=refsect1><A name=id-1.2.8.3></A>
<H2>Incompatible changes from 2.0 to 2.2</H2>
<DIV class=itemizedlist>
<UL style="LIST-STYLE-TYPE: disc" class=itemizedlist>
<LI class=listitem>
<P>GLib changed the seeding algorithm for the pseudo-random number generator Mersenne Twister, as used by <SPAN class=structname>GRand</SPAN> and <SPAN class=structname>GRandom</SPAN>. This was necessary, because some seeds would yield very bad pseudo-random streams. Also the pseudo-random integers generated by <CODE class=function>g_rand*_int_range()</CODE> will have a slightly better equal distribution with the new version of GLib. </P>
<P>Further information can be found at the website of the Mersenne Twister random number generator at <A class=ulink href="http://www.math.keio.ac.jp/~matumoto/emt.html" target=_top>http://www.math.keio.ac.jp/~matumoto/emt.html</A>. </P>
<P>The original seeding and generation algorithms, as found in GLib 2.0.x, can be used instead of the new ones by setting the environment variable <CODE class=envar>G_RANDOM_VERSION</CODE> to the value of '2.0'. Use the GLib-2.0 algorithms only if you have sequences of numbers generated with Glib-2.0 that you need to reproduce exactly. </P></LI></UL></DIV></DIV>
<DIV class=refsect1><A name=id-1.2.8.4></A>
<H2>Incompatible changes from 1.2 to 2.0</H2>
<DIV class=itemizedlist>
<UL style="LIST-STYLE-TYPE: disc" class=itemizedlist>
<LI class=listitem>
<P>The event loop functionality <SPAN class=structname>GMain</SPAN> has extensively been revised to support multiple separate main loops in separate threads. All sources (timeouts, idle functions, etc.) are associated with a <SPAN class=structname>GMainContext</SPAN>. </P>
<P>Compatibility functions exist so that most application code dealing with the main loop will continue to work. However, code that creates new custom types of sources will require modification. </P>
<P>The main changes here are: </P>
<DIV class=itemizedlist>
<UL style="LIST-STYLE-TYPE: circle" class=itemizedlist>
<LI class=listitem>
<P>Sources are now exposed as <SPAN class=type>GSource *</SPAN>, rather than simply as numeric ids. </P></LI>
<LI class=listitem>
<P>New types of sources are created by structure "derivation" from <SPAN class=structname>GSource</SPAN>, so the <CODE class=literal>source_data</CODE> parameter to the <SPAN class=structname>GSource</SPAN> virtual functions has been replaced with a <SPAN class=type>GSource *</SPAN>. </P></LI>
<LI class=listitem>
<P>Sources are first created, then later added to a specific <SPAN class=structname>GMainContext</SPAN>. </P></LI>
<LI class=listitem>
<P>Dispatching has been modified so both the callback and data are passed in to the <CODE class=function>dispatch()</CODE> virtual function. </P></LI></UL></DIV>
<P>To go along with this change, the vtable for <SPAN class=structname>GIOChannel</SPAN> has changed and <CODE class=function>add_watch()</CODE> has been replaced by <CODE class=function>create_watch()</CODE>. </P></LI>
<LI class=listitem>
<P><CODE class=function>g_list_foreach()</CODE> and <CODE class=function>g_slist_foreach()</CODE> have been changed so they are now safe against removal of the current item, not the next item. </P>
<P>It's not recommended to mutate the list in the callback to these functions in any case. </P></LI>
<LI class=listitem>
<P><SPAN class=structname>GDate</SPAN> now works in UTF-8, not in the current locale. If you want to use it with the encoding of the locale, you need to convert strings using <CODE class=function>g_locale_to_utf8()</CODE> first. </P></LI>
<LI class=listitem>
<P><CODE class=function>g_strsplit()</CODE> has been fixed to: </P>
<DIV class=itemizedlist>
<UL style="LIST-STYLE-TYPE: circle" class=itemizedlist>
<LI class=listitem>
<P>include trailing empty tokens, rather than stripping them </P></LI>
<LI class=listitem>
<P>split into a maximum of <CODE class=literal>max_tokens</CODE> tokens, rather than <CODE class=literal>max_tokens + 1</CODE> </P></LI></UL></DIV>
<P>Code depending on either of these bugs will need to be fixed. </P></LI>
<LI class=listitem>
<P>Deprecated functions that got removed: <CODE class=function>g_set_error_handler()</CODE>, <CODE class=function>g_set_warning_handler()</CODE>, <CODE class=function>g_set_message_handler()</CODE>, use <CODE class=function>g_log_set_handler()</CODE> instead. </P></LI></UL></DIV></DIV>