<H3 style="LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-VARIANT: normal; FONT-STYLE: normal; TEXT-INDENT: 0px; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><STRONG>Simple Application: Keyboard Handling, Text Printing</STRONG></H3>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><STRONG>Author:<SPAN class=Apple-converted-space>&nbsp;</SPAN></STRONG><A style="COLOR: rgb(0,0,0); TEXT-DECORATION: underline" href="mailto:InternetNightmare_X@yahoo.com">InternetNightmare</A></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">&nbsp;</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">&nbsp;One day on IRC I was asked to make little program that read keypress from 1 to 9 and outputs the same number of text lines. It was for the university! So I decided to make tutorial for that. And here it goes! :)</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">&nbsp;Interrupt 16h is used for keyboard handling, function 0 (AH=0) waits for keypress and returns it&#8217;s scancode in AH and ASCII value in AL. In this tutorial I&#8217;ll show you the way to get numbers from ASCII values.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">&nbsp;Here&#8217;s the code:</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">---</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>[global start]</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>org 100h</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>&nbsp;</EM><EM>start:<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>xor ax, ax<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>int 16h ;<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>wait for keypress</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>cmp al, 0x30<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; check if keypress is a number 0x31-0x39 ar numbers from 1 to 9<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>jbe p_error<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; jump to error if number is below or equal to 0x30<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>&nbsp;</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>cmp al, 0x39<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>ja p_error<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; jump to error if number is above 0x39</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>&nbsp;</EM><EM>xor cx, cx<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; zero off cx<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>mov cl, al<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; load correct keyboard scancode to cx<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>sub cx, 0x30<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; substract 0x30 from cx, to get actual number</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>mov ah, 9<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; DOS (int 21h) printing function<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>mov dx,txt_ text<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; load pointer to the text to print</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM>print:<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>int 21h<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>loopnz print<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; loops while cx is not equal to 0, after each loop decrases cx by 1, so int 21h is called cx times.</P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>mov ah, 0x4c<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; exit<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>int 21h</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>p_error:<SPAN class=Apple-converted-space>&nbsp;</SPAN></EM>; prints error<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR><EM>mov dx, txt_error<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>mov ah, 9<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>int 21h</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>mov ah, 0x4c<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>int 21h</EM></P>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><EM></EM><EM>txt_text db "Our super duper cool text here :) $"<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></EM><EM>txt_error db "Wrong key pressed! $"</EM>