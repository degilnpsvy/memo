<H3 style="LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-VARIANT: normal; FONT-STYLE: normal; TEXT-INDENT: 0px; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" class=section>13.3 Internationalizing<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>Programs</H3><A style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" name=index-awk-programs_002c-internationalizing-1></A><SPAN style="TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; DISPLAY: inline !important; FONT: medium Simsun; WHITE-SPACE: normal; FLOAT: none; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"></SPAN>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px"><CODE>gawk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>provides the following variables and functions for internationalization:</P>
<DL style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px" compact>
<DD><A name=index-TEXTDOMAIN-variable-1></A></DD>
<DT><CODE>TEXTDOMAIN</CODE></DT>
<DD>
<P>This variable indicates the application&#8217;s text domain. For compatibility with GNU<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gettext</CODE>, the default value is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>"messages"</CODE>.</P><A name=index-internationalization_002c-localization_002c-marked-strings></A><A name=index-strings_002c-for-localization></A></DD>
<DT><CODE>_"your message here"</CODE></DT>
<DD>
<P>String constants marked with a leading underscore are candidates for translation at runtime. String constants without a leading underscore are not translated.</P><A name=index-dcgettext_0028_0029-function-_0028gawk_0029-1></A></DD>
<DT><CODE>dcgettext(<VAR>string</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>[</SPAN>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>[</SPAN>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>]]</SPAN>)</CODE></DT>
<DD>
<P>Return the translation of<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>in text domain<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>for locale category<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR>. The default value for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is the current value of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TEXTDOMAIN</CODE>. The default value for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>"LC_MESSAGES"</CODE>.</P>
<P>If you supply a value for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR>, it must be a string equal to one of the known locale categories described in the previous section. You must also supply a text domain. Use<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TEXTDOMAIN</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>if you want to use the current domain.</P>
<BLOCKQUOTE>
<P><B>CAUTION:</B><SPAN class=Apple-converted-space>&nbsp;</SPAN>The order of arguments to the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>version of the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>dcgettext()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>function is purposely different from the order for the C version. The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE>version&#8217;s order was chosen to be simple and to allow for reasonable<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE>-style default arguments.</P></BLOCKQUOTE><A name=index-dcngettext_0028_0029-function-_0028gawk_0029-1></A></DD>
<DT><CODE>dcngettext(<VAR>string1</VAR>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string2</VAR>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>number</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>[</SPAN>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>[</SPAN>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>]]</SPAN>)</CODE></DT>
<DD>
<P>Return the plural form used for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>number</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>of the translation of<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string1</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string2</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>in text domain<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>for locale category<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR>.<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string1</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is the English singular variant of a message, and<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>string2</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>the English plural variant of the same message. The default value for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is the current value of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TEXTDOMAIN</CODE>. The default value for<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>category</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>"LC_MESSAGES"</CODE>.</P>
<P>The same remarks about argument order as for the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>dcgettext()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>function apply.</P><A name=index-_002egmo-files_002c-specifying-directory-of-1></A><A name=index-files_002c-_002egmo_002c-specifying-directory-of-1></A><A name=index-message-object-files_002c-specifying-directory-of-1></A><A name=index-files_002c-message-object_002c-specifying-directory-of-1></A><A name=index-bindtextdomain_0028_0029-function-_0028gawk_0029-1></A></DD>
<DT><CODE>bindtextdomain(<VAR>directory</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>[</SPAN>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN style="FONT-FAMILY: serif; FONT-WEIGHT: normal" class=roman>]</SPAN>)</CODE></DT>
<DD>
<P>Change the directory in which<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>gettext</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>looks for<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>.gmo</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>files, in case they will not or cannot be placed in the standard locations (e.g., during testing). Return the directory in which<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is &#8220;bound.&#8221;</P>
<P>The default<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is the value of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TEXTDOMAIN</CODE>. If<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>directory</VAR><SPAN class=Apple-converted-space>&nbsp;</SPAN>is the null string (<CODE>""</CODE>), then<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>bindtextdomain()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>returns the current binding for the given<SPAN class=Apple-converted-space>&nbsp;</SPAN><VAR>domain</VAR>.</P></DD></DL>
<P style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">To use these facilities in your<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>awk</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>program, follow the steps outlined in the previous section, like so:</P>
<OL style="TEXT-TRANSFORM: none; TEXT-INDENT: 0px; FONT: medium Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-stroke-width: 0px">
<LI><A name=index-BEGIN-pattern_002c-TEXTDOMAIN-variable-and></A><SPAN class=Apple-converted-space>&nbsp;</SPAN><A name=index-TEXTDOMAIN-variable_002c-BEGIN-pattern-and></A>Set the variable<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>TEXTDOMAIN</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to the text domain of your program. This is best done in a<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>BEGIN</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>rule (see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A href="http://www.gnu.org/software/gawk/manual/gawk.html#BEGIN_002fEND">BEGIN/END</A>), or it can also be done via the<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>-v</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>command-line option (see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A href="http://www.gnu.org/software/gawk/manual/gawk.html#Options">Options</A>):
<DIV style="MARGIN-LEFT: 3.2em" class=example><PRE class=example>BEGIN {
    TEXTDOMAIN = "guide"
    &#8230;
}
</PRE></DIV></LI>
<LI><A name=index-_005f-_0028underscore_0029_002c-translatable-string></A><SPAN class=Apple-converted-space>&nbsp;</SPAN><A name=index-underscore-_0028_005f_0029_002c-translatable-string></A>Mark all translatable strings with a leading underscore (&#8216;<SAMP>_</SAMP>&#8217;) character. It<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>must</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>be adjacent to the opening quote of the string. For example:
<DIV style="MARGIN-LEFT: 3.2em" class=example><PRE class=example>print _"hello, world"
x = _"you goofed"
printf(_"Number of users is %d\n", nusers)
</PRE></DIV></LI>
<LI>If you are creating strings dynamically, you can still translate them, using the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>dcgettext()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>built-in function:
<DIV style="MARGIN-LEFT: 3.2em" class=example><PRE class=example>message = nusers " users logged in"
message = dcgettext(message, "adminprog")
print message
</PRE></DIV>
<P>Here, the call to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>dcgettext()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>supplies a different text domain (<CODE>"adminprog"</CODE>) in which to find the message, but it uses the default<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>"LC_MESSAGES"</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>category.</P></LI>
<LI><A name=index-LC_005fMESSAGES-locale-category_002c-bindtextdomain_0028_0029-function-_0028gawk_0029></A><SPAN class=Apple-converted-space>&nbsp;</SPAN>During development, you might want to put the<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP>.gmo</SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>file in a private directory for testing. This is done with the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>bindtextdomain()</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>built-in function:
<DIV style="MARGIN-LEFT: 3.2em" class=example><PRE class=example>BEGIN {
   TEXTDOMAIN = "guide"   # our text domain
   if (Testing) {
       # where to find our files
       bindtextdomain("testdir")
       # joe is in charge of adminprog
       bindtextdomain("../joe/testdir", "adminprog")
   }
   &#8230;
}</PRE></DIV></LI></OL>