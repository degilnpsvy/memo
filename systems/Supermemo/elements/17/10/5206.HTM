It&#8217;s much more <FONT class=clozed>efficient</FONT> to allow the test-and-set operation to run without a prior guarantee of atomicity so that the &#8220;set&#8221; succeeds only if it was atomic.