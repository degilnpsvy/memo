<H4 class=subsection style="FONT-SIZE: 15px; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; LINE-HEIGHT: 19px; FONT-STYLE: normal; FONT-FAMILY: 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; WHITE-SPACE: normal; LETTER-SPACING: normal; FONT-VARIANT: normal; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">3.5.10 Advanced features</H4>
<P style="MARGIN-TOP: 0px; WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: justify; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">If you want the recalculation of fields to happen automatically, or if you want to be able to assign<SPAN class=Apple-converted-space>&nbsp;</SPAN><I>names</I><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/org.html#fn-34" rel=footnote name=fnd-34><SUP>34</SUP></A><SPAN class=Apple-converted-space>&nbsp;</SPAN>to fields and columns, you need to reserve the first column of the table for special marking characters.<A name=index-C_002d_0023-443></A><A name=index-org_002dtable_002drotate_002drecalc_002dmarks-444></A></P>
<DL style="WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'"><KBD>C-# &nbsp;&nbsp;&nbsp;&nbsp;(</KBD><CODE>org-table-rotate-recalc-marks</CODE><KBD>)</KBD> 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Rotate the calculation mark in first column through the states &#8216;<SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN></SAMP>&#8217;, &#8216;<SAMP><SPAN class=samp>#</SPAN></SAMP>&#8217;, &#8216;<SAMP><SPAN class=samp>*</SPAN></SAMP>&#8217;, &#8216;<SAMP><SPAN class=samp>!</SPAN></SAMP>&#8217;, &#8216;<SAMP><SPAN class=samp>$</SPAN></SAMP>&#8217;. When there is an active region, change all marks in the region.</DD></DL>
<P style="MARGIN-TOP: 0px; WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: justify; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Here is an example of a table that collects exam results of students and makes use of these features:</P><PRE class=example style="BORDER-RIGHT: medium none; PADDING-RIGHT: 12pt; BORDER-TOP: medium none; PADDING-LEFT: 12pt; FONT-WEIGHT: normal; FONT-SIZE: 14px; MARGIN-BOTTOM: 14pt; PADDING-BOTTOM: 12pt; WORD-SPACING: 0px; OVERFLOW: auto; TEXT-TRANSFORM: none; BORDER-LEFT: medium none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; PADDING-TOP: 12pt; BORDER-BOTTOM: medium none; FONT-STYLE: normal; FONT-FAMILY: 'Courier New'; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(238,238,238); FONT-VARIANT: normal; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; box-shadow: rgb(136, 136, 136) 5px 5px 5px">     |---+---------+--------+--------+--------+-------+------|
     |   | Student | Prob 1 | Prob 2 | Prob 3 | Total | Note |
     |---+---------+--------+--------+--------+-------+------|
     | ! |         |     P1 |     P2 |     P3 |   Tot |      |
     | # | Maximum |     10 |     15 |     25 |    50 | 10.0 |
     | ^ |         |     m1 |     m2 |     m3 |    mt |      |
     |---+---------+--------+--------+--------+-------+------|
     | # | Peter   |     10 |      8 |     23 |    41 |  8.2 |
     | # | Sam     |      2 |      4 |      3 |     9 |  1.8 |
     |---+---------+--------+--------+--------+-------+------|
     |   | Average |        |        |        |  25.0 |      |
     | ^ |         |        |        |        |    at |      |
     | $ | max=50  |        |        |        |       |      |
     |---+---------+--------+--------+--------+-------+------|
     #+TBLFM: $6=vsum($P1..$P3)::$7=10*$Tot/$max;%.1f::$at=vmean(@-II..@-I);%.1f
</PRE>
<P class=noindent style="MARGIN-TOP: 0px; WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: justify; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><B>Important</B>: please note that for these special tables, recalculating the table with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-u C-c *</KBD><SPAN class=Apple-converted-space>&nbsp;</SPAN>will only affect rows that are marked &#8216;<SAMP><SPAN class=samp>#</SPAN></SAMP>&#8217; or &#8216;<SAMP><SPAN class=samp>*</SPAN></SAMP>&#8217;, and fields that have a formula assigned to the field itself. The column formulas are not applied in rows with empty first field.</P>
<P style="MARGIN-TOP: 0px; WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: justify; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-marking-characters_002c-tables-445></A>The marking characters have the following meaning:</P>
<DL style="WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>!</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">The fields in this line define names for the columns, so that you may refer to a column as &#8216;<SAMP><SPAN class=samp>$Tot</SPAN></SAMP>&#8217; instead of &#8216;<SAMP><SPAN class=samp>$6</SPAN></SAMP>&#8217;.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>^</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">This row defines names for the fields<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>above</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>the row. With such a definition, any formula in the table may use &#8216;<SAMP><SPAN class=samp>$m1</SPAN></SAMP>&#8217; to refer to the value &#8216;<SAMP><SPAN class=samp>10</SPAN></SAMP>&#8217;. Also, if you assign a formula to a names field, it will be stored as &#8216;<SAMP><SPAN class=samp>$name=...</SPAN></SAMP>&#8217;.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>_</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Similar to &#8216;<SAMP><SPAN class=samp>^</SPAN></SAMP>&#8217;, but defines names for the fields in the row<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>below</EM>.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>$</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Fields in this row can define<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>parameters</EM><SPAN class=Apple-converted-space>&nbsp;</SPAN>for formulas. For example, if a field in a &#8216;<SAMP><SPAN class=samp>$</SPAN></SAMP>&#8217; row contains &#8216;<SAMP><SPAN class=samp>max=50</SPAN></SAMP>&#8217;, then formulas in this table can refer to the value 50 using &#8216;<SAMP><SPAN class=samp>$max</SPAN></SAMP>&#8217;. Parameters work exactly like constants, only that they can be defined on a per-table basis.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>#</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Fields in this row are automatically recalculated when pressing &lt;TAB&gt; or &lt;RET&gt; or<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>S-&lt;TAB&gt;</KBD><SPAN class=Apple-converted-space>&nbsp;</SPAN>in this row. Also, this row is selected for a global recalculation with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-u C-c *</KBD>. Unmarked lines will be left alone by this command.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>*</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Selects this line for global recalculation with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-u C-c *</KBD>, but not for automatic recalculation. Use this when automatic recalculation slows down editing too much.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>&nbsp;</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Unmarked lines are exempt from recalculation with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-u C-c *</KBD>. All lines that should be recalculated should be marked with &#8216;<SAMP><SPAN class=samp>#</SPAN></SAMP>&#8217; or &#8216;<SAMP><SPAN class=samp>*</SPAN></SAMP>&#8217;.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR>
<DT style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 16px; MARGIN-BOTTOM: 3px; PADDING-BOTTOM: 3px; COLOR: rgb(28,48,48); PADDING-TOP: 3px; FONT-FAMILY: 'Courier New'">&#8216;<SAMP><SPAN class=samp>/</SPAN></SAMP>&#8217; 
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Do not export this line. Useful for lines that contain the narrowing &#8216;<SAMP><SPAN class=samp>&lt;N&gt;</SPAN></SAMP>&#8217; markers or column group markers.</DD></DL>
<P style="MARGIN-TOP: 0px; WORD-SPACING: 0px; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: justify; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Finally, just to whet your appetite for what can be done with the fantastic<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP><SPAN class=file>calc.el</SPAN></SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>package, here is a table that computes the Taylor series of degree<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>n</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>at location<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>x</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>for a couple of functions.</P><PRE class=example style="BORDER-RIGHT: medium none; PADDING-RIGHT: 12pt; BORDER-TOP: medium none; PADDING-LEFT: 12pt; FONT-WEIGHT: normal; FONT-SIZE: 14px; MARGIN-BOTTOM: 14pt; PADDING-BOTTOM: 12pt; WORD-SPACING: 0px; OVERFLOW: auto; TEXT-TRANSFORM: none; BORDER-LEFT: medium none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; PADDING-TOP: 12pt; BORDER-BOTTOM: medium none; FONT-STYLE: normal; FONT-FAMILY: 'Courier New'; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(238,238,238); FONT-VARIANT: normal; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; box-shadow: rgb(136, 136, 136) 5px 5px 5px">     |---+-------------+---+-----+--------------------------------------|
     |   | Func        | n | x   | Result                               |
     |---+-------------+---+-----+--------------------------------------|
     | # | exp(x)      | 1 | x   | 1 + x                                |
     | # | exp(x)      | 2 | x   | 1 + x + x^2 / 2                      |
     | # | exp(x)      | 3 | x   | 1 + x + x^2 / 2 + x^3 / 6            |
     | # | x^2+sqrt(x) | 2 | x=0 | x*(0.5 / 0) + x^2 (2 - 0.25 / 0) / 2 |
     | # | x^2+sqrt(x) | 2 | x=1 | 2 + 2.5 x - 2.5 + 0.875 (x - 1)^2    |
     | * | tan(x)      | 3 | x   | 0.0175 x + 1.77e-6 x^3               |
     |---+-------------+---+-----+--------------------------------------|
     #+TBLFM: $5=taylor($2,$4,$3);n3</PRE>