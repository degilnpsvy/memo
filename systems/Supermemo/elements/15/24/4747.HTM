<H4 class=subsection style="FONT-SIZE: 15px; FONT-FAMILY: 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; FONT-VARIANT: normal; WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT-STYLE: normal; LETTER-SPACING: normal; LINE-HEIGHT: 19px; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">3.5.5 Field and range formulas</H4>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-field-formula-364></A><A name=index-range-formula-365></A><A name=index-formula_002c-for-individual-table-field-366></A><A name=index-formula_002c-for-range-of-fields-367></A>To assign a formula to a particular field, type it directly into the field, preceded by &#8216;<SAMP><SPAN class=samp>:=</SPAN></SAMP>&#8217;, for example &#8216;<SAMP><SPAN class=samp>:=vsum(@II..III)</SPAN></SAMP>&#8217;. When you press &lt;TAB&gt; or &lt;RET&gt; or<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c C-c</KBD><SPAN class=Apple-converted-space>&nbsp;</SPAN>with the cursor still in the field, the formula will be stored as the formula for this field, evaluated, and the current field will be replaced with the result.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-g_t_0023_002bTBLFM-368></A>Formulas are stored in a special line starting with &#8216;<SAMP><SPAN class=samp>#+TBLFM:</SPAN></SAMP>&#8217; directly below the table. If you type the equation in the 4th field of the 3rd data line in the table, the formula will look like &#8216;<SAMP><SPAN class=samp>@3$4=$1+$2</SPAN></SAMP>&#8217;. When inserting/deleting/swapping column and rows with the appropriate commands,<SPAN class=Apple-converted-space>&nbsp;</SPAN><I>absolute references</I><SPAN class=Apple-converted-space>&nbsp;</SPAN>(but not relative ones) in stored formulas are modified in order to still reference the same field. To avoid this from happening, in particular in range references, anchor ranges at the table borders (using<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>@&lt;</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>@&gt;</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>$&lt;</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>$&gt;</CODE>), or at hlines using the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>@I</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>notation. Automatic adaptation of field references does of course not happen if you edit the table structure with normal editing commands&#8212;then you must fix the equations yourself.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Instead of typing an equation into the field, you may also use the following command<A name=index-C_002du-C_002dc-_003d-369></A><A name=index-org_002dtable_002deval_002dformula-370></A></P>
<DL style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><KBD>C-u C-c = &nbsp;&nbsp;&nbsp;&nbsp;(</KBD><CODE>org-table-eval-formula</CODE><KBD>)</KBD></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Install a new formula for the current field. The command prompts for a formula with default taken from the &#8216;<SAMP><SPAN class=samp>#+TBLFM:</SPAN></SAMP>&#8217; line, applies it to the current field, and stores it.</DD></DL>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">The left-hand side of a formula can also be a special expression in order to assign the formula to a number of different fields. There is no keyboard shortcut to enter such range formulas. To add them, use the formula editor (see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/org.html#Editing-and-debugging-formulas">Editing and debugging formulas</A>) or edit the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>#+TBLFM:</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>line directly.</P>
<DL style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>$2=</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Column formula, valid for the entire column. This is so common that Org treats these formulas in a special way, see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/org.html#Column-formulas">Column formulas</A>.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></DD>
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>@3=</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Row formula, applies to all fields in the specified row.<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>@&gt;=</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>means the last row.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></DD>
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>@1$2..@4$3=</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Range formula, applies to all fields in the given rectangular range. This can also be used to assign a formula to some but not all fields in a row.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></DD>
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>$name=</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Named field, see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/org.html#Advanced-features">Advanced features</A>.</DD></DL>