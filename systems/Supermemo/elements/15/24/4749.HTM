<H4 class=subsection style="FONT-SIZE: 15px; FONT-FAMILY: 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; FONT-VARIANT: normal; WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT-STYLE: normal; LETTER-SPACING: normal; LINE-HEIGHT: 19px; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">3.5.7 Lookup functions</H4>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-lookup-functions-in-tables-375></A><A name=index-table-lookup-functions-376></A>Org has three predefined Emacs Lisp functions for lookups in tables.</P>
<DL style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>(org-lookup-first VAL S-LIST R-LIST &amp;optional PREDICATE)</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify"><A name=index-org_002dlookup_002dfirst-377></A>Searches for the first element<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>in list<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S-LIST</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>for which<PRE class=lisp style="OVERFLOW: auto; MARGIN-BOTTOM: 14pt; FONT-SIZE: 14px; BORDER-TOP: medium none; FONT-FAMILY: 'Courier New'; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; COLOR: black; PADDING-BOTTOM: 12pt; PADDING-TOP: 12pt; PADDING-LEFT: 12pt; BORDER-LEFT: medium none; PADDING-RIGHT: 12pt; BACKGROUND-COLOR: rgb(238,238,238); box-shadow: rgb(136, 136, 136) 5px 5px 5px">          (PREDICATE VAL S)
</PRE>
<P style="TEXT-ALIGN: justify; MARGIN-TOP: 0px">is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>t</CODE>; returns the value from the corresponding position in list<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>R-LIST</CODE>. The default<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>PREDICATE</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>equal</CODE>. Note that the parameters<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>VAL</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>are passed to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>PREDICATE</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>in the same order as the corresponding parameters are in the call to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-lookup-first</CODE>, where<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>VAL</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>precedes<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S-LIST</CODE>. If<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>R-LIST</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>nil</CODE>, the matching element<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S-LIST</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is returned.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></P></DD>
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>(org-lookup-last VAL S-LIST R-LIST &amp;optional PREDICATE)</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify"><A name=index-org_002dlookup_002dlast-378></A>Similar to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-lookup-first</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>above, but searches for the<SPAN class=Apple-converted-space>&nbsp;</SPAN><I>last</I><SPAN class=Apple-converted-space>&nbsp;</SPAN>element for which<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>PREDICATE</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>t</CODE>.<SPAN class=Apple-converted-space>&nbsp;</SPAN><BR></DD>
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><CODE>(org-lookup-all VAL S-LIST R-LIST &amp;optional PREDICATE)</CODE></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify"><A name=index-org_002dlookup_002dall-379></A>Similar to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-lookup-first</CODE>, but searches for<SPAN class=Apple-converted-space>&nbsp;</SPAN><I>all</I><SPAN class=Apple-converted-space>&nbsp;</SPAN>elements for which<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>PREDICATE</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>t</CODE>, and returns<SPAN class=Apple-converted-space>&nbsp;</SPAN><I>all</I><SPAN class=Apple-converted-space>&nbsp;</SPAN>corresponding values. This function can not be used by itself in a formula, because it returns a list of values. However, powerful lookups can be built when this function is combined with other Emacs Lisp functions.</DD></DL>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">If the ranges used in these functions contain empty fields, the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>E</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>mode for the formula should usually be specified: otherwise empty fields will not be included in<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S-LIST</CODE>and/or<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>R-LIST</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>which can, for example, result in an incorrect mapping from an element of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>S-LIST</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to the corresponding element of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>R-LIST</CODE>.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">These three functions can be used to implement associative arrays, count matching cells, rank results, group data etc. For practical examples see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/worg/org-tutorials/org-lookups.html">this tutorial on Worg</A>.