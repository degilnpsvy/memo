<H4 class=subsection style="FONT-SIZE: 15px; FONT-FAMILY: 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; FONT-VARIANT: normal; WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT-STYLE: normal; LETTER-SPACING: normal; LINE-HEIGHT: 19px; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">3.5.6 Column formulas</H4>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-column-formula-371></A><A name=index-formula_002c-for-table-column-372></A>When you assign a formula to a simple column reference like<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>$3=</CODE>, the same formula will be used in all fields of that column, with the following very convenient exceptions: (i) If the table contains horizontal separator hlines with rows above and below, everything before the first such hline is considered part of the table<SPAN class=Apple-converted-space>&nbsp;</SPAN><EM>header</EM>and will not be modified by column formulas. Therefore a header is mandatory when you use column formulas and want to add hlines to group rows, like for example to separate a total row at the bottom from the summand rows above. (ii) Fields that already get a value from a field/range formula will be left alone by column formulas. These conditions make column formulas very easy to use.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">To assign a formula to a column, type it directly into any field in the column, preceded by an equal sign, like &#8216;<SAMP><SPAN class=samp>=$1+$2</SPAN></SAMP>&#8217;. When you press &lt;TAB&gt; or &lt;RET&gt; or<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c C-c</KBD><SPAN class=Apple-converted-space>&nbsp;</SPAN>with the cursor still in the field, the formula will be stored as the formula for the current column, evaluated and the current field replaced with the result. If the field contains only &#8216;<SAMP><SPAN class=samp>=</SPAN></SAMP>&#8217;, the previously stored formula for this column is used. For each column, Org will only remember the most recently used formula. In the &#8216;<SAMP><SPAN class=samp>#+TBLFM:</SPAN></SAMP>&#8217; line, column formulas will look like &#8216;<SAMP><SPAN class=samp>$4=$1+$2</SPAN></SAMP>&#8217;. The left-hand side of a column formula can not be the name of column, it must be the numeric column reference or<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>$&gt;</CODE>.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Instead of typing an equation into the field, you may also use the following command:<A name=index-C_002dc-_003d-373></A><A name=index-org_002dtable_002deval_002dformula-374></A></P>
<DL style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">
<DT style="MARGIN-BOTTOM: 3px; FONT-SIZE: 16px; FONT-FAMILY: 'Courier New'; COLOR: rgb(28,48,48); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px"><KBD>C-c = &nbsp;&nbsp;&nbsp;&nbsp;(</KBD><CODE>org-table-eval-formula</CODE><KBD>)</KBD></DT>
<DD style="MARGIN-BOTTOM: 14pt; TEXT-ALIGN: justify">Install a new formula for the current column and replace current field with the result of the formula. The command prompts for a formula, with default taken from the &#8216;<SAMP><SPAN class=samp>#+TBLFM</SPAN></SAMP>&#8217; line, applies it to the current field and stores it. With a numeric prefix argument(e.g.,<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-5 C-c =</KBD>) the command will apply it to that many consecutive fields in the current column.</DD></DL>