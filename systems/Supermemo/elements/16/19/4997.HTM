<H3 class=section style="FONT-FAMILY: 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; FONT-VARIANT: normal; WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT-STYLE: normal; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">A.3 Adding hyperlink types</H3>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><A name=index-hyperlinks_002c-adding-new-types-2141></A>Org has a large number of hyperlink types built-in (see<SPAN class=Apple-converted-space>&nbsp;</SPAN><A style="FONT-WEIGHT: normal; TEXT-DECORATION: none" href="http://orgmode.org/org.html#Hyperlinks">Hyperlinks</A>). If you would like to add new link types, Org provides an interface for doing so. Let's look at an example file,<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP><SPAN class=file>org-man.el</SPAN></SAMP>, that will add support for creating links like &#8216;<SAMP><SPAN class=samp>[[man:printf][The printf manpage]]</SPAN></SAMP>&#8217; to show Unix manual pages inside Emacs:</P><PRE class=lisp style="OVERFLOW: auto; MARGIN-BOTTOM: 14pt; FONT-SIZE: 14px; BORDER-TOP: medium none; FONT-FAMILY: 'Courier New'; BORDER-RIGHT: medium none; FONT-VARIANT: normal; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; WORD-SPACING: 0px; FONT-WEIGHT: normal; COLOR: rgb(0,0,0); PADDING-BOTTOM: 12pt; FONT-STYLE: normal; PADDING-TOP: 12pt; PADDING-LEFT: 12pt; BORDER-LEFT: medium none; LETTER-SPACING: normal; PADDING-RIGHT: 12pt; BACKGROUND-COLOR: rgb(238,238,238); TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; box-shadow: rgb(136, 136, 136) 5px 5px 5px">     ;;; org-man.el - Support for links to manpages in Org
     
     (require 'org)
     
     (org-add-link-type "man" 'org-man-open)
     (add-hook 'org-store-link-functions 'org-man-store-link)
     
     (defcustom org-man-command 'man
       "The Emacs command to be used to display a man page."
       :group 'org-link
       :type '(choice (const man) (const woman)))
     
     (defun org-man-open (path)
       "Visit the manpage on PATH.
     PATH should be a topic that can be thrown at the man command."
       (funcall org-man-command path))
     
     (defun org-man-store-link ()
       "Store a link to a manpage."
       (when (memq major-mode '(Man-mode woman-mode))
         ;; This is a man page, we do make this link
         (let* ((page (org-man-get-page-name))
                (link (concat "man:" page))
                (description (format "Manpage for %s" page)))
           (org-store-link-props
            :type "man"
            :link link
            :description description))))
     
     (defun org-man-get-page-name ()
       "Extract the page name from the buffer name."
       ;; This works for both `Man-mode' and `woman-mode'.
       (if (string-match " \\(\\S-+\\)\\*" (buffer-name))
           (match-string 1 (buffer-name))
         (error "Cannot create link to this man page")))
     
     (provide 'org-man)
     
     ;;; org-man.el ends here
</PRE>
<P class=noindent style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">You would activate this new link type in<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP><SPAN class=file>.emacs</SPAN></SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>with</P><PRE class=lisp style="OVERFLOW: auto; MARGIN-BOTTOM: 14pt; FONT-SIZE: 14px; BORDER-TOP: medium none; FONT-FAMILY: 'Courier New'; BORDER-RIGHT: medium none; FONT-VARIANT: normal; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; WORD-SPACING: 0px; FONT-WEIGHT: normal; COLOR: rgb(0,0,0); PADDING-BOTTOM: 12pt; FONT-STYLE: normal; PADDING-TOP: 12pt; PADDING-LEFT: 12pt; BORDER-LEFT: medium none; LETTER-SPACING: normal; PADDING-RIGHT: 12pt; BACKGROUND-COLOR: rgb(238,238,238); TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; box-shadow: rgb(136, 136, 136) 5px 5px 5px">     (require 'org-man)
</PRE>
<P class=noindent style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Let's go through the file and see what it does.</P>
<OL style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" type=1>
<LI style="LIST-STYLE-IMAGE: url(http://orgmode.org/triangle.png); TEXT-ALIGN: justify; MARGIN: 10px">It does<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>(require 'org)</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to make sure that<SPAN class=Apple-converted-space>&nbsp;</SPAN><SAMP><SPAN class=file>org.el</SPAN></SAMP><SPAN class=Apple-converted-space>&nbsp;</SPAN>has been loaded.</LI>
<LI style="LIST-STYLE-IMAGE: url(http://orgmode.org/triangle.png); TEXT-ALIGN: justify; MARGIN: 10px">The next line calls<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-add-link-type</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to define a new link type with prefix &#8216;<SAMP><SPAN class=samp>man</SPAN></SAMP>&#8217;. The call also contains the name of a function that will be called to follow such a link.</LI>
<LI style="LIST-STYLE-IMAGE: url(http://orgmode.org/triangle.png); TEXT-ALIGN: justify; MARGIN: 10px"><A name=index-org_002dstore_002dlink_002dfunctions-2142></A>The next line adds a function to<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-store-link-functions</CODE>, in order to allow the command<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c l</KBD><SPAN class=Apple-converted-space>&nbsp;</SPAN>to record a useful link in a buffer displaying a man page.</LI></OL>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">The rest of the file defines the necessary variables and functions. First there is a customization variable that determines which Emacs command should be used to display man pages. There are two options,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>man</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>woman</CODE>. Then the function to follow a link is defined. It gets the link path as an argument&#8212;in this case the link path is just a topic for the manual command. The function calls the value of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-man-command</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>to display the man page.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Finally the function<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-man-store-link</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is defined. When you try to store a link with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c l</KBD>, this function will be called to try to make a link. The function must first decide if it is supposed to create the link for this buffer type; we do this by checking the value of the variable<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>major-mode</CODE>. If not, the function must exit and return the value<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>nil</CODE>. If yes, the link is created by getting the manual topic from the buffer name and prefixing it with the string &#8216;<SAMP><SPAN class=samp>man:</SPAN></SAMP>&#8217;. Then it must call the command<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-store-link-props</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and set the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>:type</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>:link</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>properties. Optionally you can also set the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>:description</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>property to provide a default for the link description when the link is later inserted into an Org buffer with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c C-l</KBD>.</P>
<P style="WHITE-SPACE: normal; TEXT-TRANSFORM: none; WORD-SPACING: 0px; COLOR: rgb(0,0,0); TEXT-ALIGN: justify; FONT: 15px/19px 'Droid Serif', 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Verdana, sans-serif; MARGIN-TOP: 0px; LETTER-SPACING: normal; TEXT-INDENT: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">When it makes sense for your new link type, you may also define a function<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>org-PREFIX-complete-link</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>that implements special (e.g., completion) support for inserting such a link with<SPAN class=Apple-converted-space>&nbsp;</SPAN><KBD>C-c C-l</KBD>. Such a function should not accept any arguments, and return the full link with prefix.