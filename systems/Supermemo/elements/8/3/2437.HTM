<FONT face=&#24494;&#36719;&#38597;&#40657; color=#080000 size=3><FONT color=#000000>&nbsp;</FONT> 
<DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><FONT face="arial, &#23435;&#20307;, sans-serif"><SPAN style="FONT-SIZE: 14px; LINE-HEIGHT: 24px">class U_Ptr</SPAN></FONT></DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px"><FONT face="arial, &#23435;&#20307;, sans-serif"><SPAN style="FONT-SIZE: 14px; LINE-HEIGHT: 24px">{</SPAN></FONT></DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;friend class HasPtr;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;int *ip;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;size_t use;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;U_Ptr(int *p): ip(p), use(1) {}</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;~U_Ptr() { delete ip;}</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">};</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&#20351;&#29992;&#35745;&#25968;&#31867;&#65306;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">class HasPtr{</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">public:</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;HasPtr(int *p, int i): ptr(new U_Ptr(p)), val(i) {}</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;HasPtr(const HasPtr &amp;orig):ptr(orig.ptr),val(orig.val){++ptr-&gt;use;}</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;HasPtr&amp; operator=(const HasPtr&amp;);</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;~HasPtr() { if(--ptr-&gt;use==0) delete ptr;}</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">private:</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;U_Ptr *ptr;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;int val;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">};</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">HasPtr&amp; HasPtr::operator=(const HasPtr &amp;rhs)</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">{</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;++rhs.ptr-&gt;use;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;if(--ptr-&gt;use==0)</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete ptr;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;ptr=rhs.ptr;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;val=rhs.val;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">&nbsp; &nbsp; &nbsp;return *this;</DIV>
<DIV style="WORD-SPACING: 0px; FONT: medium Tahoma; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; TEXT-ALIGN: left; WIDOWS: 2; ORPHANS: 2; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">}</DIV><BR></DIV></FONT>