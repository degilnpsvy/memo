The refspec 
<P></P>
<P>In &#8220;refs and symrefs&#8221; on page 68 of Chapter 6, I explained how the ref, or reference, names a particular commit within the history of the repository. <FONT class=extract>Usually a ref is the name of a branch. A refspec maps branch names in the remote repository to branch names within your local repository. </FONT></P>
<P><FONT class=extract>Because a refspec must simultaneously name branches from the local repository and the remote repository, complete branch names are common in a refspec and are often required. In a refspec, you typically see the names of development branches with the refs/heads/prefix and the names of remote-tracking branches with the refs/remotes/prefix. </FONT></P>
<P><FONT class=extract>The syntax of a refspec is: </FONT></P>
<P><FONT class=extract>[+]source:destination </FONT></P>
<P><FONT class=extract>It consists primarily of a source ref, a colon (:), and a destination ref. The whole format may be prefixed with an optional plus sign (+). If present, the plus sign indicates that the normal fast-forward safety check will not be performed during the transfer. Furthermore, an asterisk (*) allows a limited form of wildcard matching on branch names. </FONT></P>
<P><FONT class=extract>In some uses, the source ref is optional; in others, the colon and destination ref are optional. </FONT></P>
<P><FONT class=extract>Refspecs are used by both git fetch and git push. The trick to using a refspec is to understand the data flow it specifies. The refspec itself is always source:destination, but the roles of source and destination depend on the Git operation being performed. This relationship is summarized in Table 12-1. </FONT></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 12pt; COLOR: black; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt"><FONT class=extract>&nbsp;<SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt"><FONT size=6><EM>Table 12-1. Refspec data flow</EM></FONT></SPAN></FONT></P>
<P>
<TABLE class=MsoTableGrid style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 480; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-border-insideh: .5pt solid windowtext; mso-border-insidev: .5pt solid windowtext" cellSpacing=0 cellPadding=0 border=1>
<TBODY>
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes">
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-SemiboldCond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-SemiboldCond; mso-font-kerning: 0pt"><FONT class=extract size=6><EM>Operation</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-SemiboldCond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-SemiboldCond; mso-font-kerning: 0pt"><FONT class=extract size=6><EM>Source</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-SemiboldCond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-SemiboldCond; mso-font-kerning: 0pt"><FONT class=extract size=6><EM>Destination</EM></FONT></SPAN></P></TD></TR>
<TR style="mso-yfti-irow: 1">
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Push</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Local ref being pushed</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Remote ref being updated</EM></FONT></SPAN></P></TD></TR>
<TR style="mso-yfti-irow: 2; mso-yfti-lastrow: yes">
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Fetch</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Remote ref being fetched</EM></FONT></SPAN></P></TD>
<TD style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ffffff; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ffffff; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" vAlign=top>
<P><SPAN lang=EN-US style="FONT-SIZE: 11pt; FONT-FAMILY: MyriadPro-Cond; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: MyriadPro-Cond; mso-font-kerning: 0pt; mso-fareast-font-family: Birka-Italic"><FONT class=extract size=6><EM>Local ref being updated</EM></FONT></SPAN></P></TD></TR></TBODY></TABLE></SPAN></P>
<P><FONT class=extract>A typical git fetch command uses a refspec such as:</FONT></P>
<P><FONT class=extract>+refs/heads/*:refs/remotes/remote/*</FONT></P>
<P><FONT class=extract>This refspec might be paraphrased as follows:</FONT></P>
<P><FONT class=extract>All the source branches from a remote repository in namespace refs/heads/ are (i) mapped into your local repository using a name constructed from the remote name and (ii) placed under the refs/remotes/remote namespace.</FONT></P>
<P><FONT class=extract>Because of the asterisks, this refspec applies to multiple branches as found in the remote&#8217;s refs/heads/*. It is exactly this specification that causes the remote&#8217;s topic branches to be mapped into your repository&#8217;s namespace as remote-tracking branches and separates them into subnames based on the remote name.</FONT></P>
<P><FONT class=extract>Although not mandatory, it is convention and common best practice to place the branches for a given remote under refs/remotes/remote/*.</FONT></P>
<P><FONT class=extract>Use git show-ref to list the references within your current repository.</FONT></P>
<P><FONT class=extract>Use git ls-remote repository to list the references in a remote repository. </FONT></P>
<P><FONT class=extract>Because git pull&#8217;s first step is fetch, the fetch refspecs apply equally to gitpull.</FONT></P>
<P><FONT class=extract>You should not make commits or merges onto a remote-tracking branch identified on the righthand side of a pull or fetch refspec. Those refs will be used as remote-tracking branches.</FONT></P>
<P><FONT class=extract>During a git push operation, you typically want to provide and publish the changes you made on your local topic branches. To allow others to find your changes in the remote repository after you upload them, your changes must appear in that repository as topic branches. Thus, during a typical git push command, the source branches from your repository are sent to the remote repository using a refspec such as:</FONT></P>
<P><FONT class=extract>+refs/heads/*:refs/heads/*</FONT></P>
<P><FONT class=extract>This refspec can be paraphrased as follows: From the local repository, take each branch name found under the source namespace refs/heads/ and place it in a similarly named, matching branch under the destination namespace refs/heads/ in the remote repository.</FONT></P>
<P><FONT class=extract>The first refs/heads/ refers to your local repository (because you&#8217;re executing a push), and the second refers to the remote repository. The asterisks ensure that all branches are replicated.</FONT></P>
<P><FONT class=extract>Multiple refspecs may be given on the git fetch and git push command lines. Within a remote definition, multiple fetch refspecs, multiple push refspecs, or a combination of both may be specified.</FONT></P>
<P><FONT class=extract>What if you don&#8217;t specify a refspec at all on a git push command? How does Git know what to do or where to send data?</FONT></P>
<P><FONT class=extract>First, without an explicit remote given to the command, Git assumes you want to use origin. Without a refspec, git push will send your commits to the remote for all branches that are common between your repository and the upstream repository. Any local branch that is not already present in the upstream repository will not be sent upstream; branches must already exist and match names. Thus, new branches must be explicitly pushed by name. Later they can be defaulted with a simple git push. Thus, the default refspec makes the following two commands equivalent:</FONT></P>
<P><FONT class=extract>$ git push origin branch </FONT></P>
<P><FONT class=extract>$ git push origin branch:refs/heads/branch</FONT></P>
<P>For examples, see &#8220;Adding and Deleting Remote Branches&#8221; on page 231.<SPAN lang=EN-US style="FONT-SIZE: 12pt; COLOR: black; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt"></SPAN>