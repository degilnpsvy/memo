/**<BR>&nbsp;* kstrdup - allocate space for and copy an existing string<BR>&nbsp;* @s: the string to duplicate<BR>&nbsp;* @gfp: the GFP mask used in the kmalloc() call when allocating memory<BR>&nbsp;*/<BR>char *kstrdup(const char *s, gfp_t gfp)<BR>{<BR>&nbsp;size_t len;<BR>&nbsp;char *buf;</P>
<P>&nbsp;if (!s)<BR>&nbsp;&nbsp;return NULL;</P>
<P>&nbsp;len = strlen(s) + 1;<BR>&nbsp;buf = kmalloc_track_caller(len, gfp);<BR>&nbsp;if (buf)<BR>&nbsp;&nbsp;memcpy(buf, s, len);<BR>&nbsp;return buf;<BR>}<BR>EXPORT_SYMBOL(kstrdup);