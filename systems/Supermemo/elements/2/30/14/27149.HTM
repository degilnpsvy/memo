class&#30340;&#27880;&#20876;&#65292;&#26159;&#30001;<SPAN class=cloze>[...]</SPAN>&#25509;&#21475;&#65288;&#23427;&#30340;&#23454;&#29616;&#20301;&#20110;"drivers/base/class.c, line 609"&#65289;&#23454;&#29616;&#30340;&#65292;&#23427;&#30340;&#22788;&#29702;&#36923;&#36753;&#21644;bus&#30340;&#27880;&#20876;&#31867;&#20284;&#65292;&#20027;&#35201;&#21253;&#25324;&#65306; 
<P></P>
<UL>
<LI>&#20026;class&#32467;&#26500;&#20013;&#30340;struct subsys_private&#31867;&#22411;&#30340;&#25351;&#38024;&#65288;cp&#65289;&#20998;&#37197;&#31354;&#38388;&#65292;&#24182;&#21021;&#22987;&#21270;&#20854;&#20013;&#30340;&#23383;&#27573;&#65292;&#21253;&#25324;cp-&gt;subsys.kobj.kset&#12289;cp-&gt;subsys.kobj.ktype&#31561;&#31561; 
<LI>&#35843;&#29992;kset_register&#65292;&#27880;&#20876;&#35813;class&#65288;&#22238;&#24518;&#8220;<A href="http://www.wowotech.net/linux_kenrel/bus.html">Linux&#35774;&#22791;&#27169;&#22411;(6)_Bus</A>&#8221;&#20013;&#30340;&#25551;&#36848;&#65292;&#19968;&#20010;class&#23601;&#26159;&#19968;&#20010;&#23376;&#31995;&#32479;&#65292;&#22240;&#27492;&#27880;&#20876;class&#20063;&#26159;&#27880;&#20876;&#23376;&#31995;&#32479;&#65289;&#12290;&#35813;&#36807;&#31243;&#32467;&#26463;&#21518;&#65292;&#22312;/sys/class/&#30446;&#24405;&#19979;&#65292;&#23601;&#20250;&#21019;&#24314;&#23545;&#24212;&#35813;class&#65288;&#23376;&#31995;&#32479;&#65289;&#30340;&#30446;&#24405; 
<LI>&#35843;&#29992;add_class_attrs&#25509;&#21475;&#65292;&#23558;class&#32467;&#26500;&#20013;class_attrs&#25351;&#38024;&#25152;&#25351;&#21521;&#30340;attribute&#65292;&#28155;&#21152;&#21040;&#20869;&#26680;&#20013;&#12290;&#25191;&#34892;&#23436;&#21518;&#65292;&#22312;/sys/class/xxx_class/&#30446;&#24405;&#19979;&#65292;&#23601;&#20250;&#30475;&#21040;&#36825;&#20123;attribute&#23545;&#24212;&#30340;&#25991;&#20214; </LI></UL><PRE class="prettyprint lang-c"><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L166" name=L166><SPAN class=lit><FONT size=4>166</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=typ>int</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=__class_register"><SPAN class=pln><FONT size=4>__class_register</FONT></SPAN></A><FONT size=4><SPAN class=pun>(</SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><SPAN class=kwd>class</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>cls</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=lock_class_key"><SPAN class=pln><FONT size=4>lock_class_key</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=key"><SPAN class=pln><FONT size=4>key</FONT></SPAN></A><SPAN class=pun><FONT size=4>)</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L167" name=L167><SPAN class=lit><FONT size=4>167</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L168" name=L168><SPAN class=lit><FONT size=4>168</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=subsys_private"><SPAN class=pln><FONT size=4>subsys_private</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L169" name=L169><SPAN class=lit><FONT size=4>169</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=typ>int</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L170" name=L170><SPAN class=lit><FONT size=4>170</FONT></SPAN></A><SPAN class=pln><FONT size=4> 
</FONT></SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L171" name=L171><SPAN class=lit><FONT size=4>171</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=pr_debug"><SPAN class=pln><FONT size=4>pr_debug</FONT></SPAN></A><FONT size=4><SPAN class=pun>(</SPAN><I><SPAN class=str>"device class '%s': registering\n"</SPAN></I><SPAN class=pun>,</SPAN><SPAN class=pln> cls</SPAN><SPAN class=pun>-&gt;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=name"><SPAN class=pln><FONT size=4>name</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L172" name=L172><SPAN class=lit><FONT size=4>172</FONT></SPAN></A><SPAN class=pln><FONT size=4> 
</FONT></SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L173" name=L173><SPAN class=lit><FONT size=4>173</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=kzalloc"><SPAN class=pln><FONT size=4>kzalloc</FONT></SPAN></A><FONT size=4><SPAN class=pun>(</SPAN><SPAN class=kwd>sizeof</SPAN><SPAN class=pun>(*</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><FONT size=4><SPAN class=pun>),</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=GFP_KERNEL"><SPAN class=pln><FONT size=4>GFP_KERNEL</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L174" name=L174><SPAN class=lit><FONT size=4>174</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>)</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L175" name=L175><SPAN class=lit><FONT size=4>175</FONT></SPAN></A><FONT size=4><SPAN class=pln>                 </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>-</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=ENOMEM"><SPAN class=pln><FONT size=4>ENOMEM</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L176" name=L176><SPAN class=lit><FONT size=4>176</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=klist_init"><SPAN class=pln><FONT size=4>klist_init</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><FONT size=4><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=klist_class_dev_get"><SPAN class=pln><FONT size=4>klist_class_dev_get</FONT></SPAN></A><FONT size=4><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=klist_class_dev_put"><SPAN class=pln><FONT size=4>klist_class_dev_put</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L177" name=L177><SPAN class=lit><FONT size=4>177</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=INIT_LIST_HEAD"><SPAN class=pln><FONT size=4>INIT_LIST_HEAD</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=interfaces"><FONT size=4><SPAN class=typ>int</SPAN><SPAN class=pln>erfaces</SPAN></FONT></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L178" name=L178><SPAN class=lit><FONT size=4>178</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kset_init"><SPAN class=pln><FONT size=4>kset_init</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><FONT size=4><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>glue_dirs</SPAN><SPAN class=pun>);</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L179" name=L179><SPAN class=lit><FONT size=4>179</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=__mutex_init"><SPAN class=pln><FONT size=4>__mutex_init</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=mutex"><SPAN class=pln><FONT size=4>mutex</FONT></SPAN></A><FONT size=4><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN><I><SPAN class=str>"subsys mutex"</SPAN></I><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=key"><SPAN class=pln><FONT size=4>key</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L180" name=L180><SPAN class=lit><FONT size=4>180</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=kobject_set_name"><SPAN class=pln><FONT size=4>kobject_set_name</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=subsys"><SPAN class=pln><FONT size=4>subsys</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kobj"><SPAN class=pln><FONT size=4>kobj</FONT></SPAN></A><FONT size=4><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN><I><SPAN class=str>"%s"</SPAN></I><SPAN class=pun>,</SPAN><SPAN class=pln> cls</SPAN><SPAN class=pun>-&gt;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=name"><SPAN class=pln><FONT size=4>name</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L181" name=L181><SPAN class=lit><FONT size=4>181</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><FONT size=4><SPAN class=pun>)</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L182" name=L182><SPAN class=lit><FONT size=4>182</FONT></SPAN></A><SPAN class=pln><FONT size=4>                 </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kfree"><SPAN class=pln><FONT size=4>kfree</FONT></SPAN></A><SPAN class=pun><FONT size=4>(</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L183" name=L183><SPAN class=lit><FONT size=4>183</FONT></SPAN></A><FONT size=4><SPAN class=pln>                 </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L184" name=L184><SPAN class=lit><FONT size=4>184</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=pun>}</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L185" name=L185><SPAN class=lit><FONT size=4>185</FONT></SPAN></A><SPAN class=pln><FONT size=4> 
</FONT></SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L186" name=L186><SPAN class=lit><FONT size=4>186</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><B><I><SPAN class=com>/* set the default /sys/dev directory for devices of this class */</SPAN></I></B></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L187" name=L187><SPAN class=lit><FONT size=4>187</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN><SPAN class=pln>cls</SPAN><SPAN class=pun>-&gt;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=dev_kobj"><SPAN class=pln><FONT size=4>dev_kobj</FONT></SPAN></A><SPAN class=pun><FONT size=4>)</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L188" name=L188><SPAN class=lit><FONT size=4>188</FONT></SPAN></A><FONT size=4><SPAN class=pln>                 cls</SPAN><SPAN class=pun>-&gt;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=dev_kobj"><SPAN class=pln><FONT size=4>dev_kobj</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=sysfs_dev_char_kobj"><SPAN class=pln><FONT size=4>sysfs_dev_char_kobj</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L189" name=L189><SPAN class=lit><FONT size=4>189</FONT></SPAN></A><SPAN class=pln><FONT size=4> 
</FONT></SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L190" name=L190><SPAN class=lit><FONT size=4>190</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=com>#if defined(CONFIG_BLOCK)</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L191" name=L191><SPAN class=lit><FONT size=4>191</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><B><I><SPAN class=com>/* let the block class directory show up in the root of sysfs */</SPAN></I></B></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L192" name=L192><SPAN class=lit><FONT size=4>192</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=sysfs_deprecated"><SPAN class=pln><FONT size=4>sysfs_deprecated</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>||</SPAN><SPAN class=pln> cls </SPAN><SPAN class=pun>!=</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>&amp;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=block_class"><SPAN class=pln><FONT size=4>block_class</FONT></SPAN></A><SPAN class=pun><FONT size=4>)</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L193" name=L193><SPAN class=lit><FONT size=4>193</FONT></SPAN></A><SPAN class=pln><FONT size=4>                 </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=subsys"><SPAN class=pln><FONT size=4>subsys</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kobj"><SPAN class=pln><FONT size=4>kobj</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kset"><SPAN class=pln><FONT size=4>kset</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=class_kset"><SPAN class=pln><FONT size=4>class_kset</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L194" name=L194><SPAN class=lit><FONT size=4>194</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=com>#else</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L195" name=L195><SPAN class=lit><FONT size=4>195</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=subsys"><SPAN class=pln><FONT size=4>subsys</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kobj"><SPAN class=pln><FONT size=4>kobj</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kset"><SPAN class=pln><FONT size=4>kset</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=class_kset"><SPAN class=pln><FONT size=4>class_kset</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L196" name=L196><SPAN class=lit><FONT size=4>196</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=com>#endif</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L197" name=L197><SPAN class=lit><FONT size=4>197</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=subsys"><SPAN class=pln><FONT size=4>subsys</FONT></SPAN></A><SPAN class=pun><FONT size=4>.</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kobj"><SPAN class=pln><FONT size=4>kobj</FONT></SPAN></A><FONT size=4><SPAN class=pun>.</SPAN><SPAN class=pln>ktype </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>&amp;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=class_ktype"><SPAN class=pln><FONT size=4>class_ktype</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L198" name=L198><SPAN class=lit><FONT size=4>198</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><FONT size=4><SPAN class=pun>-&gt;</SPAN><SPAN class=kwd>class</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> cls</SPAN><SPAN class=pun>;</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L199" name=L199><SPAN class=lit><FONT size=4>199</FONT></SPAN></A><FONT size=4><SPAN class=pln>         cls</SPAN><SPAN class=pun>-&gt;</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln><FONT size=4>p</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L200" name=L200><SPAN class=lit><FONT size=4>200</FONT></SPAN></A><SPAN class=pln><FONT size=4> 
</FONT></SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L201" name=L201><SPAN class=lit><FONT size=4>201</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=kset_register"><SPAN class=pln><FONT size=4>kset_register</FONT></SPAN></A><SPAN class=pun><FONT size=4>(&amp;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>-&gt;</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=subsys"><SPAN class=pln><FONT size=4>subsys</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L202" name=L202><SPAN class=lit><FONT size=4>202</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><FONT size=4><SPAN class=pun>)</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L203" name=L203><SPAN class=lit><FONT size=4>203</FONT></SPAN></A><SPAN class=pln><FONT size=4>                 </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=kfree"><SPAN class=pln><FONT size=4>kfree</FONT></SPAN></A><SPAN class=pun><FONT size=4>(</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=cp"><SPAN class=pln><FONT size=4>cp</FONT></SPAN></A><SPAN class=pun><FONT size=4>);</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L204" name=L204><SPAN class=lit><FONT size=4>204</FONT></SPAN></A><FONT size=4><SPAN class=pln>                 </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L205" name=L205><SPAN class=lit><FONT size=4>205</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=pun>}</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L206" name=L206><SPAN class=lit><FONT size=4>206</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=add_class_attrs"><SPAN class=pln><FONT size=4>add_class_attrs</FONT></SPAN></A><SPAN class=pun><FONT size=4>(</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=class_get"><SPAN class=pln><FONT size=4>class_get</FONT></SPAN></A><FONT size=4><SPAN class=pun>(</SPAN><SPAN class=pln>cls</SPAN><SPAN class=pun>));</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L207" name=L207><SPAN class=lit><FONT size=4>207</FONT></SPAN></A><SPAN class=pln><FONT size=4>         </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=class_put"><SPAN class=pln><FONT size=4>class_put</FONT></SPAN></A><FONT size=4><SPAN class=pun>(</SPAN><SPAN class=pln>cls</SPAN><SPAN class=pun>);</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L208" name=L208><SPAN class=lit><FONT size=4>208</FONT></SPAN></A><FONT size=4><SPAN class=pln>         </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pln> </SPAN></FONT><A href="http://lxr.oss.org.cn/ident?i=error"><SPAN class=pln><FONT size=4>error</FONT></SPAN></A><SPAN class=pun><FONT size=4>;</FONT></SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L209" name=L209><SPAN class=lit><FONT size=4>209</FONT></SPAN></A><FONT size=4><SPAN class=pln> </SPAN><SPAN class=pun>}</SPAN></FONT><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/class.c#L210" name=L210><SPAN class=lit><FONT size=4>210</FONT></SPAN></A><SPAN class=pln><FONT size=4> </FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=EXPORT_SYMBOL_GPL"><SPAN class=pln><FONT size=4>EXPORT_SYMBOL_GPL</FONT></SPAN></A><SPAN class=pun><FONT size=4>(</FONT></SPAN><A href="http://lxr.oss.org.cn/ident?i=__class_register"><SPAN class=pln><FONT size=4>__class_register</FONT></SPAN></A><FONT size=4><SPAN class=pun>);</SPAN><SPAN class=pln></SPAN></FONT></PRE>