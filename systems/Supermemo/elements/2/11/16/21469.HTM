# Generate some files<BR># ---------------------------------------------------------------------------
<P></P>
<P># KERNELRELEASE can change from a few different places, meaning version.h<BR># needs to be updated, so this check is forced on all builds</P>
<P>uts_len := 64<BR>define filechk_utsrelease.h<BR>&nbsp;if [ `echo -n "$(KERNELRELEASE)" | wc -c ` -gt $(uts_len) ]; then \<BR>&nbsp;&nbsp; echo '"$(KERNELRELEASE)" exceeds $(uts_len) characters' &gt;&amp;2;&nbsp;&nbsp;&nbsp; \<BR>&nbsp;&nbsp; exit 1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<BR>&nbsp;fi;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<BR>&nbsp;(echo \#define UTS_RELEASE \"$(KERNELRELEASE)\";)<BR>endef</P>
<P>define filechk_version.h<BR>&nbsp;(echo \#define LINUX_VERSION_CODE $(shell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \<BR>&nbsp;expr $(VERSION) \* 65536 + 0$(PATCHLEVEL) \* 256 + 0$(SUBLEVEL)); \<BR>&nbsp;echo '#define KERNEL_VERSION(a,b,c) (((a) &lt;&lt; 16) + ((b) &lt;&lt; 8) + (c))';)<BR>endef</P>
<P>$(version_h): $(srctree)/Makefile FORCE<BR>&nbsp;$(call filechk,version.h)<BR>&nbsp;$(Q)rm -f $(old_version_h)</P>
<P>include/generated/utsrelease.h: include/config/kernel.release FORCE<BR>&nbsp;$(call filechk,utsrelease.h)</P>
<P>PHONY += headerdep<BR>headerdep:<BR>&nbsp;$(Q)find $(srctree)/include/ -name '*.h' | xargs --max-args 1 \<BR>&nbsp;$(srctree)/scripts/headerdep.pl -I$(srctree)/include