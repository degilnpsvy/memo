static inline unsigned long virt_to_phys(volatile void *address)<BR>{<BR>&nbsp;return __pa((unsigned long)address);<BR>}
<P></P><PRE><A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/include/asm/page.h#40" name=40>40</A>#<B>define</B> <A class=xm name=__pa></A><A class=xm href="http://172.21.12.145:8080/source/s?refs=__pa&amp;project=linux-4.3">__pa</A>(x)		<A href="http://172.21.12.145:8080/source/s?defs=__phys_addr&amp;project=linux-4.3">__phys_addr</A>((<B>unsigned</B> <B>long</B>)(x))</PRE><PRE><A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#10" name=10>10</A>#<B>ifdef</B> <A href="http://172.21.12.145:8080/source/s?defs=CONFIG_X86_64&amp;project=linux-4.3">CONFIG_X86_64</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#11" name=11>11</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#12" name=12>12</A>#<B>ifdef</B> <A href="http://172.21.12.145:8080/source/s?defs=CONFIG_DEBUG_VIRTUAL&amp;project=linux-4.3">CONFIG_DEBUG_VIRTUAL</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#13" name=13>13</A><B>unsigned</B> <B>long</B> <A class=xf name=__phys_addr></A><A class=xf href="http://172.21.12.145:8080/source/s?refs=__phys_addr&amp;project=linux-4.3">__phys_addr</A>(<B>unsigned</B> <B>long</B> x)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#14" name=14>14</A>{
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#15" name=15>15</A>	<B>unsigned</B> <B>long</B> y = x - <A href="http://172.21.12.145:8080/source/s?defs=__START_KERNEL_map&amp;project=linux-4.3">__START_KERNEL_map</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#16" name=16>16</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#17" name=17>17</A>	<SPAN class=c>/* use the carry flag to determine if x was &lt; __START_KERNEL_map */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#18" name=18>18</A>	<B>if</B> (<A href="http://172.21.12.145:8080/source/s?defs=unlikely&amp;project=linux-4.3">unlikely</A>(x &gt; y)) {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#19" name=19>19</A>		x = y + <A href="http://172.21.12.145:8080/source/s?defs=phys_base&amp;project=linux-4.3">phys_base</A>;
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#20" name=20>20</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#21" name=21>21</A>		<A href="http://172.21.12.145:8080/source/s?defs=VIRTUAL_BUG_ON&amp;project=linux-4.3">VIRTUAL_BUG_ON</A>(y &gt;= <A href="http://172.21.12.145:8080/source/s?defs=KERNEL_IMAGE_SIZE&amp;project=linux-4.3">KERNEL_IMAGE_SIZE</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#22" name=22>22</A>	} <B>else</B> {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#23" name=23>23</A>		x = y + (<A href="http://172.21.12.145:8080/source/s?defs=__START_KERNEL_map&amp;project=linux-4.3">__START_KERNEL_map</A> - <A href="http://172.21.12.145:8080/source/s?defs=PAGE_OFFSET&amp;project=linux-4.3">PAGE_OFFSET</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#24" name=24>24</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#25" name=25>25</A>		<SPAN class=c>/* carry flag will be set if starting x was &gt;= PAGE_OFFSET */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#26" name=26>26</A>		<A href="http://172.21.12.145:8080/source/s?defs=VIRTUAL_BUG_ON&amp;project=linux-4.3">VIRTUAL_BUG_ON</A>((x &gt; y) || !<A href="http://172.21.12.145:8080/source/s?defs=phys_addr_valid&amp;project=linux-4.3">phys_addr_valid</A>(x));
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#27" name=27>27</A>	}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#28" name=28>28</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#29" name=29>29</A>	<B>return</B> x;
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#30" name=30>30</A>}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/arch/x86/mm/physaddr.c#31" name=31>31</A><A href="http://172.21.12.145:8080/source/s?defs=EXPORT_SYMBOL&amp;project=linux-4.3">EXPORT_SYMBOL</A>(<A class=xv name=__phys_addr></A><A class=xv href="http://172.21.12.145:8080/source/s?refs=__phys_addr&amp;project=linux-4.3">__phys_addr</A>);</PRE>