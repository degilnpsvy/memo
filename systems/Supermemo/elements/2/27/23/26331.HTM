<I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">do_IRQ</SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">, defined in </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">irq.c</SPAN></I>
<P></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">There are many irq.c instances in different archs:</SPAN></I></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">The one in x86:</SPAN></I></P><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt"><PRE><A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#209" name=209>209</A><SPAN class=c>/*
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#210" name=210>210</A> * do_IRQ handles all normal device IRQ's (the special
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#211" name=211>211</A> * SMP cross-CPU interrupts have their own specific
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#212" name=212>212</A> * handlers).
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#213" name=213>213</A> */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#214" name=214>214</A><A href="http://172.21.12.145:8080/source/s?defs=__visible&amp;project=linux-4.5">__visible</A> <B>unsigned</B> <B>int</B> <A href="http://172.21.12.145:8080/source/s?defs=__irq_entry&amp;project=linux-4.5">__irq_entry</A> <A class=xf name=do_IRQ></A><A class=xf href="http://172.21.12.145:8080/source/s?refs=do_IRQ&amp;project=linux-4.5">do_IRQ</A>(<B>struct</B> <A href="http://172.21.12.145:8080/source/s?defs=pt_regs&amp;project=linux-4.5">pt_regs</A> *<A class=xa name=regs></A><A class=xa href="http://172.21.12.145:8080/source/s?refs=regs&amp;project=linux-4.5">regs</A>)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#215" name=215>215</A>{
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#216" name=216>216</A>	<B>struct</B> <A href="http://172.21.12.145:8080/source/s?defs=pt_regs&amp;project=linux-4.5">pt_regs</A> *<A class=xl name=old_regs></A><A class=xl href="http://172.21.12.145:8080/source/s?refs=old_regs&amp;project=linux-4.5">old_regs</A> = <A href="http://172.21.12.145:8080/source/s?defs=set_irq_regs&amp;project=linux-4.5">set_irq_regs</A>(<A href="http://172.21.12.145:8080/source/s?defs=regs&amp;project=linux-4.5">regs</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#217" name=217>217</A>	<B>struct</B> <A href="http://172.21.12.145:8080/source/s?defs=irq_desc&amp;project=linux-4.5">irq_desc</A> * <A class=xl name=desc></A><A class=xl href="http://172.21.12.145:8080/source/s?refs=desc&amp;project=linux-4.5">desc</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#218" name=218>218</A>	<SPAN class=c>/* high bit used in ret_from_ code  */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#219" name=219>219</A>	<B>unsigned</B> <A class=xl name=vector></A><A class=xl href="http://172.21.12.145:8080/source/s?refs=vector&amp;project=linux-4.5">vector</A> = ~<A href="http://172.21.12.145:8080/source/s?defs=regs&amp;project=linux-4.5">regs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=orig_ax&amp;project=linux-4.5">orig_ax</A>;
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#220" name=220>220</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#221" name=221>221</A>	<SPAN class=c>/*
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#222" name=222>222</A>	 * NB: Unlike exception entries, IRQ entries do not reliably
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#223" name=223>223</A>	 * handle context tracking in the low-level entry code.  This is
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#224" name=224>224</A>	 * because syscall entries execute briefly with IRQs on before
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#225" name=225>225</A>	 * updating context tracking state, so we can take an IRQ from
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#226" name=226>226</A>	 * kernel mode with CONTEXT_USER.  The low-level entry code only
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#227" name=227>227</A>	 * updates the context if we came from user mode, so we won't
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#228" name=228>228</A>	 * switch to CONTEXT_KERNEL.  We'll fix that once the syscall
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#229" name=229>229</A>	 * code is cleaned up enough that we can cleanly defer enabling
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#230" name=230>230</A>	 * IRQs.
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#231" name=231>231</A>	 */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#232" name=232>232</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#233" name=233>233</A>	<A href="http://172.21.12.145:8080/source/s?defs=entering_irq&amp;project=linux-4.5">entering_irq</A>();
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#234" name=234>234</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#235" name=235>235</A>	<SPAN class=c>/* entering_irq() tells RCU that we're not quiescent.  Check it. */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#236" name=236>236</A>	<A href="http://172.21.12.145:8080/source/s?defs=RCU_LOCKDEP_WARN&amp;project=linux-4.5">RCU_LOCKDEP_WARN</A>(!<A href="http://172.21.12.145:8080/source/s?defs=rcu_is_watching&amp;project=linux-4.5">rcu_is_watching</A>(), <SPAN class=s>"IRQ failed to wake up RCU"</SPAN>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#237" name=237>237</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#238" name=238>238</A>	<A href="http://172.21.12.145:8080/source/s?defs=desc&amp;project=linux-4.5">desc</A> = <A href="http://172.21.12.145:8080/source/s?defs=__this_cpu_read&amp;project=linux-4.5">__this_cpu_read</A>(<A href="http://172.21.12.145:8080/source/s?defs=vector_irq&amp;project=linux-4.5">vector_irq</A>[<A href="http://172.21.12.145:8080/source/s?defs=vector&amp;project=linux-4.5">vector</A>]);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#239" name=239>239</A>
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#240" name=240>240</A>	<B>if</B> (!<A href="http://172.21.12.145:8080/source/s?defs=handle_irq&amp;project=linux-4.5">handle_irq</A>(<A href="http://172.21.12.145:8080/source/s?defs=desc&amp;project=linux-4.5">desc</A>, <A href="http://172.21.12.145:8080/source/s?defs=regs&amp;project=linux-4.5">regs</A>)) {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#241" name=241>241</A>		<A href="http://172.21.12.145:8080/source/s?defs=ack_APIC_irq&amp;project=linux-4.5">ack_APIC_irq</A>();
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#242" name=242>242</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#243" name=243>243</A>		<B>if</B> (<A href="http://172.21.12.145:8080/source/s?defs=desc&amp;project=linux-4.5">desc</A> != <A href="http://172.21.12.145:8080/source/s?defs=VECTOR_RETRIGGERED&amp;project=linux-4.5">VECTOR_RETRIGGERED</A>) {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#244" name=244>244</A>			<A href="http://172.21.12.145:8080/source/s?defs=pr_emerg_ratelimited&amp;project=linux-4.5">pr_emerg_ratelimited</A>(<SPAN class=s>"%s: %d.%d No irq handler for vector\n"</SPAN>,
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#245" name=245>245</A>					     <A href="http://172.21.12.145:8080/source/s?defs=__func__&amp;project=linux-4.5">__func__</A>, <A href="http://172.21.12.145:8080/source/s?defs=smp_processor_id&amp;project=linux-4.5">smp_processor_id</A>(),
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#246" name=246>246</A>					     <A href="http://172.21.12.145:8080/source/s?defs=vector&amp;project=linux-4.5">vector</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#247" name=247>247</A>		} <B>else</B> {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#248" name=248>248</A>			<A href="http://172.21.12.145:8080/source/s?defs=__this_cpu_write&amp;project=linux-4.5">__this_cpu_write</A>(<A href="http://172.21.12.145:8080/source/s?defs=vector_irq&amp;project=linux-4.5">vector_irq</A>[<A href="http://172.21.12.145:8080/source/s?defs=vector&amp;project=linux-4.5">vector</A>], <A href="http://172.21.12.145:8080/source/s?defs=VECTOR_UNUSED&amp;project=linux-4.5">VECTOR_UNUSED</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#249" name=249>249</A>		}
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#250" name=250>250</A>	}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#251" name=251>251</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#252" name=252>252</A>	<A href="http://172.21.12.145:8080/source/s?defs=exiting_irq&amp;project=linux-4.5">exiting_irq</A>();
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#253" name=253>253</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#254" name=254>254</A>	<A href="http://172.21.12.145:8080/source/s?defs=set_irq_regs&amp;project=linux-4.5">set_irq_regs</A>(<A href="http://172.21.12.145:8080/source/s?defs=old_regs&amp;project=linux-4.5">old_regs</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#255" name=255>255</A>	<B>return</B> <SPAN class=n>1</SPAN>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.5/arch/x86/kernel/irq.c#256" name=256>256</A>}</PRE></SPAN>