<H4 id=title-ID0E4FAO class=docSection2Title>Completion Interface</H4>
<P class=docText><A name="parts of"></A>Many parts of the kernel initiate certain activities as separate execution threads and then wait for them to complete. The <SPAN class=docEmphasis>completion</SPAN><A name="code patterns"></A> interface is an efficient and easy way to implement such code patterns.</P>
<P class=docText><A name=iddle1040></A><A name=iddle1107></A><A name=iddle3786></A><A name=iddle4187></A><A name="Some example"></A>Some example usage scenarios include the following:</P>
<UL>
<LI>
<P class=docList><A name="module is"></A><FONT class=extract>Your driver module is assisted by a kernel thread. If you rmmod the module, the <TT>release()</TT></FONT><A name="is invoked"></A><FONT class=extract> method is invoked before removing the module code from kernel space. The release routine asks the thread to kill itself and blocks until the thread completes its exit. </FONT><A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch03lev1sec2.html#ch03ex07"><FONT class=extract>Listing 3.7</FONT></A><FONT class=extract> implements this case.</FONT></P>
<LI>
<P class=docList><A name="driver "></A>You are writing a portion of a block device driver (discussed in <A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch14.html#ch14">Chapter 14</A><A name="to a"></A>, "Block Drivers") that queues a read request to a device. This triggers a state machine change implemented as a separate thread or work queue. The driver wants to wait until the operation completes before proceeding with another activity. Look at <SPAN class=docEmphasis>drivers/block/floppy.c</SPAN> for an example.</P>
<LI>
<P class=docList>An application requests an <SPAN class=docEmphasis>Analog-to-Digital Converter</SPAN><A name="request waits"></A> (ADC) driver for a data sample. The driver initiates a conversion request waits, until an interrupt signals completion of conversion, and returns the data.</P></LI></UL>