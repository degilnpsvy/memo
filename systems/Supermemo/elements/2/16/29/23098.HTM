<H3 id=-100000 class=docSection1Title>Audio Architecture</H3>
<P class=docText><A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch13.html#ch13fig01">Figure 13.1</A><A name="the South"></A> shows audio connection on a PC-compatible system. The audio controller on the South Bridge, together with an external codec, interfaces with analog audio circuitry.</P><A name=ch13fig01></A>
<P>
<CENTER>
<H5 class=docFigureTitle>Figure 13.1. Audio in the PC environment.</H5>
<P class=docText>
<DIV class=st1><A href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/images/ZTVyMWQ5OHB0Z2lzMC8vbWMzNWE5NC9yMzZnMjdhZy5wX2xjc2kwMXQvMTNoZmlnaWFm.jpg" target=_blank>[View full size image]</A></DIV><IMG border=0 alt="" src="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/images/ZTVyMWQ5OHB0Z2lzMC8vbWMzNWE5NC9yMzZnMjdhZ3AuaWNzaTAxLzFmM2hpZ2Y-.jpg" width=500 height=323>
<P></P></CENTER>
<P></P><BR>
<P class=docText><A name=iddle1011></A><A name=iddle1156></A><A name=iddle1161></A><A name=iddle1196></A><A name=iddle1662></A><A name=iddle1834></A><A name=iddle2312></A><A name=iddle2415></A><A name=iddle3008></A><A name=iddle3501></A><A name=iddle3687></A><A name=iddle4085></A>An <SPAN class=docEmphasis>audio codec</SPAN><A name="analog sound"></A> converts digital audio data to analog sound signals for playing through speakers and performs the reverse operation for recording through a microphone. Other common audio inputs and outputs that interface with a codec include headsets, earphones, handsets, hands-free, line-in, and line-out. A codec also offers <SPAN class=docEmphasis>mixer</SPAN><A name="audio inputs"></A> functionality that connects it to a combination of these audio inputs and outputs, and controls the volume gain of associated audio signals.<SUP class=docFootnote><A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch13.html#ch13fn01">[1]</A></SUP></P>
<BLOCKQUOTE>
<P class=docFootnote><SUP><A name=ch13fn01>[1]</A></SUP><A name="a software"></A> This definition of a mixer is from a software perspective. <SPAN class=docEmphasis>Sound mixing</SPAN> or <SPAN class=docEmphasis>data mixing</SPAN><A name="sound streams"></A> refers to the capability of some codecs to mix multiple sound streams and generate a single stream. This is needed, for example, if you want to superimpose an announcement while a voice communication is in progress on an IP phone. The alsa-lib library, discussed in the latter part of this chapter, supports a plug-in feature called <SPAN class=docEmphasis>dmix</SPAN><A name="mixing in"></A> that performs data mixing in software if your codec does not have the capability to perform this operation in hardware.</P></BLOCKQUOTE>
<P class=docText><A name="data is"></A>Digital audio data is obtained by sampling analog audio signals at specific bit rates using a technique called <SPAN class=docEmphasis><A name="pulse code"></A>pulse code modulation</SPAN><A name="for example"></A> (PCM). CD quality is, for example, sound sampled at 44.1KHz, using 16 bits to hold each sample. A codec is responsible for recording audio by sampling at supported PCM bit rates and for playing audio originally sampled at different PCM bit rates.</P>
<P class=docText><A name="sound card"></A>A sound card may support one or more codecs. Each codec may, in turn, support one or more audio substreams in mono or stereo.</P>
<P class=docText>The Audio Codec'97 (AC'97) and the Inter-IC Sound (I<SUP>2</SUP><A name="audio controllers"></A>S) bus are examples of industry standard interfaces that connect audio controllers to codecs:</P>
<UL>
<LI>
<P class=docList>The Intel AC'97 specification, downloadable from <A class=docLink href="http://download.intel.com/" target=_blank>http://download.intel.com/</A><A name="of audio"></A>, specifies the semantics and locations of audio registers. Configuration registers are part of the audio controller, while the I/O register space is situated inside the codec. Requests to operate on I/O registers are forwarded by the audio controller to the codec over the AC'97 link. The register that controls line-in volume, for example, lives at offset <TT>0x10</TT> within the AC'97 I/O space. The PC system in <A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch13.html#ch13fig01">Figure 13.1</A> uses AC'97 to communicate with an external codec.</P></LI>
<LI>
<P class=docList><A name=iddle1066></A><A name=iddle1095></A><A name=iddle1157></A><A name=iddle1193></A><A name=iddle2185></A><A name=iddle2219></A><A name=iddle3332></A><A name=iddle3349></A>The I<SUP>2</SUP>S specification, downloadable from <A class=docLink href="http://www.nxp.com/acrobat_download/various/I2SBUS.pdf" target=_blank>www.nxp.com/acrobat_download/various/I2SBUS.pdf</A><A name="device shown"></A>, is a codec interface standard developed by Philips. The embedded device shown in <A class=docLink href="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/ch13.html#ch13fig02">Figure 13.2</A> uses I<SUP>2</SUP><A name="Programming the"></A>S to send audio data to the codec. Programming the codec's I/O registers is done via the I<SUP>2</SUP>C bus.</P><A name=ch13fig02></A>
<P>
<CENTER>
<H5 class=docFigureTitle>Figure 13.2. Audio connection on an embedded system.</H5>
<P class=docText><IMG border=0 alt="" src="http://www.embeddedlinux.org.cn/EssentialLinuxDeviceDrivers/final/images/ZTVyMWQ5OHB0Z2lzMC8vbWMzNWE5NC9yMzZnMjdhZ3AuaWNzaTAxLzJmM2hpZ2Y-.jpg" width=500 height=176></P></CENTER>
<P></P></LI></UL><A name=ch13note01></A>
<DIV class=docNote>
<P>
<P class=docText><A name="bit rates"></A>AC'97 has limitations pertaining to the number of supported channels and bit rates. Recent South Bridge chipsets from Intel feature a new technology called High Definition (HD) Audio that offers higher-quality, surround sound, and multistreaming capabilities.</P></DIV>