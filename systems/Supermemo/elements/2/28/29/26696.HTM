/*<BR>&nbsp;* The core wakeup function. <SPAN class=cloze>[...]issue around exclusive</SPAN><BR>&nbsp;*<BR>&nbsp;* There are circumstances in which we can try to wake a task which has already<BR>&nbsp;* started to run but is not in state TASK_RUNNING. try_to_wake_up() returns<BR>&nbsp;* zero in this (rare) case, and we handle it by continuing to scan the queue.<BR>&nbsp;*/<BR>static void __wake_up_common(wait_queue_head_t *q, unsigned int mode,<BR>&nbsp;&nbsp;&nbsp;int nr_exclusive, int wake_flags, void *key)<BR>{<BR>&nbsp;wait_queue_t *curr, *next; 
<P></P>
<P>&nbsp;list_for_each_entry_safe(curr, next, &amp;q-&gt;task_list, task_list) {<BR>&nbsp;&nbsp;unsigned flags = curr-&gt;flags;</P>
<P>&nbsp;&nbsp;if (curr-&gt;func(curr, mode, wake_flags, key) &amp;&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;(flags &amp; WQ_FLAG_EXCLUSIVE) &amp;&amp; !--nr_exclusive)<BR>&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;}<BR>}