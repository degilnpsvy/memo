<HEADER class=entry-header>&nbsp;
<H1 class=entry-title>HRTIMER&#38519;&#38449;</H1>
<DIV class=entry-meta><SPAN class=sep>&#21457;&#34920;&#20110; </SPAN><A title="&#19979;&#21320; 11:10" href="http://mnstory.net/2014/05/hrtimer%e9%99%b7%e9%98%b1/" rel=bookmark><TIME class=entry-date datetime="2014-05-05T23:10:28+00:00">2014 &#24180; 5 &#26376; 5 &#26085;</TIME></A> </DIV></HEADER>
<DIV class=entry-content>
<H2>&#29616;&#35937;</H2>
<H3>&#29616;&#35937;&#19968;&#65292;&#22810;&#25968;&#36827;&#31243;&#21345;&#27515;&#65292;&#21576;D&#29366;&#24577;</H3>
<P></P>
<DIV id=crayon-569898beee051877350011 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee051877350011-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee051877350011-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee051877350011-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee051877350011-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee051877350011-5">5</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee051877350011-1 class=crayon-line><SPAN class=crayon-v>www</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-i>data</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>57377</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>D</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>15</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>06</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sbin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>apach</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee051877350011-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-v>www</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-i>data</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>58210</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>D</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>15</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>07</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sbin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>apach</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee051877350011-3 class=crayon-line><SPAN class=crayon-v>www</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-i>data</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>62679</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>D</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>15</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>10</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sbin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>apach</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee051877350011-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-v>www</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-i>data</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>78612</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>D</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>15</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sbin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>apach</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee051877350011-5 class=crayon-line><SPAN class=crayon-v>www</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-i>data</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>95842</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>D</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>15</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>31</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>_</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sbin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>apach</SPAN><SPAN class=crayon-sy>]</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#20174;&#21345;&#27515;&#36827;&#31243;&#35843;&#29992;&#26632;&#30475;&#65292;&#22823;&#37096;&#20998;&#31867;&#20284;&#65306; </P>
<DIV class=monospaced>[&lt;ffffffff81132b20&gt;] inotify_idr_find_locked+0x5a/0x6d<BR>[&lt;ffffffff81132cfc&gt;] inotify_remove_from_idr+0x1c9/0x1cb<BR>[&lt;ffffffff8106104e&gt;] default_wake_function+0x0/0x9<BR>[&lt;ffffffff81058d82&gt;] __synchronize_srcu+0xd7/0xe2<BR>[&lt;ffffffff810588af&gt;] wakeme_after_rcu+0x0/0x9<BR>[&lt;ffffffff81130ecd&gt;] fsnotify_destroy_group+0x15/0x26<BR>[&lt;ffffffff81132779&gt;] inotify_release+0x20/0x24<BR>[&lt;ffffffff81101771&gt;] __fput+0xe0/0x1b3<BR>[&lt;ffffffff8105e7a0&gt;] should_resched+0x5/0x23<BR>[&lt;ffffffff81052f4a&gt;] task_work_run+0x7b/0x91<BR>[&lt;ffffffff8103f6e3&gt;] do_exit+0x3c3/0x8f6<BR>[&lt;ffffffff8103fd80&gt;] do_group_exit+0x68/0x9a<BR>[&lt;ffffffff8103fdc1&gt;] __wake_up_parent+0x0/0x1d<BR>[&lt;ffffffff814a2029&gt;] system_call_fastpath+0x16/0x1b</DIV>
<P><SPAN id=more-312></SPAN></P>
<DIV class=monospaced>.text:FFFFFFFF81130EB8 public fsnotify_destroy_group<BR>.text:FFFFFFFF81130EB8 fsnotify_destroy_group proc near ; CODE XREF: inotify_release+1B<BR>.text:FFFFFFFF81130EB8 ; sys_inotify_init1+94<BR>.text:FFFFFFFF81130EB8 push rbx<BR>.text:FFFFFFFF81130EB9 mov rbx, rdi<BR>.text:FFFFFFFF81130EBC call fsnotify_clear_marks_by_group<BR>.text:FFFFFFFF81130EC1 mov rdi, 0FFFFFFFF81AEC340h<BR>.text:FFFFFFFF81130EC8 call synchronize_srcu ;&#36825;&#37324;&#35843;&#29992;synchronize_srcu<BR>.text:FFFFFFFF81130ECD mov rdi, rbx<BR>.text:FFFFFFFF81130ED0 call fsnotify_flush_notify<BR>.text:FFFFFFFF81130ED5 mov rdi, rbx<BR>.text:FFFFFFFF81130ED8 pop rbx<BR>.text:FFFFFFFF81130ED9 jmp fsnotify_put_group<BR>.text:FFFFFFFF81130ED9 fsnotify_destroy_group endp</DIV>
<P>fsnotify_destroy_group&#35843;&#29992;&#20102;RCU&#65292;&#30475;&#19979;&#20195;&#30721;&#65306;</P>
<DIV id=crayon-569898beee06a771319537 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-17">17</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee06a771319537-18">18</DIV>
<DIV class=crayon-num data-line="crayon-569898beee06a771319537-19">19</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee06a771319537-1 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fsnotify_destroy_group</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>fsnotify_group</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>group</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* clear all inode marks for this group */</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>fsnotify_clear_marks_by_group</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>group</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-5 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee06a771319537-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>synchronize_srcu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>fsnotify_mark_srcu</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-c>//&#21516;&#27493;fsnotify_mark_srcu</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-7 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee06a771319537-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* clear the notification queue of all events */</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-9 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>fsnotify_flush_notify</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>group</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-10 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee06a771319537-11 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>fsnotify_put_group</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>group</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-13 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee06a771319537-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>synchronize_srcu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-15 class=crayon-line><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-16 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>__synchronize_srcu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rcu</SPAN><SPAN class=crayon-sy>_</SPAN>expedited</DIV>
<DIV id=crayon-569898beee06a771319537-17 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>?</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>SYNCHRONIZE_SRCU_EXP_TRYCOUNT</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-18 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>SYNCHRONIZE_SRCU_TRYCOUNT</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee06a771319537-19 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#21345;&#22312;&#20102;synchronize_srcu&#37096;&#20998;&#65292;&#31561;&#24453;fsnotify_mark_srcu&#65292;&#20877;&#30475;&#30475;srcu_struct&#30456;&#20851;&#30340;&#20195;&#30721;&#65292;init_srcu_struct_fields&#20026;fsnotify_mark_srcu&#30340;&#21021;&#22987;&#21270;&#20989;&#25968;&#65292;&#20027;&#35201;&#26159;INIT_DELAYED_WORK&#35774;&#32622;&#20102;timer&#22238;&#35843;&#12290;</P>
<DIV id=crayon-569898beee072283384040 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee072283384040-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-17">17</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-18">18</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-19">19</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-20">20</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-21">21</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-22">22</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-23">23</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-24">24</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-25">25</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-26">26</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-27">27</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-28">28</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-29">29</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-30">30</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-31">31</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-32">32</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-33">33</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-34">34</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-35">35</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-36">36</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-37">37</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-38">38</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-39">39</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-40">40</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-41">41</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-42">42</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-43">43</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-44">44</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-45">45</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-46">46</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-47">47</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-48">48</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-49">49</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-50">50</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-51">51</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-52">52</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-53">53</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-54">54</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-55">55</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-56">56</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-57">57</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-58">58</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-59">59</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-60">60</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-61">61</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-62">62</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-63">63</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-64">64</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-65">65</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-66">66</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-67">67</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-68">68</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-69">69</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-70">70</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-71">71</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-72">72</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-73">73</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-74">74</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-75">75</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-76">76</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-77">77</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-78">78</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-79">79</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-80">80</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-81">81</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-82">82</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-83">83</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-84">84</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-85">85</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-86">86</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-87">87</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee072283384040-88">88</DIV>
<DIV class=crayon-num data-line="crayon-569898beee072283384040-89">89</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee072283384040-1 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>init_srcu_struct_fields</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>completed</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_lock_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>running</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>false</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_queue</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-7 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-9 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>INIT_DELAYED_WORK</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>process_srcu</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#36825;&#37324;&#21021;&#22987;&#21270;&#20102;timer&#22238;&#35843;&#20989;&#25968;process_srcu</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-11 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>per_cpu_ref</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>alloc_percpu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct_array</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>per_cpu</SPAN><SPAN class=crayon-sy>_</SPAN>ref<SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>?</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>ENOMEM</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-13 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-14 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-15 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process_srcu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>work_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-16 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-17 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-18 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-19 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>container_of</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-20 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-21 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_collect_new</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-22 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_advance_batches</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-23 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_invoke_callbacks</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-24 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_reschedule</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#20877;&#26816;&#26597;&#26159;&#21542;&#38656;&#35201;&#20877;&#27425;timer</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-25 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-26 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-27 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>__synchronize_srcu</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>trycount</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-28 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-29 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>rcu_synchronize </SPAN><SPAN class=crayon-v>rcu</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-30 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rcu_head</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-31 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>bool</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>done</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>false</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-32 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-33 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_lockdep_assert</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>lock_is_held</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>dep_map</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-34 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>lock_is_held</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu_bh_lock_map</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-35 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>lock_is_held</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu_lock_map</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-36 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>lock_is_held</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu_sched_lock_map</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-37 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-s>"Illegal synchronize_srcu() in same-type SRCU (or RCU) read-side critical section"</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-38 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-39 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>might_sleep</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-40 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>init_completion</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>completion</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-41 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-42 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>next</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-43 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>func</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>wakeme_after_rcu</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#36825;&#20010;&#20989;&#25968;&#20250;&#35843;&#29992;complete&#65292;&#21796;&#37266;&amp;rcu.completion</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-44 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_lock_irq</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-45 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>running</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-46 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* steal the processing owner */</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-47 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>running</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>true</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-48 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_queue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check0</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#21152;&#20837;&#38431;&#21015;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-49 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_unlock_irq</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-50 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-51 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_advance_batches</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>trycount</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-52 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN><SPAN class=crayon-c>//&#22914;&#26524;batch&#23436;&#25104;&#65292;&#20250;&#23558;batch_check0&#26368;&#32456;&#31227;&#20837;batch_done</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-53 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>BUG_ON</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>!=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-54 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_dequeue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#31227;&#38500;&#31532;&#19968;&#20010;&#65292;&#23601;&#26159;head</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-55 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>done</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>true</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-56 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-57 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* give the processing owner to work_struct */</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-58 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>srcu_reschedule</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#36825;&#37324;&#38754;re schedule&#65292;&#20351;&#29992;&#20102;&#26222;&#36890;timer&#65292;&#36890;&#36807;&#36825;&#20010;&#26469;&#36890;&#30693;complete</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-59 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>else</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-60 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_queue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_queue</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-61 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_unlock_irq</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-62 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-63 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-64 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-v>done</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-65 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>wait_for_completion</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rcu</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>completion</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-66 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-67 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-68 class="crayon-line crayon-striped-line"><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>srcu_reschedule</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>srcu_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-69 class=crayon-line><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-70 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>bool</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>pending</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>true</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-71 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-72 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-73 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-74 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-75 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_queue</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-76 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_lock_irq</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-77 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_done</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-78 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-79 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_check0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;&amp;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-80 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rcu_batch_empty</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>batch_queue</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-81 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>running</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>false</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-82 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>pending</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>false</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-83 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-84 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>spin_unlock_irq</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>queue_lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-85 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-86 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee072283384040-87 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>pending</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-c>//batch_check0&#19981;&#20026;&#31354;&#65292;&#25152;&#20197;&#35843;&#29992;&#36825;&#20010;SRCU_INTERVAL = 1</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-88 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>schedule_delayed_work</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>sp</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>work</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>SRCU_INTERVAL</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee072283384040-89 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#36816;&#34892;&#19978;&#38754;&#30340;&#20195;&#30721;&#65292;srcu_reschedule&#20250;&#35843;&#29992;add_timer(timer)&#28608;&#27963;&#36229;&#26102;timer&#65292;&#32780;&#24403;&#21069;&#32447;&#31243;&#21017;&#35843;&#29992;wait_for_completion&#31561;&#24453;&#12290;&#25152;&#20197;&#65292;&#22914;&#26524;timer&#37324;&#38754;&#30340;&#22238;&#35843;&#19968;&#30452;&#27809;&#22788;&#29702;&#23436;&#65292;&#21017;wait_for_completion&#20250;&#19968;&#30452;&#31561;&#24453;&#12290;</P>
<P>&#22810;&#23569;&#26632;&#37117;&#22312;__synchronize_srcu&#22788;&#21345;&#27515;&#65292;&#20174;ffffffff81058d82&#21453;&#27719;&#32534;&#30475;&#65292;&#26159;&#22312;&#35843;&#29992;wait_for_completion&#65292;&#34920;&#31034;&#65292;&#31561;&#24453;&#30340;&#20107;&#20799;&#27809;&#23436;&#12290; </P>
<DIV class=monospaced>.text:FFFFFFFF81058D78 lea rdi, [rsp+58h+var_48]<BR>.text:FFFFFFFF81058D7D call wait_for_completion<BR>.text:FFFFFFFF81058D82<BR>.text:FFFFFFFF81058D82 loc_FFFFFFFF81058D82: ; CODE XREF: __synchronize_srcu<BR>.text:FFFFFFFF81058D82 add rsp, 38h</DIV>
<P>&#37027;&#20040;&#20160;&#20040;&#21407;&#22240;&#23548;&#33268;&#30340;D&#29366;&#24577;&#65311;&#30475;wait_for_completion&#20989;&#25968;&#65292;&#35774;&#32622;&#20102;TASK_UNINTERRUPTIBLE&#26631;&#35760;&#65292;&#28982;&#21518;seched out&#65292;&#33258;&#28982;&#26159;D&#29366;&#24577;&#12290;</P>
<DIV id=crayon-569898beee07f790380417 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee07f790380417-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee07f790380417-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee07f790380417-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee07f790380417-4">4</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee07f790380417-1 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>__sched </SPAN><SPAN class=crayon-e>wait_for_completion</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>completion</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>x</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee07f790380417-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee07f790380417-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>wait_for_common</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>x</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>MAX_SCHEDULE_TIMEOUT</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>TASK_UNINTERRUPTIBLE</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#36825;&#37324;&#35774;&#32622;&#20102;TASK_UNINTERRUPTIBLE&#65292;&#25152;&#20197;&#36827;&#31243;&#20026;D&#29366;&#24577;</SPAN></DIV>
<DIV id=crayon-569898beee07f790380417-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#36825;&#37324;&#65292; wait_for_completion&#31561;&#24453;&#65292;&#36824;&#26377;&#19968;&#20010;&#21407;&#22240;&#65292;&#27604;&#36739;&#38544;&#26214;&#65292;&#26159;timer&#27809;&#26377;&#34987;&#22238;&#35843;&#65292;&#65292;&#21518;&#32493;&#20998;&#26512;&#20986;&#26469;&#36825;&#25165;&#26159;&#26412;&#27425;&#38382;&#39064;&#30340;&#26681;&#26412;&#21407;&#22240;&#65292;&#24403;&#26102;&#26410;&#20998;&#26512;&#20986;&#26469;&#65292;&#22240;&#20026;&#36825;&#31181;&#27010;&#29575;&#23454;&#22312;&#26159;&#23569;&#24471;&#26080;&#27861;&#24819;&#35937;&#12290;</P>
<H3>&#29616;&#35937;&#20108;&#65292;&#34394;&#25311;&#26426;&#34987;&#26242;&#20572;&#65292;&#30913;&#30424;&#20551;&#25481;&#32447;</H3>
<P>&#26085;&#24535;&#36755;&#20986;&#65306; </P>
<DIV class=monospaced>&lt;6&gt; sfvtk_sffs sffs_file.c:578 6 | vm-disk-2.qcow2 generic_file_aio_write failed, ret=-5</DIV>
<P>&#20854;&#35843;&#29992;&#26632;&#20026;&#65306; </P>
<DIV class=monospaced>[&lt;ffffffff81046d57&gt;] process_timeout+0x0/0x5<BR>[&lt;ffffffff810478de&gt;] msleep+0x13/0x1a<BR>[&lt;ffffffffa20bf02a&gt;] sffs_fblk_thread+0x47a/0x4a0 [sffs]<BR>[&lt;ffffffffa20bebb0&gt;] sffs_fblk_thread+0x0/0x4a0 [sffs]<BR>[&lt;ffffffffa20bebb0&gt;] sffs_fblk_thread+0x0/0x4a0 [sffs]<BR>[&lt;ffffffff8105525d&gt;] kthread+0x81/0x89<BR>[&lt;ffffffff810551dc&gt;] kthread+0x0/0x89<BR>[&lt;ffffffff814a1f7c&gt;] ret_from_fork+0x7c/0xb0<BR>[&lt;ffffffff810551dc&gt;] kthread+0x0/0x89</DIV>
<P>&#36825;&#37324;&#35774;&#35745;&#20102;&#19968;&#20010;watchdog&#32447;&#31243;&#65292;&#23450;&#26399;5&#31186;&#21890;&#29399;&#19968;&#27425;&#65292;&#21890;&#29399;&#26159;&#23558;last_time&#26356;&#26032;&#20026;&#24403;&#21069;cpu_clock&#65292;&#28982;&#21518;watchdog&#32447;&#31243;sleep&#65292;&#20294;&#26159;&#65292;sleep&#35843;&#29992;&#30340;&#26159;schedule_timeout_interruptible-&gt;schedule_timeout&#65292;&#36825;&#37324;&#20986;&#29616;&#19968;&#30452;sleep&#65292;&#26080;&#27861;&#37266;&#26469;&#30340;&#24773;&#20917;&#12290;<BR>schedule_timeout&#20351;&#29992;&#26222;&#36890;timer&#36229;&#26102;&#26469;&#23454;&#29616;&#21796;&#37266;&#12290;</P>
<DIV id=crayon-569898beee088924731153 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee088924731153-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee088924731153-2">2</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee088924731153-1 class=crayon-line><SPAN class=crayon-e>setup_timer_on_stack</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>process_timeout</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>unsigned</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>long</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-v>current</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee088924731153-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-e>__mod_timer</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>expire</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>false</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>TIMER_NOT_PINNED</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#21644;&#29616;&#35937;&#19968;&#20854;&#23454;&#26377;&#20849;&#21516;&#28857;&#65292;&#20063;&#26159;&#20351;&#29992;&#20102;&#26222;&#36890;timer&#65292;&#20294;&#26159;&#65292;&#20043;&#21069;&#19968;&#30452;&#26410;&#24576;&#30097;&#36825;&#37324;&#12290;</P>
<H3>&#29616;&#35937;&#19977;&#65292;&#34394;&#25311;&#26426;&#26410;&#26242;&#20572;&#21069;&#65292;GUEST&#26426;&#26080;PERIODIC&#20013;&#26029;&#27880;&#20837;</H3>
<P>RTC PERIODIC timer&#20351;&#29992;&#30340;hrtimer&#65292;&#35828;&#26126;hrtimer&#20986;&#38382;&#39064;&#20102;&#65311;&#25110;&#32773;periodic &#35745;&#31639;&#36923;&#36753;&#20986;&#38382;&#39064;&#20102;&#65292;&#24403;&#28982;&#65292;&#39318;&#20808;&#24576;&#30097;&#30340;&#36824;&#26159;periodic&#30340;&#20854;&#20182;&#36923;&#36753;&#20986;&#38382;&#39064;&#20102;&#65292;&#27604;&#22914;&#65292;cancel&#20102;timer&#23601;&#27809;&#26377;&#21152;&#20837;&#12290;</P>
<H3>&#29616;&#35937;&#22235;&#65292;&#20869;&#26680;&#25171;&#21360;&#38169;&#20301;&#20449;&#24687;</H3>
<P>&#22914;&#19979;&#26159;rcu_sched&#26816;&#26597;&#21040;&#30340; cpu 2 stall&#20449;&#24687;&#12290; </P>
<DIV class=monospaced>INFO: rcu_sched detected stalls on CPUs/tasks: { 2} (detected by 8, t=15002 jiffies, g=1178063, c=1178062, q=154896027)<BR>sending NMI to all CPUs:<BR>NMI backtrace for cpu 0<BR>CPU 0<BR>Pid: 0, comm: swapper/0 Tainted: G O 3.9.7+ #215 Dell Inc. PowerEdge R720/01XT2D<BR>RIP: 0010:[&lt;ffffffff812e8944&gt;] [&lt;ffffffff812e8944&gt;] intel_idle+0x98/0xbc<BR>RSP: 0018:ffffffff81801e58 EFLAGS: 00000046<BR>RAX: 0000000000000001 RBX: 0000000000000002 RCX: 0000000000000001<BR>RDX: 0000000000000000 RSI: ffffffff81908950 RDI: 0000000000000000<BR>RBP: 0000000000000002 R08: 0000000000000048 R09: 0000000000000000<BR>R10: 0000000000000001 R11: 000000000000b519 R12: 0000000000000001<BR>R13: 0000000000000001 R14: 0000000000000000 R15: 0000000085759000<BR>FS: 0000000000000000(0000) GS:ffff880fffa00000(0000) knlGS:0000000000000000<BR>CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033<BR>CR2: ffffffffff600400 CR3: 0000000d7478c000 CR4: 00000000001427e0<BR>DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000<BR>DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400<BR>Process swapper/0 (pid: 0, threadinfo ffffffff81800000, task ffffffff81822400)<BR>Stack:<BR>ffff880fffa1b470 0000000081073360 ffff880fffa1b470 ffff880fffa1b470<BR>ffffffff813b8348 000132a2dc9c0300 ffff88203ffca900 ffffffff813b89a7<BR>ffffffff00000002 ffffffff81908950 0000000000000000 ffffffff8149b29c<BR>Call Trace:<BR>[&lt;ffffffff813b8348&gt;] ? arch_local_irq_enable+0x8/0x8<BR>[&lt;ffffffff813b89a7&gt;] ? cpuidle_wrap_enter+0x2d/0x71<BR>[&lt;ffffffff8149b29c&gt;] ? __schedule+0x55c/0x5c5<BR>[&lt;ffffffff813b8702&gt;] ? cpuidle_enter_state+0xa/0x2f<BR>[&lt;ffffffff813b87cd&gt;] ? cpuidle_idle_call+0xa6/0xe1<BR>[&lt;ffffffff81014c9c&gt;] ? cpu_idle+0x97/0xd9<BR>[&lt;ffffffff81962d10&gt;] ? start_kernel+0x3a7/0x3b2<BR>[&lt;ffffffff8196277f&gt;] ? repair_env_string+0x57/0x57<BR>[&lt;ffffffff8196259a&gt;] ? x86_64_start_kernel+0xf2/0xfd<BR>Code: 48 8b 04 25 60 d6 00 00 48 89 d1 48 2d c8 1f 00 00 0f 01 c8 0f ae<BR>f0 e8 5f ff ff ff 85 c0 75 0b b9 01 00 00 00 4c 89 e0 0f 01 c9 &lt;85&gt;<BR>1d e6 02 62 00 75 0f 48 8d 74 24 0c bf 05 00 00 00 e8 dc f0 
<P></P>
<P>NMI backtrace for cpu 2<BR>CPU 2<BR>Pid: 0, comm: swapper/2 Tainted: G O 3.9.7+ #215 Dell Inc. PowerEdge R720/01XT2D<BR>RIP: 0010:[&lt;ffffffff812e8944&gt;] [&lt;ffffffff812e8944&gt;] intel_idle+0x98/0xbc<BR>RSP: 0018:ffff880ff9133e48 EFLAGS: 00000046<BR>RAX: 0000000000000020 RBX: 0000000000000008 RCX: 0000000000000001<BR>RDX: 0000000000000000 RSI: ffffffff81908950 RDI: 000000000581b000<BR>RBP: 0000000000000004 R08: 0000000000000000 R09: 0000000000000000<BR>R10: 0000000000000000 R11: 0000000000000200 R12: 0000000000000020<BR>R13: 0000000000000003 R14: 0000000000000000 R15: 0000000000000000<BR>FS: 0000000000000000(0000) GS:ffff880fffa20000(0000) knlGS:0000000000000000<BR>CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033<BR>CR2: ffffffffff600400 CR3: 000000000581b000 CR4: 00000000001427e0<BR>DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000<BR>DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400<BR>Process swapper/2 (pid: 0, threadinfo ffff880ff9132000, task ffff880ff911f000)<BR>Stack:<BR>ffff880fffa3b470 0000000281073360 ffff880fffa3b470 ffff880fffa3b470<BR>ffffffff813b8348 000132a2d88c8451 0000000000000000 ffffffff813b89a7<BR>ffff880f00000004 ffffffff81908950 0000000000000000 ffffffff8149b29c<BR>Call Trace:<BR>[&lt;ffffffff813b8348&gt;] ? arch_local_irq_enable+0x8/0x8<BR>[&lt;ffffffff813b89a7&gt;] ? cpuidle_wrap_enter+0x2d/0x71<BR>[&lt;ffffffff8149b29c&gt;] ? __schedule+0x55c/0x5c5<BR>[&lt;ffffffff813b94b4&gt;] ? ladder_enable_device+0x7c/0x7c<BR>[&lt;ffffffff813b8702&gt;] ? cpuidle_enter_state+0xa/0x2f<BR>[&lt;ffffffff813b87cd&gt;] ? cpuidle_idle_call+0xa6/0xe1<BR>[&lt;ffffffff81014c9c&gt;] ? cpu_idle+0x97/0xd9<BR>[&lt;ffffffff8149bcd4&gt;] ? _raw_spin_unlock_irqrestore+0xc/0xd<BR>[&lt;ffffffff8148bbc7&gt;] ? start_secondary+0x1e0/0x1e6<BR>Code: 48 8b 04 25 60 d6 00 00 48 89 d1 48 2d c8 1f 00 00 0f 01 c8 0f ae f0 e8 5f ff ff ff 85 c0 75 0b b9 01 00 00 00 4c 89 e0 0f 01 c9 &lt;85&gt; 1d e6 02 62 00 75 0f 48 8d 74 24 0c bf 05 00 00 00 e8 dc f0 </P></DIV>
<P>&#36825;&#20010;&#20449;&#24687;&#35828;&#26126;&#65292;RCU&#21345;&#27515;&#65292;&#21644;&#29616;&#35937;&#19968;&#31867;&#20284;&#12290;</P>
<H3>&#29616;&#35937;&#20116;&#65292;interrupt&#24322;&#24120;</H3>
<P>sleep 1&#31186;&#38047;&#65292;cpu 2 &#20013;&#26029;&#25968;&#20174;46385994&#21464;&#20026;46386026&#65292;&#22686;&#21152;32&#65292;&#27491;&#24120;&#24773;&#20917;&#19979;&#65292;&#24212;&#35813;&#22686;&#21152;&gt;=250&#27425;&#65292;250HZ&#65292;&#20363;&#22914;CPU 1&#22686;&#21152;476</P>
<DIV id=crayon-569898beee098745753812 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee098745753812-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee098745753812-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee098745753812-3">3</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee098745753812-1 class=crayon-line><SPAN class=crayon-c># cat /proc/interrupts | grep LOC; sleep 1; cat /proc/interrupts | grep LOC</SPAN></DIV>
<DIV id=crayon-569898beee098745753812-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>LOC</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>105675254</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>84142623</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>46385994</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>80045460</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>98371367</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>82173239</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>99639057</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>76492493</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>98567757</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>77003318</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>95298227</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>82916017</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>103306182</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>84486289</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>91237852</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>75417787</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>72666689</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>64318123</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66099604</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>62682279</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69886431</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>67316583</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69979387</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>63462345</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>65841507</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66451593</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69610589</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66408513</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>65942276</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66575394</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>71065818</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>63105578</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-e>Local </SPAN><SPAN class=crayon-e>timer </SPAN><SPAN class=crayon-e>interrupts</SPAN></DIV>
<DIV id=crayon-569898beee098745753812-3 class=crayon-line><SPAN class=crayon-e>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>LOC</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>105675505</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>84143099</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>46386026</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>80045895</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>98371640</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>82173569</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>99639348</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>76492833</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>98568070</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>77003842</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>95298482</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>82916652</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>103306509</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>84486717</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>91238142</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>75418099</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>72666958</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>64318374</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66099855</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>62682530</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69886700</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>67316852</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69979657</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>63462606</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>65841758</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66451863</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>69610858</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66408782</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>65942527</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>66575663</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>71066106</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>63105830</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-e>Local </SPAN><SPAN class=crayon-e>timer </SPAN><SPAN class=crayon-v>interrupts</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>Machine check polls&#21487;&#20197;&#26126;&#26174;&#30475;&#20986;&#65292;CPU 2&#19978;&#36825;&#20010;&#32047;&#31215;&#27425;&#25968;&#27604;&#20854;&#20182;&#30340;&#37117;&#23569;</P>
<DIV id=crayon-569898beee0a0399360492 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0a0399360492-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a0399360492-2">2</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0a0399360492-1 class=crayon-line><SPAN class=crayon-c># cat /proc/interrupts | grep MCP</SPAN></DIV>
<DIV id=crayon-569898beee0a0399360492-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>MCP</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>89</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>776</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-e>Machine </SPAN><SPAN class=crayon-e>check </SPAN><SPAN class=crayon-v>polls</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<H3>&#29616;&#35937;&#20845;&#65292;perf&#26597;&#30475;2&#21495;CPU&#32479;&#35745;&#65292;&#19981;&#26356;&#26032;&#29366;&#24577;&#65292;&#26174;&#31034;&#25968;&#25454;&#20063;&#19981;&#27491;&#30830;</H3>
<P></P>
<DIV id=crayon-569898beee0a6816631217 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-17">17</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-18">18</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-19">19</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0a6816631217-20">20</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0a6816631217-21">21</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0a6816631217-1 class=crayon-line><SPAN class=crayon-c># perf top -C 2</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>PerfTop</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>irqs</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-e>sec&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>nan</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>exact</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>nan</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>4000Hz</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>cycles</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>all</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>CPU</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>2</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-3 class=crayon-line><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN><SPAN class=crayon-o>--</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-4 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0a6816631217-5 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>12.80</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>update_sd_lb</SPAN><SPAN class=crayon-sy>_</SPAN>stats<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>6.10</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>do_raw_spin</SPAN><SPAN class=crayon-sy>_</SPAN>lock<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-7 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>3.67</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rb</SPAN><SPAN class=crayon-sy>_</SPAN>erase<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>3.22</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>native_write_msr</SPAN><SPAN class=crayon-sy>_</SPAN>safe<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-9 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.97</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>find_next</SPAN><SPAN class=crayon-sy>_</SPAN>bit<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.83</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>_</SPAN><SPAN class=crayon-sy>_</SPAN>schedule<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-11 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.67</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>libc</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>2.13.so</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0x0000000000079bc2</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.43</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>__switch</SPAN><SPAN class=crayon-sy>_</SPAN>to<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-13 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.31</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>cpumask_next</SPAN><SPAN class=crayon-sy>_</SPAN>and<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>2.02</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rcu_eqs_exit_common</SPAN><SPAN class=crayon-e>.isra</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-cn>43</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-15 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.74</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>pick_next_task</SPAN><SPAN class=crayon-sy>_</SPAN>fair<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-16 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.67</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>tracing_record</SPAN><SPAN class=crayon-sy>_</SPAN>cmdline<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-17 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.67</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>apic_timer</SPAN><SPAN class=crayon-sy>_</SPAN>interrupt<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-18 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.64</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kvm</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_set</SPAN><SPAN class=crayon-sy>_</SPAN>irq<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-19 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.48</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>cpuidle_idle</SPAN><SPAN class=crayon-sy>_</SPAN>call<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-20 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.47</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>idle</SPAN><SPAN class=crayon-sy>_</SPAN>cpu<SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></DIV>
<DIV id=crayon-569898beee0a6816631217-21 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>1.44</SPAN><SPAN class=crayon-o>%</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kernel</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>k</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>update</SPAN><SPAN class=crayon-sy>_</SPAN>curr<SPAN class=crayon-h>&nbsp;&nbsp; </SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<H3>&#29616;&#35937;&#19971;&#65292;&#20174;DMESG&#30475;&#65292;&#26377;&#37096;&#20998;&#26085;&#24535;&#20026;CANCEL TIMER</H3>
<P>&#36825;&#35753;&#20154;&#24576;&#30097;&#26159;CANCEL TIMER&#30340;&#26102;&#20505;&#26377;&#38382;&#39064;&#12290; </P>
<DIV class=monospaced>12:53:53.092377 rtc.c:1090 | start cancel update_ended_timer, pid(6466)<BR>12:53:53.092380 rtc.c:1092 | start cancel periodic_timer, pid(6466)<BR>12:53:53.092381 rtc.c:1096 | start cancel coalesced_timer, pid(6466)<BR>12:53:53.092382 rtc.c:1100 | cancel timers ok, pid(6466)<BR>12:53:53.092383 rtc.c:1221 | start cancel ws_coalesced, 6466<BR>12:53:53.092384 rtc.c:1224 | start cancel ws_periodic, 6466<BR>12:53:53.092385 rtc.c:1226 | start cancel ws_update_ended, 6466<BR>12:53:53.092386 rtc.c:1231 | destory wq ok, 6466</DIV>
<P>&#36816;&#34892;&#20013;&#30340;VM&#65292;&#26102;&#38047;&#29366;&#24577;&#27491;&#24120;&#65292;&#20294;&#26159;&#65292;&#35774;&#32622;&#30340;&#36229;&#26102;&#26102;&#38388;&#19981;&#27491;&#30830;&#12290;</P>
<DIV id=crayon-569898beee0b2962531716 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0b2962531716-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0b2962531716-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0b2962531716-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0b2962531716-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0b2962531716-5">5</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0b2962531716-1 class=crayon-line><SPAN class=crayon-c># ps auxf | grep 16685</SPAN></DIV>
<DIV id=crayon-569898beee0b2962531716-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-i>root</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>16771</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>2.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>S</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>Mar29</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>59</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>56</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>_</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>vhost</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>16685</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee0b2962531716-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-i>root</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>16987</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>S</SPAN><SPAN class=crayon-o>&lt;</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-i>Mar29</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>_</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kvm</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-cn>16685</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee0b2962531716-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-i>root</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>16988</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.0</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>S</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>Mar29</SPAN><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>00</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-i>_</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-v>kvm</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>pit</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-cn>16685</SPAN><SPAN class=crayon-sy>]</SPAN></DIV>
<DIV id=crayon-569898beee0b2962531716-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-i>root</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN class=crayon-cn>16685</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>25.1</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-cn>0.7</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-e>Sl&nbsp;&nbsp; </SPAN><SPAN class=crayon-i>Mar29</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>736</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>22</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>usr</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>bin</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>kvm</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-r>id</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>6040519910916</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<DIV class=monospaced>qm&gt; rtc timer-status<BR>now(0x93cc884c037c) periodic_timer_next(0x61bbe2bd11d9) update_ended_timer_next(0x724d70fd8e7c) coalesced_timer_next(0x61baa25d722d)<BR>periodic_timer_status(1) coalesced_timer_status(0) update_ended_timer_status(0)<BR>irq_coalesced(0), irq_source_id(2), period(32)</DIV>
<P>&#24403;&#21069;&#26102;&#38388;&#20026;0x93cc884c037c&#65292;&#20294;periodic&#36229;&#26102;&#26102;&#38388;&#20026;0x61bbe2bd11d9&#65292;periodic_timer_status&#26159;enqueue&#29366;&#24577;&#65292;&#36825;&#35753;&#20154;&#24576;&#30097;&#26159;&#21542;&#26102;&#38388;&#35745;&#31639;&#20986;&#38169;&#65292;&#32467;&#21512;&#29616;&#35937;&#19971;&#65292;&#24576;&#30097;&#26159;&#21542;&#30001;&#20110;cancel timer&#21644;cancel workqueue&#20132;&#21449;&#21518;&#65292;&#23548;&#33268;&#20026;&#37322;&#25918;&#21518;&#35775;&#38382;&#38750;&#27861;&#20869;&#23384;&#12290;</P>
<H3>&#29616;&#35937;&#20843;&#65292;&#20986;&#38382;&#39064;&#30340;CPU&#65292;&#27809;&#26377;tick_sched_timer</H3>
<P>&#20351;&#29992;sysrq&#30475;&#65292;&#20986;&#38382;&#39064;&#30340;CPU&#19978;&#32570;&#23569;tick_sched_timer&#12290;</P>
<DIV id=crayon-569898beee0ba931039423 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0ba931039423-1">1</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0ba931039423-1 class=crayon-line><SPAN class=crayon-v>dmesg</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>c</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>echo</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>q</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&gt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>proc</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-v>sysrq</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>trigger</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>dmesg</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>c</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&gt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>htimer</SPAN><SPAN class=crayon-e>.txt</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<DIV class=monospaced>cpu: 2<BR>clock 0:<BR>.base: ffff880fffa2f130<BR>.index: 0<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get<BR>.offset: 0 nsecs<BR>active timers:<BR>#0: <FFFF881FE76FBDF8>, hrtimer_wakeup, S:01, hrtimer_start_expires, redis-server/6270<BR># expires at 337330247640210-337330247740209 nsecs [in 41824157 to 41924156 nsecs]<BR>#1: <FFFF880FB9B5FAA8>, hrtimer_wakeup, S:01, hrtimer_start_expires, rrdcached/9762<BR># expires at 337330670917136-337330671417135 nsecs [in 465101083 to 465601082 nsecs]<BR>#2: <FFFF881FCE68C048>, posix_timer_fn, S:01, hrtimer_start_expires, ntpd/8491<BR># expires at 337330975817716-337330975817716 nsecs [in 770001663 to 770001663 nsecs]<BR>#3: <FFFF880FD8D3FEC8>, hrtimer_wakeup, S:01, hrtimer_start_expires, vtp-vmstatusd/7696<BR># expires at 337331182948034-337331182998034 nsecs [in 977131981 to 977181981 nsecs]<BR>#4: <FFFF880FFFA2F4B0>, watchdog_timer_fn, S:01, watchdog_enable, watchdog/2/17<BR># expires at 337332620000000-337332620000000 nsecs [in 2414183947 to 2414183947 nsecs]<BR>#5: <FFFF880FE7E2D998>, hrtimer_wakeup, S:01, hrtimer_start_expires, vtp-vmstatusd/9260<BR># expires at 337333041794394-337333044794392 nsecs [in 2835978341 to 2838978339 nsecs]<BR>#6: <FFFF880FD85CBEC8>, hrtimer_wakeup, S:01, hrtimer_start_expires, cron/7060<BR># expires at 337384983827524-337384983877524 nsecs [in 54778011471 to 54778061471 nsecs]<BR>clock 1:<BR>.base: ffff880fffa2f170<BR>.index: 1<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get_real<BR>.offset: 1396084256871204400 nsecs<BR>active timers:<BR>#0: <FFFF880FE8AD5D78>, hrtimer_wakeup, S:01, futex_wait_queue_me, cmdproxy-server/4854<BR># expires at 1396421587528161067-1396421587528211067 nsecs [in 1396084257322345014 to 1396084257322395014 nsecs]<BR>clock 2:<BR>.base: ffff880fffa2f1b0<BR>.index: 2<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get_boottime<BR>.offset: 0 nsecs<BR>active timers:<BR>.expires_next : 337330247740209 nsecs<BR>.hres_active : 1<BR>.nr_events : 59060693<BR>.nr_retries : 134616<BR>.nr_hangs : 0<BR>.max_hang_time : 0 nsecs<BR>.nohz_mode : 0<BR>.last_tick : 0 nsecs<BR>.tick_stopped : 0<BR>.idle_jiffies : 0<BR>.idle_calls : 0<BR>.idle_sleeps : 0<BR>.idle_entrytime : 0 nsecs<BR>.idle_waketime : 0 nsecs<BR>.idle_exittime : 0 nsecs<BR>.idle_sleeptime : 0 nsecs<BR>.iowait_sleeptime: 0 nsecs<BR>.last_jiffies : 0<BR>.next_jiffies : 0<BR>.idle_expires : 0 nsecs<BR>jiffies: 4379224847</FFFF880FE8AD5D78></FFFF880FD85CBEC8></FFFF880FE7E2D998></FFFF880FFFA2F4B0></FFFF880FD8D3FEC8></FFFF881FCE68C048></FFFF880FB9B5FAA8></FFFF881FE76FBDF8></DIV>
<P>&#27491;&#24120;CPU&#65292;&#26377;tick_sched_timer</P>
<DIV class=monospaced>SysRq : Show clockevent devices &amp; pending hrtimers (no others)<BR>Timer List Version: v0.7<BR>HRTIMER_MAX_CLOCK_BASES: 3<BR>now at 337330205816053 nsecs
<P></P>
<P>cpu: 0<BR>clock 0:<BR>.base: ffff880fffa0f130<BR>.index: 0<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get<BR>.offset: 0 nsecs<BR>active timers:<BR>#0: <FFFF880FFFA0F340>, tick_sched_timer, S:01, tick_setup_sched_timer, swapper/0/0<BR># expires at 337330208000000-337330208000000 nsecs [in 2183947 to 2183947 nsecs]<BR>#1: <FFFF880CD3512300>, posix_timer_fn, S:01, hrtimer_start_expires, kvm/16129<BR># expires at 337330229119903-337330229119903 nsecs [in 23303850 to 23303850 nsecs]<BR>#2: <FFFF880FFFA0F4B0>, watchdog_timer_fn, S:01, watchdog_enable, watchdog/0/11<BR># expires at 337332620000000-337332620000000 nsecs [in 2414183947 to 2414183947 nsecs]<BR>#3: <FFFF880FD1CFDEC8>, hrtimer_wakeup, S:01, hrtimer_start_expires, vtp-datareport-/7483<BR># expires at 337332761244090-337332761294090 nsecs [in 2555428037 to 2555478037 nsecs]<BR>#4: <FFFF880FD92AF998>, hrtimer_wakeup, S:01, hrtimer_start_expires, rsyslogd/4954<BR># expires at 421445209329678-421445309329678 nsecs [in 84115003513625 to 84115103513625 nsecs]<BR>clock 1:<BR>.base: ffff880fffa0f170<BR>.index: 1<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get_real<BR>.offset: 1396084256871204400 nsecs<BR>active timers:<BR>clock 2:<BR>.base: ffff880fffa0f1b0<BR>.index: 2<BR>.resolution: 1 nsecs<BR>.get_time: ktime_get_boottime<BR>.offset: 0 nsecs<BR>active timers:<BR>.expires_next : 337330208000000 nsecs<BR>.hres_active : 1<BR>.nr_events : 141257434<BR>.nr_retries : 188513<BR>.nr_hangs : 0<BR>.max_hang_time : 0 nsecs<BR>.nohz_mode : 0<BR>.last_tick : 0 nsecs<BR>.tick_stopped : 0<BR>.idle_jiffies : 0<BR>.idle_calls : 0<BR>.idle_sleeps : 0<BR>.idle_entrytime : 0 nsecs<BR>.idle_waketime : 0 nsecs<BR>.idle_exittime : 0 nsecs<BR>.idle_sleeptime : 0 nsecs<BR>.iowait_sleeptime: 0 nsecs<BR>.last_jiffies : 0<BR>.next_jiffies : 0<BR>.idle_expires : 0 nsecs<BR>jiffies: 4379224847</FFFF880FD92AF998></FFFF880FD1CFDEC8></FFFF880FFFA0F4B0></FFFF880CD3512300></FFFF880FFFA0F340></P></DIV>
<P>&#20174;&#36825;&#20010;&#29616;&#35937;&#21487;&#29702;&#35299;&#20043;&#21069;&#30340;&#19968;&#20999;&#29616;&#35937;&#65292;&#22240;&#20026;tick_sched_timer&#26159;&#22312;&#39640;&#31934;&#24230;&#26102;&#38047;&#19979;&#27169;&#25311;&#20302;&#31934;&#24230;&#26102;&#38047;&#21151;&#33021;&#30340;&#12290;&#21253;&#25324;update_wall_time-&gt;timekeeping_update update_process_times-&gt;run_local_timers/rcu_check_callbacks-&gt;__run_timers<BR>&#39640;&#31934;&#24230;&#27169;&#24335;&#19979;&#65292;&#25152;&#26377;&#34987;&#27169;&#25311;&#30340;&#26222;&#36890;&#26102;&#38047;&#30340;&#20195;&#30721;&#37117;&#19981;&#36208;&#20102;&#12290;</P>
<H2>&#39564;&#35777;</H2>
<P>&#36890;&#36807;&#29616;&#35937;&#35266;&#23519;&#65292;&#38656;&#35201;&#39564;&#35777;&#22914;&#19979;&#20004;&#20010;&#21487;&#33021;&#65306;<BR>1. &#25105;&#20204;&#30340;&#20195;&#30721;&#36393;&#20869;&#23384;&#65292;&#23548;&#33268;hrtimer&#25968;&#25454;&#32467;&#26500;&#34987;&#30772;&#22351;&#12290;<BR>2. tick_sched_timer&#19981;&#23384;&#22312;&#23548;&#33268;&#65292;BUT&#20026;&#20309;&#19981;&#23384;&#22312;&#23578;&#19981;&#28165;&#26970;&#12290;</P>
<H3>&#39564;&#35777;&#19968;&#65292;&#20195;&#30721;&#36393;&#20869;&#23384;</H3>
<P></P>
<DIV id=crayon-569898beee0c9071075409 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0c9071075409-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0c9071075409-17">17</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0c9071075409-1 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ws_periodic_handler</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>work_struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>ws</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_rtc</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>container_of</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ws</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_rtc</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ws_periodic</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ret_forward</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_forward</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>next_time</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ret_restart</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_restart</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-7 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0c9071075409-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>enum</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_restart </SPAN><SPAN class=crayon-e>periodic_timer_fn</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-9 class=crayon-line><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_rtc</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>container_of</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_rtc</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>periodic_timer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-11 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>queue_work</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>wq</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>ws_periodic</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>HRTIMER_NORESTART</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-13 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-14 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0c9071075409-15 class=crayon-line><SPAN class=crayon-e>hrtimer_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>periodic_timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>CLOCK_MONOTONIC</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>HRTIMER_MODE_ABS</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-16 class="crayon-line crayon-striped-line"><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>periodic_timer</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-t>function</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>periodic_timer_fn</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0c9071075409-17 class=crayon-line><SPAN class=crayon-e>INIT_WORK</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>ws_periodic</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ws_periodic_handler</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#19978;&#36848;&#20195;&#30721;&#65292;&#22312;hrtimer&#22238;&#35843;periodic_timer_fn&#37324;&#20250;queue_work&#65292;&#22312;workqueue&#30340;&#22238;&#35843;ws_periodic_handler&#37324;&#20250;hrtimer_restart htimer&#65292;&#24418;&#25104;&#20102;&#20132;&#21449;&#21551;&#21160;&#12290;<BR>&#32780;cancel&#20195;&#30721;&#22914;&#19979;&#65306;</P>
<DIV id=crayon-569898beee0d1139035098 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0d1139035098-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0d1139035098-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0d1139035098-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0d1139035098-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0d1139035098-5">5</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0d1139035098-1 class=crayon-line><SPAN class=crayon-e>hrtimer_cancel</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>periodic_timer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0d1139035098-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-e>cancel_work_sync</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>ws_periodic</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0d1139035098-3 class=crayon-line><SPAN class=crayon-e>flush_workqueue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>wq</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0d1139035098-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-e>destroy_workqueue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>wq</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0d1139035098-5 class=crayon-line><SPAN class=crayon-e>free</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>rtc</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#36825;&#26679;&#65292;&#35843;&#29992;cancel_work_sync&#30340;&#26102;&#20505;&#65292;&#22914;&#26524;work queue&#37324;&#38754;&#36824;&#26377;handler&#26410;&#35843;&#29992;&#65292;&#20250;&#35843;&#29992;&#65292;&#21363;&#65292;&#22312;cancel_work_sync&#30340;&#26102;&#20505;&#65292;&#21448;&#35843;&#29992;&#20102;ws_periodic_handler&#65292;&#36825;&#26679;periodic_timer&#20250;&#20877;&#27425;&#21551;&#21160;&#65292;&#37027;&#20040;&#65292;hrtimer&#24182;&#27809;&#26377;&#20572;&#27490;&#12290;&#25509;&#19979;&#26469;free(rtc)&#30340;&#26102;&#20505;&#65292;&#22312;periodic_timer&#30340;&#22788;&#29702;&#36923;&#36753;&#65292;&#20250;&#35843;&#29992;&#37326;&#25351;&#38024;&#12290;</P>
<P>&#36890;&#36807;&#21152;&#22823;&#26465;&#20214;&#65292;&#39564;&#35777;&#65292;&#20854;&#32467;&#26524;&#26159;&#65292;&#22914;&#26524;&#30495;&#26159;&#27492;&#31181;&#24773;&#20917;&#65292;&#31995;&#32479;&#20250;&#31435;&#21363;CRASH&#65292;&#21644;&#29616;&#35937;&#19981;&#19968;&#26679;&#12290;</P>
<H3>&#39564;&#35777;&#20108;&#65292;tick_sched_timer&#19981;&#23384;&#22312;&#23548;&#33268;</H3>
<P>&#26082;&#28982;CPU 2&#19978;tick_sched_timer&#19981;&#23384;&#22312;&#65292;&#37027;&#20040;&#21033;&#29992;hrtimer&#30340;&#28909;&#36801;&#31227;&#21407;&#29702;&#65292;&#21487;&#20197;&#23558;CPU 2&#31105;&#27490;&#25481;&#65292;&#20854;&#19978;&#30340;hrtimer&#20250;&#33258;&#21160;&#36801;&#31227;&#65292;&#22914;&#26524;&#36801;&#31227;&#21518;&#27491;&#24120;&#65292;&#21487;&#20197;&#20877;&#27425;&#35777;&#26126;&#65292;&#21407;&#22240;&#23601;&#26159;tick_sched_timer&#19981;&#23384;&#22312;&#23548;&#33268;&#12290;</P>
<P>Q: How to test if hotplug is supported on the newly built kernel?<BR>A: You should now notice an entry in sysfs.</P>
<P>Check if sysfs is mounted, using the "mount" command. You should notice<BR>an entry as shown below in the output.<BR>....<BR>none on /sys type sysfs (rw)<BR>....<BR>If this is not mounted, do the following.<BR>#mkdir /sysfs<BR>#mount -t sysfs sys /sys<BR>Now you should see entries for all present cpu, the following is an example<BR>in a 8-way system.<BR>#pwd<BR>#/sys/devices/system/cpu<BR>#ls -l<BR>drwxr-xr-x 3 root root 0 Sep 19 07:44 cpu0<BR>drwxr-xr-x 3 root root 0 Sep 19 07:44 cpu1<BR>drwxr-xr-x 3 root root 0 Sep 19 07:44 cpu2</P>
<P>Under each directory you would find an "online" file which is the control<BR>file to logically online/offline a processor.</P>
<P>Q: Does hot-add/hot-remove refer to physical add/remove of cpus?<BR>A: The usage of hot-add/remove may not be very consistently used in the code.<BR>CONFIG_HOTPLUG_CPU enables logical online/offline capability in the kernel.<BR>To support physical addition/removal, one would need some BIOS hooks and<BR>the platform should have something like an attention button in PCI hotplug.<BR>CONFIG_ACPI_HOTPLUG_CPU enables ACPI support for physical add/remove of CPUs.</P>
<P>Q: How do i logically offline a CPU?<BR>A: Do the following.<BR>#echo 0 &gt; /sys/devices/system/cpu/cpuX/online<BR>Once the logical offline is successful, check<BR>#cat /proc/interrupts<BR>You should now not see the CPU that you removed. Also online file will report<BR>the state as 0 when a cpu if offline and 1 when its online.<BR>#To display the current cpu state.<BR>#cat /sys/devices/system/cpu/cpuX/online</P>
<P>&#20572;&#27490;&#25481;CPU 2&#65292;&#31995;&#32479;&#24674;&#22797;&#27491;&#24120;&#65292;&#39564;&#35777;&#20102;&#38382;&#39064;&#20986;&#22312;tick_sched_timer&#19978;&#12290;</P>
<H2>&#26368;&#32456;&#21407;&#22240;</H2>
<P>&#26368;&#32456;&#26597;&#20986;&#21407;&#22240;&#65292;hrtimer&#21152;&#20837;rbtree&#20043;&#21518;&#65292;rtc&#30340;port read write&#22238;&#35843;&#36824;&#20250;&#20462;&#25913;&#36229;&#26102;&#26102;&#38388;&#65306;</P>
<DIV id=crayon-569898beee0dc874025313 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0dc874025313-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0dc874025313-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0dc874025313-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0dc874025313-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0dc874025313-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0dc874025313-6">6</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0dc874025313-1 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>rtc_ioport_read</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>kvm_io_device</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-r>this</SPAN><SPAN class=crayon-sy>,</SPAN></DIV>
<DIV id=crayon-569898beee0dc874025313-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp; </SPAN><SPAN class=crayon-e>gpa_t </SPAN><SPAN class=crayon-v>addr</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>len</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>data</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0dc874025313-3 class=crayon-line><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0dc874025313-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ret_forward</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_forward</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>next_time</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0dc874025313-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ret_restart</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_restart</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898beee0dc874025313-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#26681;&#25454;hrtimer&#23454;&#29616;&#21407;&#29702;&#65292;&#21487;&#20197;&#30475;&#20986;&#65292;&#21152;&#20837;rbtree&#20043;&#21518;&#65292;&#19981;&#24212;&#35813;&#20462;&#25913;expires&#12290;&#27492;expires&#29992;&#20110;&#32418;&#40657;&#26641;&#35843;&#25972;&#26102;&#30340;&#22823;&#23567;&#27604;&#36739;&#12290;</P>
<DIV id=crayon-569898beee0e5590263297 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-17">17</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-18">18</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-19">19</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-20">20</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-21">21</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-22">22</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-23">23</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-24">24</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-25">25</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-26">26</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-27">27</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-28">28</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-29">29</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-30">30</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-31">31</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-32">32</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-33">33</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-34">34</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-35">35</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-36">36</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-37">37</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-38">38</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-39">39</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-40">40</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-41">41</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-42">42</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-43">43</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-44">44</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-45">45</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-46">46</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-47">47</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-48">48</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-49">49</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-50">50</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-51">51</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-52">52</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-53">53</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-54">54</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0e5590263297-55">55</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0e5590263297-56">56</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0e5590263297-1 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>__run_hrtimer</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ktime_t</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>now</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>raw_spin_unlock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>cpu_base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>trace_hrtimer_expire_entry</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>now</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>restart</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fn</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-7 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>trace_hrtimer_expire_exit</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>raw_spin_lock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>cpu_base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-9 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>restart</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>!=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>HRTIMER_NORESTART</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-11 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>BUG_ON</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>state</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>!=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>HRTIMER_STATE_CALLBACK</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>enqueue_hrtimer</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-13 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-15 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-16 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-17 class=crayon-line><SPAN class=crayon-m>static</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>enqueue_hrtimer</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer_clock_base</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-18 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-19 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>debug_activate</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-20 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-21 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>timerqueue_add</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>active</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-22 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>cpu_base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>active_bases</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&lt;&lt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>index</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-c>//&#24403;clock base&#37324;&#26377;timer&#30340;&#26102;&#20505;&#65292;clock&#20026;&#28608;&#27963;&#29366;&#24577;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-23 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-24 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/*</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-25 class=crayon-line><SPAN class=crayon-c>* HRTIMER_STATE_ENQUEUED is or'ed to the current state to preserve the</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-26 class="crayon-line crayon-striped-line"><SPAN class=crayon-c>* state of a possibly running callback.</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-27 class=crayon-line><SPAN class=crayon-c>*/</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-28 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>state</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>HRTIMER_STATE_ENQUEUED</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-29 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-30 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>==</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>active</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>next</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-31 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-32 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-33 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>timerqueue_add</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>timerqueue_head</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>timerqueue_node</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-34 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-35 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rb_node</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>rb_node</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-36 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>rb_node</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-37 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>timerqueue_node</SPAN><SPAN class=crayon-h>&nbsp;&nbsp;</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>ptr</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-38 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-39 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* Make sure we don't add nodes that are already added */</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-40 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>WARN_ON_ONCE</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-e>RB_EMPTY_NODE</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-41 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-42 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>while</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-43 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-44 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ptr</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>rb_entry</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>timerqueue_node</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-45 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>expires</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv64</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&lt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ptr</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>expires</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv64</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-c>//&#36825;&#37324;&#65292;&#20250;&#27604;&#36739;expires.tv64&#65292;&#21363;htimer.node.expires</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-46 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>//&#26681;&#25454;expires&#20915;&#23450;&#26159;&#25554;&#20837;left&#36824;&#26159;Right&#65292;&#22914;&#26524;periodic&#30340;expires&#22312;&#21152;&#20837;&#38431;&#21015;&#21518;&#34987;&#20462;&#25913;&#65292;&#37027;&#20040;&#65292;&#36825;&#20010;&#20540;&#23601;&#20250;&#23548;&#33268;rb tree&#32010;&#20081;&#12290;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-47 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>rb_left</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-48 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>else</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-49 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>rb_right</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-50 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-51 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rb_link_node</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>p</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-52 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>rb_insert_color</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-53 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0e5590263297-54 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>!</SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>next</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>||</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>expires</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv64</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&lt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>next</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>expires</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv64</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-55 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>head</SPAN><SPAN class=crayon-o>-&gt;</SPAN><SPAN class=crayon-v>next</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>node</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0e5590263297-56 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#25171;&#21360;&#30830;&#35748;ptimer-&gt;state&#65292;&#21487;&#20197;&#30475;&#20986;&#65292;&#22312;&#20462;&#25913;expires&#20043;&#21069;&#65292;&#30830;&#23454;&#26377;HRTIMER_STATE_ENQUEUED&#29366;&#24577;&#12290;</P>
<H2>&#20462;&#25913;&#26041;&#27861;</H2>
<P>&#22312;hrtimer&#37324;&#38754;&#23548;&#20986;&#20989;&#25968;&#65292;&#29992;&#20110;&#23558;hrtimer&#31227;&#38500;&#65306;</P>
<DIV id=crayon-569898beee0ee858518131 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0ee858518131-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0ee858518131-14">14</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0ee858518131-1 class=crayon-line><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>remove_hrtimer2</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-3 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>hrtimer_clock_base</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>unsigned</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>long</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>flags</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-5 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ret</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-6 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898beee0ee858518131-7 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>lock_hrtimer_base</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>flags</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-c>/* Remove an active timer from the queue: */</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-9 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>ret</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>remove_hrtimer</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>base</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>unlock_hrtimer_base</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>timer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>flags</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-11 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ret</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898beee0ee858518131-13 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898beee0ee858518131-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-e>EXPORT_SYMBOL_GPL</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>remove_hrtimer2</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#20808;&#31227;&#38500;&#65292;&#20877;&#20462;&#25913;&#26102;&#38388;&#65292;&#20877;&#21152;&#20837;&#65306;</P>
<DIV id=crayon-569898beee0f5246626198 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898beee0f5246626198-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898beee0f5246626198-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898beee0f5246626198-3">3</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898beee0f5246626198-1 class=crayon-line><SPAN class=crayon-v>ret_forward</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>remove_hrtimer2</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0f5246626198-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-v>ret_forward</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_forward</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ns_to_ktime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>next_time</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-v>now_time</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898beee0f5246626198-3 class=crayon-line><SPAN class=crayon-v>ret_restart</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>hrtimer_restart</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>ptimer</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#19968;&#21477;&#35805;&#65306;&#22914;&#26524;&#35201;&#35843;&#29992;HRTIMER&#30340; expire&#20462;&#25913;&#20989;&#25968;&#65292;&#24517;&#39035;&#20808;remove&#20986;rbtree&#20877;&#35843;&#29992;&#12290;</P>
<H2>&#21442;&#32771;&#36164;&#26009;</H2>
<OL class=decimal>
<LI>SMP IRQ Affinity<BR><A href="https://cs.uwaterloo.ca/~brecht/servers/apic/SMP-affinity.txt" target=_blank>https://cs.uwaterloo.ca/~brecht/servers/apic/SMP-affinity.txt</A> </LI>
<LI>CPU-hotplug<BR><A href="http://lxr.free-electrons.com/source/Documentation/cpu-hotplug.txt" target=_blank>http://lxr.free-electrons.com/source/Documentation/cpu-hotplug.txt</A> </LI></OL>
<P><A href="http://mnstory.net/wp-content/uploads/2014/05/hrtimer-trap/hrtimer-trap.pdf" target=_bank>PDF&#19979;&#36733;</A></P></DIV>