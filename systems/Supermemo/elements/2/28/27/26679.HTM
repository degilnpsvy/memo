<HEADER class=entry-header>&nbsp;
<H1 class=entry-title>&#22810;&#32447;&#31243;&#22871;fork&#65292;&#19977;&#24605;&#32780;&#21518;&#34892;</H1>
<DIV class=entry-meta><SPAN class=sep>&#21457;&#34920;&#20110; </SPAN><A title="&#19978;&#21320; 12:56" href="http://mnstory.net/2013/10/think-twice-before-mixing-threads-fork/" rel=bookmark><TIME class=entry-date datetime="2013-10-16T00:56:04+00:00">2013 &#24180; 10 &#26376; 16 &#26085;</TIME></A> </DIV></HEADER>
<DIV class=entry-content>
<P>LINUX&#19979;&#65292;fork&#20986;&#26469;&#30340;&#23376;&#36827;&#31243;&#65292;&#23545;&#29238;&#36827;&#31243;&#36827;&#34892;&#20102;CLONE&#65292;&#25152;&#26377;&#20869;&#23384;&#39029;&#65292;&#25991;&#20214;&#25551;&#36848;&#31561;&#37117;&#25335;&#36125;&#19968;&#20221;&#65288;COPY ON WRITE&#65289;&#65292;&#20294;&#20063;&#26377;&#30340;&#19996;&#35199;CLONE&#19981;&#20102;&#65292;&#27604;&#22914;&#29238;&#36827;&#31243;&#37324;&#30340;&#22810;&#32447;&#31243;&#65292;&#24182;&#38750;&#20840;&#37096;&#30340;&#32447;&#31243;&#37117;&#34987;CLONE&#20102;&#19968;&#20221;&#65292;fork&#21482;&#33021;CLONE&#35843;&#29992;&#27492;&#20989;&#25968;&#30340;&#32447;&#31243;&#12290;</P>
<P>&#29238;&#36827;&#31243;&#26159;&#21333;&#32447;&#31243;&#65292;fork&#27809;&#20160;&#20040;&#38382;&#39064;&#30340;&#65292;&#26377;&#30340;&#20063;&#26159;&#20247;&#25152;&#21608;&#30693;&#30340;&#20363;&#22914;&#25991;&#20214;&#21477;&#26564;&#34987;&#32487;&#25215;&#20043;&#31867;&#12290;&#22823;&#27010;fork&#35774;&#35745;&#26102;&#22810;&#32447;&#31243;&#24182;&#19981;&#27969;&#34892;&#65292;&#20851;&#29031;&#19981;&#20102;&#21518;&#26469;&#32773;&#65292;&#23545;&#22810;&#32447;&#31243;&#32780;&#35328;&#65292;fork&#20250;&#26377;&#19968;&#20123;&#38544;&#24335;&#38382;&#39064;&#12290;</P>
<P>&#27604;&#22914;&#20170;&#22825;&#35201;&#35828;&#30340;&#23376;&#36827;&#31243;&#30452;&#25509;&#20351;&#29992;&#29238;&#36827;&#31243;&#38145;&#30340;&#38382;&#39064;&#12290;<SPAN id=more-235></SPAN></P>
<H2>&#38382;&#39064;</H2>
<P>&#20551;&#22914;&#29238;&#36827;&#31243;&#26377;A&#65292;B&#20004;&#20010;&#32447;&#31243;&#65292;&#26377;&#19968;&#20010;&#20840;&#23616;&#38145;g_mutex&#12290;B&#32447;&#31243;lock(&amp;g_mutex)&#21518;&#65292;A&#32447;&#31243;&#35843;&#29992;fork&#65292;fork&#21518;&#23601;&#20135;&#29983;&#20102;&#23376;&#36827;&#31243;&#12290;LINUX&#30340;&#23376;&#36827;&#31243;&#21644;WINDOWS&#30340;&#22823;&#19981;&#19968;&#26679;&#65292;WINDOWS&#30340;&#26159;&#30333;&#25163;&#36215;&#23478;&#65292;&#32769;&#29240;&#36305;&#36807;&#30340;&#27969;&#31243;&#20182;&#37117;&#35201;&#37325;&#26032;&#36305;&#19968;&#36941;&#65292;LINUX&#30340;&#26159;&#20856;&#22411;&#23500;&#20108;&#20195;&#65292;&#19968;&#20986;&#29983;&#65292;&#32769;&#29240;&#26377;&#30340;&#20182;&#37117;&#26377;&#20102;&#65292;&#32437;&#35266;&#29616;&#23454;&#65292;&#36825;&#31181;&#23500;&#20108;&#20195;&#65292;&#21482;&#24597;&#26159;&#26576;&#20123;&#36829;&#32972;&#20262;&#29702;&#36947;&#24503;&#30340;&#27604;&#22914;&#32769;&#29240;&#30340;&#20108;&#25151;&#19977;&#25151;&#20182;&#19981;&#33021;&#32487;&#25215;&#65288;&#23601;&#20687;&#29238;&#36827;&#31243;&#30340;&#20854;&#20182;&#32447;&#31243;&#19981;&#33021;&#34987;&#32487;&#25215;&#65289;&#22806;&#65292;&#20160;&#20040;&#20869;&#23384;&#65292;&#25991;&#20214;&#21477;&#26564;&#21834;&#32479;&#32479;&#37117;&#24314;&#31435;&#22312;&#32769;&#29240;&#24403;&#21069;&#29366;&#24577;&#19978;&#12290;</P>
<P>&#20869;&#23384;COPY ON WRITE&#26412;&#26469;&#19981;&#20250;&#20986;&#29616;&#20160;&#20040;&#22823;&#38382;&#39064;&#65292;&#20294;&#26159;&#26576;&#20123;&#20869;&#23384;&#29366;&#24577;&#19981;&#26159;&#31616;&#21333;COPY&#20102;&#20107;&#30340;&#65292;&#20854;&#20013;&#38145;&#23601;&#26159;&#20010;&#20856;&#22411;&#65292;&#20197;&#38145;g_mutex&#20026;&#20363;&#65292;&#29238;&#36827;&#31243;&#30340;B&#32447;&#31243;&#25345;&#26377;&#38145;g_mutex&#65292;&#23376;&#36827;&#31243;&#20174;&#29238;&#36827;&#31243;A&#32447;&#31243;&#32487;&#25215;&#19979;&#26469;&#65292;&#19988;&#31216;&#20854;&#36816;&#34892;&#32447;&#31243;&#20026;&#23567;A&#12290;</P>
<P>&#23567;A&#22914;&#26524;&#24819;&#23545;g_mutex&#21152;&#38145;&#65292;&#30001;&#20110;CLONE&#30340;&#26102;&#20505;&#65292;&#20854;&#24050;&#32463;&#26159;&#8220;&#34987;&#21344;&#26377;&#8221;&#29366;&#24577;&#65292;&#23376;&#36827;&#31243;&#21152;&#38145;&#30340;&#26102;&#20505;&#65292;&#30475;&#21040;g_mutex&#26159;&#8220;&#34987;&#21344;&#26377;&#8221;&#29366;&#24577;&#65292;&#20110;&#26159;&#31561;&#21543;&#65292;&#31561;&#21344;&#26377;&#32773;&#37322;&#25918;&#38145;&#65292;&#38382;&#39064;&#26469;&#20102;&#65292;&#29616;&#22312;&#23376;&#36827;&#31243;&#27809;&#26377;&#32487;&#25215;&#29238;&#36827;&#31243;&#30340;&#20854;&#20182;&#32447;&#31243;&#65292;&#29238;&#36827;&#31243;&#30340;&#32447;&#31243;B&#27809;&#26377;&#29983;&#20986;&#19968;&#20010;&#23567;B&#26469;&#24110;&#21487;&#24604;&#30340;&#23567;A&#37322;&#25918;&#38145;&#65292;&#20110;&#26159;&#23567;A&#31561;&#21040;&#27515;&#37117;&#19981;&#33021;&#35299;&#38145;&#12290;</P>
<P>&#26377;&#20154;&#24819;&#65292;&#29238;&#36827;&#31243;&#30340;B&#32447;&#31243;&#37322;&#25918;&#38145;&#20043;&#21518;&#21602;&#65311;&#23376;&#36827;&#31243;&#33021;&#33258;&#21160;&#35299;&#38145;&#21527;&#65311;&#38382;&#36825;&#20010;&#38382;&#39064;&#65292;&#34920;&#31034;&#27809;&#26377;&#29702;&#35299;&#22909;fork COPY ON WRITE&#30340;&#21407;&#29702;&#65292;&#23376;&#36827;&#31243;&#23545;g_mutex&#21152;&#38145;&#65292;&#20415;&#28041;&#21450;&#21040;&#20889;&#20869;&#23384;&#25805;&#20316;&#65288;&#25110;&#26159;&#29238;&#36827;&#31243;&#37322;&#25918;&#38145;&#20043;&#21518;&#65292;&#20250;&#20889;&#20869;&#23384;&#65289;&#65292;&#27492;&#26102;&#65292;&#23376;&#36827;&#31243;&#21644;&#29238;&#36827;&#31243;&#24050;&#32463;&#19981;&#20849;&#20139;&#21516;&#19968;&#20869;&#23384;&#39029;&#20102;&#65292;&#29366;&#24577;&#24403;&#28982;&#19981;&#33021;&#20849;&#20139;&#65292;COPY ON WRITE&#65292;&#29238;&#36827;&#31243;&#21644;&#23376;&#36827;&#31243;&#30340;&#21516;&#19968;&#21464;&#37327;g_mutex&#65292;&#34429;&#28982;&#25171;&#21360;&#20986;&#26469;&#30340;&#36923;&#36753;&#22320;&#22336;&#19968;&#26679;&#65292;&#20294;&#26159;&#29289;&#29702;&#20869;&#23384;&#24050;&#32463;&#26159;&#20004;&#20010;&#22320;&#26041;&#20102;&#65292;&#23376;&#36827;&#31243;&#30475;&#19981;&#21040;&#29238;&#36827;&#31243;&#37322;&#25918;&#38145;&#30340;&#26631;&#24535;&#65292;<BR>&#20110;&#26159;&#65292;&#23376;&#36827;&#31243;&#23601;&#21482;&#33021;&#23398;&#23614;&#29983;&#30196;&#30196;&#30340;&#31561;&#31561;&#19981;&#26469;&#22969;&#23376;&#25265;&#26609;&#21040;&#27515;&#12290;</P>
<H2>&#30772;&#65311;</H2>
<P>&#30475;&#19978;&#36848;&#25551;&#36848;&#65292;&#22823;&#20384;&#20204;&#21508;&#33258;&#25903;&#25307;&#65292;&#30772;&#35299;&#20043;&#36947;&#26377;&#24456;&#22810;&#65306;</P>
<UL>
<LI><B>&#27604;&#22914;</B>&#65292;&#23376;&#36827;&#31243;&#23567;A&#35201;&#20351;&#29992;&#38145;g_mutex&#21069;&#65292;&#20808;&#23558;&#20854;&#29366;&#24577;&#35774;&#32622;&#20026;&#8220;&#26410;&#34987;&#21344;&#26377;&#8221;&#19981;&#23601;&#32467;&#20102;&#65292;&#24403;&#28982;&#21487;&#20197;&#65292;&#20363;&#22914;&#65292;&#23545;&#20110;pthread_mutex_t&#31867;&#22411;&#30340;g_mutex&#65292;&#21487;&#20197;&#20351;&#29992;pthread_mutex_init&#20877;&#21021;&#22987;&#21270;&#19968;&#27425;&#12290;</LI>
<LI><B>&#20877;&#27604;&#22914;</B>&#65292;&#25105;&#19981;&#29992;&#20320;&#19981;&#23601;&#34892;&#20102;&#65292;&#24403;&#28982;&#20063;&#21487;&#20197;&#65292;&#22914;&#26524;&#20320;&#23545;&#32769;&#29240;&#36951;&#30041;&#19979;&#26469;&#30340;&#19975;&#36143;&#23478;&#20135;&#27627;&#19981;&#21160;&#24515;&#65292;&#37027;&#27809;&#35841;&#31649;&#30340;&#20102;&#12290;&#36825;&#31181;&#24773;&#20917;&#65292;&#24314;&#35758;&#20351;&#29992;signal&#22238;&#35843;&#20013;&#21487;&#35843;&#29992;&#20989;&#25968;&#21015;&#34920;&#20869;&#20989;&#25968;&#12290;</LI>
<LI><B>&#20877;&#20877;&#27604;&#22914;</B>&#65292;&#25105;&#35201;&#21019;&#19994;&#65292;&#25105;&#35201;&#30333;&#25163;&#36215;&#23478;&#23558;&#32769;&#29240;&#36951;&#30041;&#19979;&#26469;&#30340;&#23478;&#20135;&#20840;&#30424;&#20002;&#24323;&#21487;&#21542;&#65311;&#24403;&#28982;&#21487;&#20197;&#65292;&#20107;&#23454;&#19978;&#65292;fork&#21518;&#35843;&#29992;exec&#31995;&#21015;&#20989;&#25968;&#23601;&#26159;&#36825;&#20010;&#21151;&#25928;&#65292;&#20294;&#26159;&#65292;&#20247;&#25152;&#21608;&#30693;&#65292;exec&#31995;&#21015;&#20989;&#25968;&#26367;&#25442;&#20102;&#20869;&#23384;&#31354;&#38388;&#21518;&#65292;&#25991;&#20214;&#21477;&#26564;&#36824;&#23384;&#22312;&#65292;&#36825;&#19996;&#35199;&#23601;&#20687;&#20808;&#22825;&#25216;&#33021;&#36824;&#22312;&#23376;&#36827;&#31243;&#30340;&#36827;&#31243;&#30340;&#34880;&#28082;&#37324;&#27969;&#28108;&#65292;&#22788;&#29702;&#36825;&#31181;&#24773;&#20917;&#65306; 
<UL>
<LI><B>&#19978;&#31574;&#65306;</B><BR>&#29238;&#36827;&#31243;open&#25991;&#20214;&#21477;&#26564;&#30340;&#26102;&#20505;&#65292;&#26174;&#31034;&#25351;&#23450;O_CLOEXEC&#26631;&#35760;(Since Linux 2.6.23)&#65292;&#22914; 
<DIV id=crayon-569898e60d2e8391100706 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d2e8391100706-1">1</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d2e8391100706-1 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>open</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"file"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_RDWR</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_CREAT</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_TRUNC</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-v>O_CLOEXEC</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0600</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV></LI>
<LI><B>&#20013;&#31574;&#65306;</B><BR>&#25171;&#24320;&#25991;&#20214;&#21477;&#26564;&#21518;&#20877;&#35774;&#32622;FD_CLOEXEC&#65292;&#25110;&#26159;fork&#21069;&#35774;&#32622;FD_CLOEXEC&#65292;&#20043;&#25152;&#20197;&#24046;&#19968;&#28857;&#26159;&#65292;&#20320;&#24590;&#20040;&#20445;&#35777;open&#21644;fcntl&#20043;&#38388;&#20854;&#32447;&#31243;&#19981;&#20250;fork&#23376;&#36827;&#31243;&#25110;&#26159;fork&#23376;&#36827;&#31243;&#26102;&#20854;&#20182;&#32447;&#31243;&#19981;&#20250;open&#19968;&#20010;&#21477;&#26564;&#12290; 
<DIV id=crayon-569898e60d2f9104215151 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d2f9104215151-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d2f9104215151-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d2f9104215151-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d2f9104215151-4">4</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d2f9104215151-1 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-v>fd</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>open</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"file"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_RDWR</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_CREAT</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>O_TRUNC</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0600</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d2f9104215151-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>fd</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&lt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d2f9104215151-3 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d2f9104215151-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>fcntl</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>fd</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>F_SETFD</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>FD_CLOEXEC</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV></LI>
<LI><B>&#19979;&#31574;&#65306;</B><BR>&#29238;&#36827;&#31243;fork&#23376;&#36827;&#31243;&#21518;&#65292;&#23558;&#25152;&#26377;&#21477;&#26564;&#36941;&#21382;&#20851;&#38381;&#65292;&#23545;&#65292;&#32593;&#19978;&#26159;&#26377;&#36825;&#31181;&#20570;&#27861;&#65292;&#20294;&#26159;&#65292;&#21531;&#19981;&#35265;&#33258;&#21476;&#20197;&#26292;&#21046;&#26292;&#30340;&#26041;&#27861;&#37117;&#26159;&#26242;&#26102;&#21487;&#34892;&#32456;&#23558;&#20986;&#38382;&#39064;&#30340;&#21527;&#65311;&#23376;&#36827;&#31243;&#21487;&#33021;&#32487;&#32493;&#35775;&#38382;&#29238;&#36827;&#31243;&#26366;&#32463;&#25171;&#24320;&#36807;&#30340;&#36825;&#20123;&#25991;&#20214;&#25551;&#36848;&#31526;&#65292;&#20174;&#32780;&#23548;&#33268;&#24748;&#25346;&#35775;&#38382;&#65288;&#38500;&#38750;&#20851;&#38381;&#25551;&#36848;&#31526;&#20043;&#21518;&#39532;&#19978;&#35843;&#29992;exec&#25110;system&#20043;&#31867;&#30340;&#20989;&#25968;&#21152;&#36733;&#26032;&#30340;&#31243;&#24207;&#26144;&#20687;&#65289;&#12290;<BR>&#27604;&#22914;&#65292;&#29238;&#36827;&#31243;&#25171;&#24320;&#20102;syslog&#20889;&#26085;&#24535;&#65292;&#23376;&#36827;&#31243;&#25226;&#23427;&#20851;&#20102;&#65292;syslog&#30340;&#25551;&#36848;&#31526;&#25351;&#21521;&#20102;&#26032;&#25171;&#24320;&#30340;&#19968;&#20123;&#19981;&#30456;&#20851;&#30340;&#25991;&#20214;&#65292;&#28982;&#21518;&#23376;&#36827;&#31243;&#32487;&#32493;&#35843;&#29992;syslog&#36755;&#20986;&#26085;&#24535;&#26102;&#65292;&#23601;&#20250;&#25226;&#26085;&#24535;&#20449;&#24687;&#36755;&#21040;&#19968;&#20123;&#19981;&#30456;&#20851;&#30340;&#25991;&#20214;&#20013;&#12290;</LI></UL></LI></UL>
<H2>&#23433;&#20840;&#20989;&#25968;</H2>
<P>&#19978;&#38754;&#35762;&#30340;&#37117;&#26159;&#20320;&#22312;&#20195;&#30721;&#37324;&#26174;&#31034;&#21152;&#30340;&#38145;&#65292;&#20294;&#26159;&#26377;&#20123;&#38145;&#27604;&#36739;&#38544;&#26214;&#65292;&#20195;&#30721;&#19981;&#26159;&#20320;&#20889;&#30340;&#65292;&#20320;&#24590;&#20040;&#30693;&#36947;&#21035;&#20154;&#20195;&#30721;&#26159;&#21542;&#29992;&#20102;&#38145;&#65311;&#20363;&#22914;&#36825;&#20123;&#26631;&#20934;&#24211;&#20989;&#25968;&#22312;fork&#21518;&#35843;&#29992;&#37117;&#26159;&#19981;&#23433;&#20840;&#30340;&#65306;</P>
<DIV id=crayon-569898e60d302538348827 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d302538348827-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d302538348827-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d302538348827-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d302538348827-4">4</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d302538348827-1 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-r>malloc</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d302538348827-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-e>stdio </SPAN><SPAN class=crayon-e>functions </SPAN><SPAN class=crayon-e>like </SPAN><SPAN class=crayon-r>printf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>this</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>is</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>required </SPAN><SPAN class=crayon-e>by </SPAN><SPAN class=crayon-e>the </SPAN><SPAN class=crayon-v>standard</SPAN><SPAN class=crayon-sy>.</SPAN></DIV>
<DIV id=crayon-569898e60d302538348827-3 class=crayon-line><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-e>syslog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d302538348827-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN class=crayon-e>setlocale</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#37027;&#20040;&#21738;&#20123;&#26041;&#27861;&#22312;fork&#21518;&#35843;&#29992;&#26159;&#23433;&#20840;&#30340;&#65311;&#21442;&#32771;&#8221; Async-signal-safe functions&#8221; &#21015;&#34920;&#26377;&#65306;</P>
<DIV id=crayon-569898e60d308004376331 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d308004376331-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d308004376331-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d308004376331-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d308004376331-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d308004376331-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d308004376331-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d308004376331-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d308004376331-8">8</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d308004376331-1 class=crayon-line><SPAN class=crayon-v>POSIX</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>2004</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-e>also </SPAN><SPAN class=crayon-e>known </SPAN><SPAN class=crayon-st>as</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>POSIX</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>2001</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>Technical </SPAN><SPAN class=crayon-i>Corrigendum</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>2</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-e>requires </SPAN><SPAN class=crayon-e>an </SPAN><SPAN class=crayon-e>implementation </SPAN><SPAN class=crayon-st>to</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>guarantee </SPAN><SPAN class=crayon-e>that </SPAN><SPAN class=crayon-e>the </SPAN><SPAN class=crayon-e>following </SPAN><SPAN class=crayon-e>functions</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-3 class=crayon-line><SPAN class=crayon-e>can </SPAN><SPAN class=crayon-e>be </SPAN><SPAN class=crayon-e>safely </SPAN><SPAN class=crayon-e>called </SPAN><SPAN class=crayon-i>inside</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>a</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>signal </SPAN><SPAN class=crayon-v>handler</SPAN><SPAN class=crayon-o>:</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>_Exit</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>_exit</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>abort</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>accept</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>access</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>aio_error</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>aio_return</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>aio_suspend</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>alarm</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>bind</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>cfgetispeed</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>cfgetospeed</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>cfsetispeed</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>cfsetospeed</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>chdir</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>chmod</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>chown</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>clock_gettime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>close</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>connect</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>creat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>dup</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>dup2</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>execle</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>execve</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fchmod</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fchown</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fcntl</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fdatasync</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fork</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fpathconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fstat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fsync</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>ftruncate</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getegid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>geteuid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getgid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getgroups</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getpeername</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getpgrp</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getpid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getppid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getsockname</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getsockopt</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>getuid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>kill</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>link</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>listen</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>lseek</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>lstat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mkdir</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mkfifo</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>open</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pathconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pause</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pipe</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>poll</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>posix_trace_event</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pselect</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>raise</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>read</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>readlink</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>recv</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>recvfrom</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>recvmsg</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>rename</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>rmdir</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>select</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sem_post</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>send</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sendmsg</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sendto</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>setgid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>setpgid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>setsid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>setsockopt</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>setuid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>shutdown</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigaction</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigaddset</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigdelset</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigemptyset</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigfillset</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigismember</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>signal</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigpause</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigpending</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigprocmask</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigqueue</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigset</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sigsuspend</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sleep</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sockatmark</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>socket</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>socketpair</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>stat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>symlink</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sysconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcdrain</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcflow</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcflush</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcgetattr</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcgetpgrp</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcsendbreak</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcsetattr</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tcsetpgrp</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>time</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>timer_getoverrun</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>timer_gettime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>timer_settime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>times</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>umask</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>uname</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>unlink</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>utime</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>wait</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>waitpid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>write</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-5 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898e60d308004376331-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-v>POSIX</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>2008</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>removes </SPAN><SPAN class=crayon-e>fpathconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pathconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>and</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sysconf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>from </SPAN><SPAN class=crayon-e>the</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-7 class=crayon-line><SPAN class=crayon-e>above </SPAN><SPAN class=crayon-v>list</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>and</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>adds </SPAN><SPAN class=crayon-e>the </SPAN><SPAN class=crayon-e>following </SPAN><SPAN class=crayon-v>functions</SPAN><SPAN class=crayon-o>:</SPAN></DIV>
<DIV id=crayon-569898e60d308004376331-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>execl</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>execv</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>faccessat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fchmodat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fchownat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fexecve</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fstatat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>futimens</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>linkat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mkdirat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mkfifoat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mknod</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>mknodat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>openat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>readlinkat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>renameat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>symlinkat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>unlinkat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>utimensat</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>utimes</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<H2>&#27979;&#35797;&#20195;&#30721;</H2>
<P></P>
<DIV id=crayon-569898e60d311777372311 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-14">14</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-15">15</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-16">16</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-17">17</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-18">18</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-19">19</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-20">20</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-21">21</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-22">22</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-23">23</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-24">24</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-25">25</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-26">26</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-27">27</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-28">28</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-29">29</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-30">30</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-31">31</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-32">32</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-33">33</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-34">34</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-35">35</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-36">36</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-37">37</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-38">38</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-39">39</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-40">40</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-41">41</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-42">42</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-43">43</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-44">44</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-45">45</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-46">46</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-47">47</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-48">48</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-49">49</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-50">50</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-51">51</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-52">52</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-53">53</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-54">54</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-55">55</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-56">56</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-57">57</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-58">58</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-59">59</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-60">60</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-61">61</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-62">62</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-63">63</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-64">64</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-65">65</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-66">66</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-67">67</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-68">68</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-69">69</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-70">70</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-71">71</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-72">72</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-73">73</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-74">74</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-75">75</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-76">76</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-77">77</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-78">78</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-79">79</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-80">80</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d311777372311-81">81</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d311777372311-82">82</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d311777372311-1 class=crayon-line><SPAN class=crayon-p>#include &lt;stdio.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-p>#include &lt;stdlib.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-3 class=crayon-line><SPAN class=crayon-p>#include &lt;unistd.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-p>#include &lt;assert.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-5 class=crayon-line><SPAN class=crayon-p>#include &lt;time.h&gt; </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-p>#include &lt;sys/time.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-7 class=crayon-line><SPAN class=crayon-p>#include &lt;pthread.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-p>#include &lt;sys/types.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-9 class=crayon-line><SPAN class=crayon-p>#include &lt;unistd.h&gt;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-10 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-11 class=crayon-line><SPAN class=crayon-p>#define mylog(fmt, args...) do{ </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>timeval </SPAN><SPAN class=crayon-v>tv</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>}</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-13 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>struct</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>tm </SPAN><SPAN class=crayon-v>dt</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>}</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>gettimeofday</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>tv</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-15 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>localtime_r</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>tv</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv_sec</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>dt</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-16 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-r>printf</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"%02d:%02d:%02d.%03d [%04ld] | "</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>fmt</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-s>"n"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>dt</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tm_hour</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>dt</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tm_min</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>dt</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tm_sec</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>tv</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>tv_usec</SPAN><SPAN class=crayon-o>/</SPAN><SPAN class=crayon-cn>1000</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>long</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-e>getpid</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-p>##args); </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-17 class=crayon-line><SPAN class=crayon-sy>}</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>while</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-18 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-19 class=crayon-line><SPAN class=crayon-e>pthread_mutex_t </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-20 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-21 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread_handle_lock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>arg</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-22 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-23 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sleepsec</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>unsigned</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>long</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-v>arg</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-24 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>pthread_t </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_self</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-25 class=crayon-line><SPAN class=crayon-h></SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-26 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"thread(%ld) %s, g_mutex(%p,%d), try lock"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>__FUNCTION__</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__data</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-27 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_mutex_lock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-28 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"thread(%ld) %s, g_mutex(%p,%d), will sleep %d seconds, err(%d)"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>__FUNCTION__</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__data</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sleepsec</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-29 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>sleep</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>sleepsec</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-30 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_mutex_unlock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-31 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"thread(%ld) %s, g_mutex(%p,%d), after sleep %d exit...err(%d)"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>__FUNCTION__</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__data</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sleepsec</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-32 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-33 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-34 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-35 class=crayon-line><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fork_process</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>reinit</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-36 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-37 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>pid_t </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-38 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-39 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>fork</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-40 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&lt;</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-41 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-42 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"fork failed %d"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-43 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>-</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-44 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-45 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-46 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>==</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-47 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-48 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"child process enter!"</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-49 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>if</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>reinit</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-50 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"before reinit g_mutex(%p,%d) in child process"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__data</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-51 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_mutex_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-52 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>assert</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>==</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-53 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"after&nbsp;&nbsp;reinit g_mutex(%p,%d) in child process"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__data</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-v>__lock</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-54 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-55 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>thread_handle_lock</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-56 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"child process exit!"</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-57 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>_exit</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-58 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-59 class=crayon-line>&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-60 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-61 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-62 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-63 class=crayon-line><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>create_thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sec</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>reinit</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-64 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-65 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>pthread_t </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-66 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>=</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_mutex_init</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>g_mutex</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-67 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>assert</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>==</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>err</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-68 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>pthread_create</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-o>&amp;</SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>void</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>unsigned</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>long</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-v>sec</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-69 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>sleep</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-70 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>fork_process</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>reinit</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-71 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>pthread_join</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>NULL</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-72 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"parent wait sub thread(%ld) ok, sleep 3 sec!"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>tid</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-73 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>sleep</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-74 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>mylog</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-s>"parent thread(%ld) exit!"</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>pthread_self</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-75 class=crayon-line><SPAN class=crayon-sy>}</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-76 class="crayon-line crayon-striped-line">&nbsp;</DIV>
<DIV id=crayon-569898e60d311777372311-77 class=crayon-line><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>main</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-t>int</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>argc</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-t>char</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-o>*</SPAN><SPAN class=crayon-v>argv</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-78 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>{</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-79 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-e>create_thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>argc</SPAN><SPAN class=crayon-o>&gt;</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>?</SPAN><SPAN class=crayon-e>atoi</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-v>argv</SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>5</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>argc</SPAN><SPAN class=crayon-o>&gt;</SPAN><SPAN class=crayon-cn>2</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-80 class="crayon-line crayon-striped-line"><SPAN class=crayon-h></SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-81 class=crayon-line><SPAN class=crayon-h></SPAN><SPAN class=crayon-st>return</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>;</SPAN></DIV>
<DIV id=crayon-569898e60d311777372311-82 class="crayon-line crayon-striped-line"><SPAN class=crayon-sy>}</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P><B>&#25191;&#34892;&#32467;&#26524;1&#65306;</B>&#29238;&#36827;&#31243;13691&#25345;&#26377;&#38145;&#30340;&#24773;&#20917;&#19979;fork&#21518;&#65292;&#23376;&#36827;&#31243;13693&#19968;&#33268;&#21345;&#22312;lock&#30340;&#22320;&#26041;&#19981;&#20250;&#36864;&#20986;&#12290;</P>
<DIV id=crayon-569898e60d31b894552642 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d31b894552642-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d31b894552642-12">12</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d31b894552642-1 class=crayon-line><SPAN class=crayon-c># killall test </SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-r>test</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>no </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-v>found</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-3 class=crayon-line><SPAN class=crayon-c># ./test 5</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>38.876</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13691</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072316929792</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-5 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>38.877</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13691</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072316929792</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>will </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>5</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>seconds</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>39.878</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13693</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-v>enter</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-7 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>39.878</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13693</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072337258272</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>43.877</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13691</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072316929792</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>5</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-e>.err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-9 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>43.878</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13691</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>wait</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sub </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072316929792</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ok</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sec</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>48</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>46.878</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13691</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140072337258272</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-11 class=crayon-line><SPAN class=crayon-c># pidof test</SPAN></DIV>
<DIV id=crayon-569898e60d31b894552642-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>13693</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P><B>&#25191;&#34892;&#32467;&#26524;2&#65306;</B>&#29238;&#36827;&#31243;13701&#25345;&#26377;&#38145;&#21448;&#37322;&#25918;&#38145;&#21518;&#20877;fork&#65292;&#23376;&#36827;&#31243;13703&#33021;&#25104;&#21151;&#21152;&#38145;&#35299;&#38145;&#65292;&#23436;&#20840;&#27809;&#38382;&#39064;&#12290;</P>
<DIV id=crayon-569898e60d323395432936 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d323395432936-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d323395432936-13">13</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d323395432936-1 class=crayon-line><SPAN class=crayon-c># killall test </SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-c># ./test 0</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-3 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>11.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13701</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730513041152</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>11.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13701</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730513041152</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>will </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>seconds</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-5 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>11.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13701</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730513041152</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-e>.err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>12.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13701</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>wait</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sub </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730513041152</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ok</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sec</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-7 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>12.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13703</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-v>enter</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>12.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13703</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730533369632</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-9 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>12.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13703</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730533369632</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>will </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>seconds</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>15.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13701</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730533369632</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-11 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>15.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13703</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>139730533369632</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-e>.err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>15.487</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13703</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d323395432936-13 class=crayon-line><SPAN class=crayon-c># pidof test</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P><B>&#25191;&#34892;&#32467;&#26524;3&#65306;</B>&#29238;&#36827;&#31243;13706&#25345;&#26377;&#38145;&#30340;&#24773;&#20917;&#19979;fork&#21518;&#65292;&#23376;&#36827;&#31243;&#25191;&#34892;&#20102;&#37325;&#26032;&#21021;&#22987;&#21270;&#38145;&#25805;&#20316;&#65292;&#23376;&#36827;&#31243;&#33021;&#25104;&#21151;&#21152;&#38145;&#35299;&#38145;&#65292;&#23436;&#20840;&#27809;&#38382;&#39064;&#12290;</P>
<DIV id=crayon-569898e60d32b800486811 class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" style="FONT-SIZE: 14px !important; HEIGHT: auto; LINE-HEIGHT: 15px !important" data-settings=" minimize scroll-mouseover">
<DIV class=crayon-plain-wrap></DIV>
<DIV class=crayon-main style="OVERFLOW: hidden; POSITION: relative; Z-INDEX: 1">
<TABLE class=crayon-table>
<TBODY>
<TR class=crayon-row>
<TD class="crayon-nums " data-settings="show">
<DIV class=crayon-nums-content style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important">
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-1">1</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-2">2</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-3">3</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-4">4</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-5">5</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-6">6</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-7">7</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-8">8</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-9">9</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-10">10</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-11">11</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-12">12</DIV>
<DIV class=crayon-num data-line="crayon-569898e60d32b800486811-13">13</DIV>
<DIV class="crayon-num crayon-striped-num" data-line="crayon-569898e60d32b800486811-14">14</DIV></DIV></TD>
<TD class=crayon-code>
<DIV class=crayon-pre style="FONT-SIZE: 14px !important; LINE-HEIGHT: 15px !important; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; tab-size: 4">
<DIV id=crayon-569898e60d32b800486811-1 class=crayon-line><SPAN class=crayon-c># ./test 5 1</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-2 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>29.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13706</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038033610496</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-3 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>29.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13706</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038033610496</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>will </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>5</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>seconds</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-4 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>30.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-v>enter</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-5 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>30.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>before </SPAN><SPAN class=crayon-e>reinit </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>in</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>process</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-6 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>30.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after&nbsp;&nbsp;</SPAN><SPAN class=crayon-e>reinit </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>in</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>process</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-7 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>30.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038053938976</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-st>try</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-i>lock</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-8 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>30.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038053938976</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>1</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>will </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>seconds</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-9 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>33.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038053938976</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-e>.err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-10 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>33.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13708</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>child</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>process </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-11 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>34.152</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13706</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038033610496</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>thread_handle_lock</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>g_mutex</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0x602380</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>after </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>5</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-sy>.</SPAN><SPAN class=crayon-e>.err</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>0</SPAN><SPAN class=crayon-sy>)</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-12 class="crayon-line crayon-striped-line"><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>34.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13706</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>wait</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>sub </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038033610496</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>ok</SPAN><SPAN class=crayon-sy>,</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>sleep</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-cn>3</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-v>sec</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-13 class=crayon-line><SPAN class=crayon-cn>20</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>49</SPAN><SPAN class=crayon-o>:</SPAN><SPAN class=crayon-cn>37.153</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-sy>[</SPAN><SPAN class=crayon-cn>13706</SPAN><SPAN class=crayon-sy>]</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-o>|</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>parent</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-e>thread</SPAN><SPAN class=crayon-sy>(</SPAN><SPAN class=crayon-cn>140038053938976</SPAN><SPAN class=crayon-sy>)</SPAN><SPAN class=crayon-h> </SPAN><SPAN class=crayon-r>exit</SPAN><SPAN class=crayon-o>!</SPAN></DIV>
<DIV id=crayon-569898e60d32b800486811-14 class="crayon-line crayon-striped-line"><SPAN class=crayon-c># pidof test</SPAN></DIV></DIV></TD></TR></TBODY></TABLE></DIV></DIV>
<P></P>
<P>&#26377;&#20154;&#38382;pthread_atfork&#33021;&#35299;&#20915;&#27492;&#38382;&#39064;&#21527;&#65311;&#19981;&#22909;&#24847;&#24605;&#65292;pthread_atfork&#20063;&#19981;&#26159;&#38382;&#39064;&#30340;&#35299;&#20915;&#20043;&#36947;&#65292;&#35831;&#21442;&#32771;<A href="http://lwn.net/Articles/465398/" _target="_blank">http://lwn.net/Articles/465398/ </A></P>
<H2><A href="http://lwn.net/Articles/465398/" _target="_blank">&#21442;&#32771;&#36164;&#26009;</A></H2><A href="http://lwn.net/Articles/465398/" _target="_blank"></A>
<P><A href="http://lwn.net/Articles/465398/" _target="_blank">1. </A><A href="http://www.linuxprogrammingblog.com/threads-and-fork-think-twice-before-using-them" _target="_blank">&#8220;Threads and fork(): think twice before mixing them&#8221;</A> - http://www.linuxprogrammingblog.com/threads-and-fork-think-twice-before-using-them<BR>2. <A href="http://man7.org/linux/man-pages/man7/signal.7.html" _target="_blank">"signal - overview of signals"</A> - http://man7.org/linux/man-pages/man7/signal.7.html</P>
<P><A href="http://mnstory.net/wp-content/uploads/2013/10/m.think-twice-before-mixing-threads-fork/think-twice-before-mixing-threads-fork.pdf" target=_bank>PDF&#19979;&#36733;</A></P></DIV>