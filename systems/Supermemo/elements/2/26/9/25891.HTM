<H2>Linux&#35774;&#22791;&#27169;&#22411;(2)_Kobject</H2>
<P class=date>&#20316;&#32773;&#65306;<A href="http://www.wowotech.net/author/2">&#34583;&#34583;</A> &#21457;&#24067;&#20110;&#65306;2014-3-7 0:25 &#20998;&#31867;&#65306;<A href="http://www.wowotech.net/sort/device_model">&#32479;&#19968;&#35774;&#22791;&#27169;&#22411;</A> </P>
<H4>1. &#21069;&#35328; </H4>
<P>Kobject&#26159;Linux&#35774;&#22791;&#27169;&#22411;&#30340;&#22522;&#30784;&#65292;&#20063;&#26159;&#35774;&#22791;&#27169;&#22411;&#20013;&#26368;&#38590;&#29702;&#35299;&#30340;&#19968;&#37096;&#20998;&#65288;&#21487;&#21442;&#32771;Documentation/kobject.txt&#30340;&#34920;&#36848;&#65289;&#12290;&#22240;&#27492;&#26377;&#24517;&#35201;&#20808;&#25226;&#23427;&#20998;&#26512;&#28165;&#26970;&#12290; </P>
<H4>2. &#22522;&#26412;&#27010;&#24565; </H4>
<P>&#30001;&#8220;<A href="http://www.wowotech.net/linux_kenrel/13.html">Linux&#35774;&#22791;&#27169;&#22411;(1)_&#22522;&#26412;&#27010;&#24565;</A>&#8221;&#21487;&#30693;&#65292;Linux&#35774;&#22791;&#27169;&#22411;&#30340;&#26680;&#24515;&#26159;&#20351;&#29992;Bus&#12289;Class&#12289;Device&#12289;Driver&#22235;&#20010;&#26680;&#24515;&#25968;&#25454;&#32467;&#26500;&#65292;&#23558;&#22823;&#37327;&#30340;&#12289;&#19981;&#21516;&#21151;&#33021;&#30340;&#30828;&#20214;&#35774;&#22791;&#65288;&#20197;&#21450;&#39537;&#21160;&#35813;&#30828;&#20214;&#35774;&#22791;&#30340;&#26041;&#27861;&#65289;&#65292;&#20197;&#26641;&#29366;&#32467;&#26500;&#30340;&#24418;&#24335;&#65292;&#36827;&#34892;&#24402;&#32435;&#12289;&#25277;&#35937;&#65292;&#20174;&#32780;&#26041;&#20415;Kernel&#30340;&#32479;&#19968;&#31649;&#29702;&#12290; </P>
<P>&#32780;&#30828;&#20214;&#35774;&#22791;&#30340;&#25968;&#37327;&#12289;&#31181;&#31867;&#26159;&#38750;&#24120;&#22810;&#30340;&#65292;&#36825;&#23601;&#20915;&#23450;&#20102;Kernel&#20013;&#23558;&#20250;&#26377;&#22823;&#37327;&#30340;&#26377;&#20851;&#35774;&#22791;&#27169;&#22411;&#30340;&#25968;&#25454;&#32467;&#26500;&#12290;&#36825;&#20123;&#25968;&#25454;&#32467;&#26500;&#19968;&#23450;&#26377;&#19968;&#20123;&#20849;&#21516;&#30340;&#21151;&#33021;&#65292;&#38656;&#35201;&#25277;&#35937;&#20986;&#26469;&#32479;&#19968;&#23454;&#29616;&#65292;&#21542;&#21017;&#23601;&#20250;&#19981;&#21487;&#36991;&#20813;&#30340;&#20135;&#29983;&#20887;&#20313;&#20195;&#30721;&#12290;&#36825;&#23601;&#26159;Kobject&#35806;&#29983;&#30340;&#32972;&#26223;&#12290; </P>
<P>&#30446;&#21069;&#20026;&#27490;&#65292;Kobject&#20027;&#35201;&#25552;&#20379;&#22914;&#19979;&#21151;&#33021;&#65306; </P>
<OL>
<LI>&#36890;&#36807;parent&#25351;&#38024;&#65292;&#21487;&#20197;&#23558;&#25152;&#26377;Kobject&#20197;&#23618;&#27425;&#32467;&#26500;&#30340;&#24418;&#24335;&#32452;&#21512;&#36215;&#26469;&#12290; 
<LI>&#20351;&#29992;&#19968;&#20010;&#24341;&#29992;&#35745;&#25968;&#65288;reference count&#65289;&#65292;&#26469;&#35760;&#24405;Kobject&#34987;&#24341;&#29992;&#30340;&#27425;&#25968;&#65292;&#24182;&#22312;&#24341;&#29992;&#27425;&#25968;&#21464;&#20026;0&#26102;&#25226;&#23427;&#37322;&#25918;&#65288;&#36825;&#26159;Kobject&#35806;&#29983;&#26102;&#30340;&#21807;&#19968;&#21151;&#33021;&#65289;&#12290; 
<LI>&#21644;sysfs&#34394;&#25311;&#25991;&#20214;&#31995;&#32479;&#37197;&#21512;&#65292;&#23558;&#27599;&#19968;&#20010;Kobject&#21450;&#20854;&#29305;&#24615;&#65292;&#20197;&#25991;&#20214;&#30340;&#24418;&#24335;&#65292;&#24320;&#25918;&#21040;&#29992;&#25143;&#31354;&#38388;&#65288;&#26377;&#20851;sysfs&#65292;&#20250;&#22312;&#20854;&#23427;&#25991;&#31456;&#20013;&#19987;&#38376;&#25551;&#36848;&#65292;&#26412;&#25991;&#19981;&#20250;&#28041;&#21450;&#22826;&#22810;&#20869;&#23481;&#65289;&#12290; </LI></OL>
<P><SPAN style="COLOR: rgb(255,0,0)">&#27880;1&#65306;&#22312;Linux&#20013;&#65292;Kobject&#20960;&#20046;&#19981;&#20250;&#21333;&#29420;&#23384;&#22312;&#12290;&#23427;&#30340;&#20027;&#35201;&#21151;&#33021;&#65292;&#23601;&#26159;&#20869;&#23884;&#22312;&#19968;&#20010;&#22823;&#22411;&#30340;&#25968;&#25454;&#32467;&#26500;&#20013;&#65292;&#20026;&#36825;&#20010;&#25968;&#25454;&#32467;&#26500;&#25552;&#20379;&#19968;&#20123;&#24213;&#23618;&#30340;&#21151;&#33021;&#23454;&#29616;&#12290; <BR>&#27880;2&#65306;Linux driver&#24320;&#21457;&#32773;&#65292;&#24456;&#23569;&#20250;&#30452;&#25509;&#20351;&#29992;Kobject&#20197;&#21450;&#23427;&#25552;&#20379;&#30340;&#25509;&#21475;&#65292;&#32780;&#26159;&#20351;&#29992;&#26500;&#24314;&#22312;Kobject&#20043;&#19978;&#30340;&#35774;&#22791;&#27169;&#22411;&#25509;&#21475;&#12290;</SPAN> </P>
<H4>3. &#20195;&#30721;&#35299;&#26512; </H4>
<H5>3.1 &#22312;Linux Kernel source code&#20013;&#30340;&#20301;&#32622; </H5>
<P>&#22312;Kernel&#28304;&#20195;&#30721;&#20013;&#65292;Kobject&#30001;&#22914;&#19979;&#20004;&#20010;&#25991;&#20214;&#23454;&#29616;&#65306; </P>
<UL>
<LI>include/linux/kobject.h 
<LI>lib/kobject.c </LI></UL>
<P>&#20854;&#20013;kobject.h&#20026;Kobject&#30340;&#22836;&#25991;&#20214;&#65292;&#21253;&#21547;&#25152;&#26377;&#30340;&#25968;&#25454;&#32467;&#26500;&#23450;&#20041;&#21644;&#25509;&#21475;&#22768;&#26126;&#12290;kobject.c&#20026;&#26680;&#24515;&#21151;&#33021;&#30340;&#23454;&#29616;&#12290; </P>
<H5>3.2 &#20027;&#35201;&#30340;&#25968;&#25454;&#32467;&#26500; </H5>
<P>&#22312;&#25551;&#36848;&#25968;&#25454;&#32467;&#26500;&#20043;&#21069;&#65292;&#26377;&#24517;&#35201;&#35828;&#26126;&#19968;&#19979;Kobject, Kset&#21644;Ktype&#36825;&#19977;&#20010;&#27010;&#24565;&#12290; </P>
<P>Kobject&#26159;&#22522;&#26412;&#25968;&#25454;&#31867;&#22411;&#65292;&#27599;&#20010;Kobject&#37117;&#20250;&#22312;"/sys/&#8220;&#25991;&#20214;&#31995;&#32479;&#20013;&#20197;&#30446;&#24405;&#30340;&#24418;&#24335;&#20986;&#29616;&#12290; </P>
<P>Ktype&#20195;&#34920;Kobject&#65288;<SPAN style="COLOR: rgb(255,0,0)">&#20005;&#26684;&#22320;&#35762;&#65292;&#26159;&#21253;&#21547;&#20102;Kobject&#30340;&#25968;&#25454;&#32467;&#26500;</SPAN>&#65289;&#30340;&#23646;&#24615;&#25805;&#20316;&#38598;&#21512;&#65288;&#30001;&#20110;&#36890;&#29992;&#24615;&#65292;&#22810;&#20010;Kobject&#21487;&#33021;&#20849;&#29992;&#21516;&#19968;&#20010;&#23646;&#24615;&#25805;&#20316;&#38598;&#65292;&#22240;&#27492;&#25226;Ktype&#29420;&#31435;&#20986;&#26469;&#20102;&#65289;&#12290; <BR><SPAN style="COLOR: rgb(255,0,0)">&#27880;3&#65306;&#22312;&#35774;&#22791;&#27169;&#22411;&#20013;&#65292;ktype&#30340;&#21629;&#21517;&#21644;&#35299;&#37322;&#65292;&#37117;&#38750;&#24120;&#25277;&#35937;&#65292;&#29702;&#35299;&#36215;&#26469;&#38750;&#24120;&#22256;&#38590;&#65292;&#21518;&#38754;&#20250;&#35814;&#32454;&#35828;&#26126;&#12290;</SPAN> </P>
<P>Kset&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;Kobject&#65288;&#22240;&#27492;&#23427;&#20063;&#20250;&#22312;"/sys/&#8220;&#25991;&#20214;&#31995;&#32479;&#20013;&#20197;&#30446;&#24405;&#30340;&#24418;&#24335;&#20986;&#29616;&#65289;&#65292;&#23427;&#29992;&#26469;&#38598;&#21512;&#30456;&#20284;&#30340;Kobject&#65288;&#36825;&#20123;Kobject&#21487;&#20197;&#26159;&#30456;&#21516;&#23646;&#24615;&#30340;&#65292;&#20063;&#21487;&#20197;&#19981;&#21516;&#23646;&#24615;&#30340;&#65289;&#12290; </P>
<UL>
<LI>&#39318;&#20808;&#30475;&#19968;&#19979;Kobject&#30340;&#21407;&#22411; </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* Kobject: include/linux/kobject.h line 60 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *name;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> list_head    entry;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject      *parent;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset     *kset;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_type    *ktype;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> sysfs_dirent *sd;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kref     kref;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum10 style="COLOR: rgb(96,96,96)"> 10:</SPAN>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">unsigned</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> state_initialized:1;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum11 style="COLOR: rgb(96,96,96)"> 11:</SPAN>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">unsigned</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> state_in_sysfs:1;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum12 style="COLOR: rgb(96,96,96)"> 12:&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: rgb(0,0,255)">unsigned</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> state_add_uevent_sent:1;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum13 style="COLOR: rgb(96,96,96)"> 13:&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: rgb(0,0,255)">unsigned</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> state_remove_uevent_sent:1;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum14 style="COLOR: rgb(96,96,96)"> 14:&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: rgb(0,0,255)">unsigned</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> uevent_suppress:1;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum15 style="COLOR: rgb(96,96,96)"> 15:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>name&#65292;&#35813;Kobject&#30340;&#21517;&#31216;&#65292;&#21516;&#26102;&#20063;&#26159;sysfs&#20013;&#30340;&#30446;&#24405;&#21517;&#31216;&#12290;&#30001;&#20110;Kobject&#28155;&#21152;&#21040;Kernel&#26102;&#65292;&#38656;&#35201;&#26681;&#25454;&#21517;&#23383;&#27880;&#20876;&#21040;sysfs&#20013;&#65292;&#20043;&#21518;&#23601;&#19981;&#33021;&#20877;&#30452;&#25509;&#20462;&#25913;&#35813;&#23383;&#27573;&#12290;&#22914;&#26524;&#38656;&#35201;&#20462;&#25913;Kobject&#30340;&#21517;&#23383;&#65292;&#38656;&#35201;&#35843;&#29992;kobject_rename&#25509;&#21475;&#65292;&#35813;&#25509;&#21475;&#20250;&#20027;&#21160;&#22788;&#29702;sysfs&#30340;&#30456;&#20851;&#20107;&#23452;&#12290; </P>
<P>entry&#65292;&#29992;&#20110;&#23558;Kobject&#21152;&#20837;&#21040;Kset&#20013;&#30340;list_head&#12290; </P>
<P>parent&#65292;&#25351;&#21521;parent kobject&#65292;&#20197;&#27492;&#24418;&#25104;&#23618;&#27425;&#32467;&#26500;&#65288;&#22312;sysfs&#23601;&#34920;&#29616;&#20026;&#30446;&#24405;&#32467;&#26500;&#65289;&#12290; </P>
<P>kset&#65292;&#35813;kobject&#23646;&#20110;&#30340;Kset&#12290;&#21487;&#20197;&#20026;NULL&#12290;&#22914;&#26524;&#23384;&#22312;&#65292;&#19988;&#27809;&#26377;&#25351;&#23450;parent&#65292;&#21017;&#20250;&#25226;Kset&#20316;&#20026;parent&#65288;&#21035;&#24536;&#20102;Kset&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;Kobject&#65289;&#12290; </P>
<P>ktype&#65292;&#35813;Kobject&#23646;&#20110;&#30340;kobj_type&#12290;&#27599;&#20010;Kobject&#24517;&#39035;&#26377;&#19968;&#20010;ktype&#65292;&#25110;&#32773;Kernel&#20250;&#25552;&#31034;&#38169;&#35823;&#12290; </P>
<P>sd&#65292;&#35813;Kobject&#22312;sysfs&#20013;&#30340;&#34920;&#31034;&#12290; </P>
<P>kref&#65292;"struct kref&#8221;&#31867;&#22411;&#65288;&#22312;include/linux/kref.h&#20013;&#23450;&#20041;&#65289;&#30340;&#21464;&#37327;&#65292;&#20026;&#19968;&#20010;&#21487;&#29992;&#20110;&#21407;&#23376;&#25805;&#20316;&#30340;&#24341;&#29992;&#35745;&#25968;&#12290; </P>
<P>state_initialized&#65292;&#25351;&#31034;&#35813;Kobject&#26159;&#21542;&#24050;&#32463;&#21021;&#22987;&#21270;&#65292;&#20197;&#22312;Kobject&#30340;Init&#65292;Put&#65292;Add&#31561;&#25805;&#20316;&#26102;&#36827;&#34892;&#24322;&#24120;&#26657;&#39564;&#12290; </P>
<P>state_in_sysfs&#65292;&#25351;&#31034;&#35813;Kobject&#26159;&#21542;&#24050;&#22312;sysfs&#20013;&#21576;&#29616;&#65292;&#20197;&#20415;&#22312;&#33258;&#21160;&#27880;&#38144;&#26102;&#20174;sysfs&#20013;&#31227;&#38500;&#12290; </P>
<P>state_add_uevent_sent/state_remove_uevent_sent&#65292;&#35760;&#24405;&#26159;&#21542;&#24050;&#32463;&#21521;&#29992;&#25143;&#31354;&#38388;&#21457;&#36865;ADD uevent&#65292;&#22914;&#26524;&#26377;&#65292;&#19988;&#27809;&#26377;&#21457;&#36865;remove uevent&#65292;&#21017;&#22312;&#33258;&#21160;&#27880;&#38144;&#26102;&#65292;&#34917;&#21457;REMOVE uevent&#65292;&#20197;&#20415;&#35753;&#29992;&#25143;&#31354;&#38388;&#27491;&#30830;&#22788;&#29702;&#12290; </P>
<P>uevent_suppress&#65292;&#22914;&#26524;&#35813;&#23383;&#27573;&#20026;1&#65292;&#21017;&#34920;&#31034;&#24573;&#30053;&#25152;&#26377;&#19978;&#25253;&#30340;uevent&#20107;&#20214;&#12290; </P>
<P><SPAN style="COLOR: rgb(255,0,0)">&#27880;4&#65306;Uevent&#25552;&#20379;&#20102;&#8220;&#29992;&#25143;&#31354;&#38388;&#36890;&#30693;&#8221;&#30340;&#21151;&#33021;&#23454;&#29616;&#65292;&#36890;&#36807;&#35813;&#21151;&#33021;&#65292;&#24403;&#20869;&#26680;&#20013;&#26377;Kobject&#30340;&#22686;&#21152;&#12289;&#21024;&#38500;&#12289;&#20462;&#25913;&#31561;&#21160;&#20316;&#26102;&#65292;&#20250;&#36890;&#30693;&#29992;&#25143;&#31354;&#38388;&#12290;&#26377;&#20851;&#35813;&#21151;&#33021;&#30340;&#20855;&#20307;&#20869;&#23481;&#65292;&#20250;&#22312;&#20854;&#23427;&#25991;&#31456;&#35814;&#32454;&#25551;&#36848;&#12290;</SPAN> </P></BLOCKQUOTE>
<UL>
<LI>Kset&#30340;&#21407;&#22411;&#20026; </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 159 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> list_head list;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;spinlock_t list_lock;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject kobj;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset_uevent_ops *uevent_ops;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>list/list_lock&#65292;&#29992;&#20110;&#20445;&#23384;&#35813;kset&#19979;&#25152;&#26377;&#30340;kobject&#30340;&#38142;&#34920;&#12290; </P>
<P>kobj&#65292;&#35813;kset&#33258;&#24049;&#30340;kobject&#65288;kset&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;kobject&#65292;&#20063;&#20250;&#22312;sysfs&#20013;&#20197;&#30446;&#24405;&#30340;&#24418;&#24335;&#20307;&#29616;&#65289;&#12290; </P>
<P>uevent_ops&#65292;&#35813;kset&#30340;uevent&#25805;&#20316;&#20989;&#25968;&#38598;&#12290;&#24403;&#20219;&#20309;Kobject&#38656;&#35201;&#19978;&#25253;uevent&#26102;&#65292;&#37117;&#35201;&#35843;&#29992;&#23427;&#25152;&#20174;&#23646;&#30340;kset&#30340;uevent_ops&#65292;&#28155;&#21152;&#29615;&#22659;&#21464;&#37327;&#65292;&#25110;&#32773;&#36807;&#28388;event&#65288;kset&#21487;&#20197;&#20915;&#23450;&#21738;&#20123;event&#21487;&#20197;&#19978;&#25253;&#65289;&#12290;&#22240;&#27492;&#65292;&#22914;&#26524;&#19968;&#20010;kobject&#19981;&#23646;&#20110;&#20219;&#20309;kset&#26102;&#65292;&#26159;&#19981;&#20801;&#35768;&#21457;&#36865;uevent&#30340;&#12290; </P></BLOCKQUOTE>
<UL>
<LI>Ktype&#30340;&#21407;&#22411;&#20026; </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 108 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_type {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">void</SPAN> (*release)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> sysfs_ops *sysfs_ops;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> attribute **default_attrs;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_ns_type_operations *(*child_ns_type)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> *(*<SPAN style="COLOR: rgb(0,0,255)">namespace</SPAN>)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>release&#65292;&#36890;&#36807;&#35813;&#22238;&#35843;&#20989;&#25968;&#65292;&#21487;&#20197;&#23558;&#21253;&#21547;&#35813;&#31181;&#31867;&#22411;kobject&#30340;&#25968;&#25454;&#32467;&#26500;&#30340;&#20869;&#23384;&#31354;&#38388;&#37322;&#25918;&#25481;&#12290; </P>
<P>sysfs_ops&#65292;&#35813;&#31181;&#31867;&#22411;&#30340;Kobject&#30340;sysfs&#25991;&#20214;&#31995;&#32479;&#25509;&#21475;&#12290; </P>
<P>default_attrs&#65292;&#35813;&#31181;&#31867;&#22411;&#30340;Kobject&#30340;atrribute&#21015;&#34920;&#65288;&#25152;&#35859;attribute&#65292;&#23601;&#26159;sysfs&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#19968;&#20010;&#25991;&#20214;&#65289;&#12290;&#23558;&#20250;&#22312;Kobject&#28155;&#21152;&#21040;&#20869;&#26680;&#26102;&#65292;&#19968;&#24182;&#27880;&#20876;&#21040;sysfs&#20013;&#12290; </P>
<P>child_ns_type/namespace&#65292;&#21644;&#25991;&#20214;&#31995;&#32479;&#65288;sysfs&#65289;&#30340;&#21629;&#21517;&#31354;&#38388;&#26377;&#20851;&#65292;&#36825;&#37324;&#19981;&#20877;&#35814;&#32454;&#35828;&#26126;&#12290; </P></BLOCKQUOTE>
<P>&nbsp; </P>
<TABLE cellSpacing=0 cellPadding=2 width=659 border=1>
<TBODY>
<TR>
<TD vAlign=top width=657><SPAN style="COLOR: rgb(255,0,0)"><STRONG>&#24635;&#32467;&#65292;Ktype&#20197;&#21450;&#25972;&#20010;Kobject&#26426;&#21046;&#30340;&#29702;&#35299;&#12290; <BR></STRONG>Kobject&#30340;&#26680;&#24515;&#21151;&#33021;&#26159;&#65306;&#20445;&#25345;&#19968;&#20010;&#24341;&#29992;&#35745;&#25968;&#65292;&#24403;&#35813;&#35745;&#25968;&#20943;&#20026;0&#26102;&#65292;&#33258;&#21160;&#37322;&#25918;<SPAN style="COLOR: rgb(255,0,0)">&#65288;&#30001;&#26412;&#25991;&#25152;&#35762;&#30340;kobject&#27169;&#22359;&#36127;&#36131;&#65289;</SPAN> Kobject&#25152;&#21344;&#29992;&#30340;meomry&#31354;&#38388;&#12290;&#36825;&#23601;&#20915;&#23450;&#20102;Kobject&#24517;&#39035;&#26159;&#21160;&#24577;&#20998;&#37197;&#30340;&#65288;&#21482;&#26377;&#36825;&#26679;&#25165;&#33021;&#21160;&#24577;&#37322;&#25918;&#65289;&#12290; <BR><BR>&#32780;Kobject&#22823;&#22810;&#25968;&#30340;&#20351;&#29992;&#22330;&#26223;&#65292;&#26159;&#20869;&#23884;&#22312;&#22823;&#22411;&#30340;&#25968;&#25454;&#32467;&#26500;&#20013;&#65288;&#22914;Kset&#12289;device_driver&#31561;&#65289;&#65292;&#22240;&#27492;&#36825;&#20123;&#22823;&#22411;&#30340;&#25968;&#25454;&#32467;&#26500;&#65292;&#20063;&#24517;&#39035;&#26159;&#21160;&#24577;&#20998;&#37197;&#12289;&#21160;&#24577;&#37322;&#25918;&#30340;&#12290;&#37027;&#20040;&#37322;&#25918;&#30340;&#26102;&#26426;&#26159;&#20160;&#20040;&#21602;&#65311;&#26159;&#20869;&#23884;&#30340;Kobject&#37322;&#25918;&#26102;&#12290;&#20294;&#26159;Kobject&#30340;&#37322;&#25918;&#26159;&#30001;Kobject&#27169;&#22359;&#33258;&#21160;&#23436;&#25104;&#30340;&#65288;&#22312;&#24341;&#29992;&#35745;&#25968;&#20026;0&#26102;&#65289;&#65292;&#37027;&#20040;&#24590;&#20040;&#19968;&#24182;&#37322;&#25918;&#21253;&#21547;&#33258;&#24049;&#30340;&#22823;&#22411;&#25968;&#25454;&#32467;&#26500;&#21602;&#65311; <BR><BR>&#36825;&#26102;Ktype&#23601;&#27966;&#19978;&#29992;&#22330;&#20102;&#12290;&#25105;&#20204;&#30693;&#36947;&#65292;Ktype&#20013;&#30340;release&#22238;&#35843;&#20989;&#25968;&#36127;&#36131;&#37322;&#25918;Kobject&#65288;&#29978;&#33267;&#26159;&#21253;&#21547;Kobject&#30340;&#25968;&#25454;&#32467;&#26500;&#65289;&#30340;&#20869;&#23384;&#31354;&#38388;&#65292;&#37027;&#20040;Ktype&#21450;&#20854;&#20869;&#37096;&#20989;&#25968;&#65292;&#26159;&#30001;&#35841;&#23454;&#29616;&#21602;&#65311;&#26159;&#30001;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#25152;&#22312;&#30340;&#27169;&#22359;&#65281;&#22240;&#20026;&#21482;&#26377;&#23427;&#65292;&#25165;&#28165;&#26970;Kobject&#23884;&#22312;&#21738;&#20010;&#25968;&#25454;&#32467;&#26500;&#20013;&#65292;&#24182;&#36890;&#36807;Kobject&#25351;&#38024;&#20197;&#21450;&#33258;&#36523;&#30340;&#25968;&#25454;&#32467;&#26500;&#31867;&#22411;&#65292;&#25214;&#21040;&#38656;&#35201;&#37322;&#25918;&#30340;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#30340;&#25351;&#38024;&#65292;&#28982;&#21518;&#37322;&#25918;&#23427;&#12290; <BR><BR>&#35762;&#21040;&#36825;&#37324;&#65292;&#23601;&#28165;&#26224;&#22810;&#20102;&#12290;&#25152;&#20197;&#65292;&#27599;&#19968;&#20010;&#20869;&#23884;Kobject&#30340;&#25968;&#25454;&#32467;&#26500;&#65292;&#20363;&#22914;kset&#12289;device&#12289;device_driver&#31561;&#31561;&#65292;&#37117;&#35201;&#23454;&#29616;&#19968;&#20010;Ktype&#65292;&#24182;&#23450;&#20041;&#20854;&#20013;&#30340;&#22238;&#35843;&#20989;&#25968;&#12290;&#21516;&#29702;&#65292;sysfs&#30456;&#20851;&#30340;&#25805;&#20316;&#20063;&#19968;&#26679;&#65292;&#24517;&#39035;&#32463;&#36807;ktype&#30340;&#20013;&#36716;&#65292;&#22240;&#20026;sysfs&#30475;&#21040;&#30340;&#26159;Kobject&#65292;&#32780;&#30495;&#27491;&#30340;&#25991;&#20214;&#25805;&#20316;&#30340;&#20027;&#20307;&#65292;&#26159;&#20869;&#23884;Kobject&#30340;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#65281; <BR><BR><BR>&#39034;&#20415;&#25552;&#19968;&#19979;&#65292;Kobject&#26159;&#38754;&#21521;&#23545;&#35937;&#30340;&#24605;&#24819;&#22312;Linux kernel&#20013;&#30340;&#26497;&#33268;&#20307;&#29616;&#65292;&#20294;C&#35821;&#35328;&#30340;&#20248;&#21183;&#21364;&#19981;&#22312;&#36825;&#37324;&#65292;&#25152;&#20197;Linux kernel&#38656;&#35201;&#29992;&#27604;&#36739;&#24039;&#22937;&#65288;&#20063;&#24456;&#21872;&#21990;&#65289;&#30340;&#25163;&#27573;&#21435;&#23454;&#29616;&#65292;</SPAN> </TD></TR></TBODY></TABLE><SPAN style="BACKGROUND-COLOR: rgb(239,239,239)"></SPAN>
<P><BR></P>
<H5>3.3 &#21151;&#33021;&#20998;&#26512; </H5>
<P><STRONG>3.3.1 Kobject&#20351;&#29992;&#27969;&#31243;</STRONG> </P>
<P>Kobject&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#65288;&#26377;&#19968;&#31181;&#20363;&#22806;&#65292;&#19979;&#38754;&#20250;&#35762;&#65289;&#20250;&#23884;&#22312;&#20854;&#23427;&#25968;&#25454;&#32467;&#26500;&#20013;&#20351;&#29992;&#65292;&#20854;&#20351;&#29992;&#27969;&#31243;&#22914;&#19979;&#65306; </P>
<OL>
<LI>&#23450;&#20041;&#19968;&#20010;struct kset&#31867;&#22411;&#30340;&#25351;&#38024;&#65292;&#24182;&#22312;&#21021;&#22987;&#21270;&#26102;&#20026;&#23427;&#20998;&#37197;&#31354;&#38388;&#65292;&#28155;&#21152;&#21040;&#20869;&#26680;&#20013; 
<LI>&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#65292;&#23450;&#20041;&#33258;&#24049;&#25152;&#38656;&#30340;&#25968;&#25454;&#32467;&#26500;&#21407;&#22411;&#65292;&#35813;&#25968;&#25454;&#32467;&#26500;&#20013;&#21253;&#21547;&#26377;Kobject 
<LI>&#23450;&#20041;&#19968;&#20010;&#36866;&#21512;&#33258;&#24049;&#30340;ktype&#65292;&#24182;&#23454;&#29616;&#20854;&#20013;&#22238;&#35843;&#20989;&#25968; 
<LI>&#22312;&#38656;&#35201;&#20351;&#29992;&#21040;&#21253;&#21547;Kobject&#30340;&#25968;&#25454;&#32467;&#26500;&#26102;&#65292;&#21160;&#24577;&#20998;&#37197;&#35813;&#25968;&#25454;&#32467;&#26500;&#65292;&#24182;&#20998;&#37197;Kobject&#31354;&#38388;&#65292;&#28155;&#21152;&#21040;&#20869;&#26680;&#20013; 
<LI>&#27599;&#19968;&#27425;&#24341;&#29992;&#25968;&#25454;&#32467;&#26500;&#26102;&#65292;&#35843;&#29992;kobject_get&#25509;&#21475;&#22686;&#21152;&#24341;&#29992;&#35745;&#25968;&#65307;&#24341;&#29992;&#32467;&#26463;&#26102;&#65292;&#35843;&#29992;kobject_put&#25509;&#21475;&#65292;&#20943;&#23569;&#24341;&#29992;&#35745;&#25968; 
<LI>&#24403;&#24341;&#29992;&#35745;&#25968;&#20943;&#23569;&#20026;0&#26102;&#65292;Kobject&#27169;&#22359;&#35843;&#29992;ktype&#25152;&#25552;&#20379;&#30340;release&#25509;&#21475;&#65292;&#37322;&#25918;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#20197;&#21450;Kobject&#30340;&#20869;&#23384;&#31354;&#38388; </LI></OL>
<P>&nbsp; </P>
<P>&#19978;&#38754;&#26377;&#25552;&#36807;&#65292;&#26377;&#19968;&#31181;&#20363;&#22806;&#65292;Kobject&#19981;&#20877;&#23884;&#22312;&#20854;&#23427;&#25968;&#25454;&#32467;&#26500;&#20013;&#65292;&#21487;&#20197;&#21333;&#29420;&#20351;&#29992;&#65292;&#36825;&#20010;&#20363;&#22806;&#23601;&#26159;&#65306;&#24320;&#21457;&#32773;&#21482;&#38656;&#35201;&#22312;sysfs&#20013;&#21019;&#24314;&#19968;&#20010;&#30446;&#24405;&#65292;&#32780;&#19981;&#38656;&#35201;&#20854;&#23427;&#30340;kset&#12289;ktype&#30340;&#25805;&#20316;&#12290;&#36825;&#26102;&#21487;&#20197;&#30452;&#25509;&#35843;&#29992;kobject_create_and_add&#25509;&#21475;&#65292;&#20998;&#37197;&#19968;&#20010;kobject&#32467;&#26500;&#24182;&#25226;&#23427;&#28155;&#21152;&#21040;kernel&#20013;&#12290; </P>
<P><STRONG>3.3.2 Kobject&#30340;&#20998;&#37197;&#21644;&#37322;&#25918;</STRONG> </P>
<P>&#21069;&#38754;&#35762;&#36807;&#65292;Kobject&#24517;&#39035;&#21160;&#24577;&#20998;&#37197;&#65292;&#32780;&#19981;&#33021;&#38745;&#24577;&#23450;&#20041;&#25110;&#32773;&#20301;&#20110;&#22534;&#26632;&#20043;&#19978;&#65292;&#23427;&#30340;&#20998;&#37197;&#26041;&#27861;&#26377;&#20004;&#31181;&#12290; </P>
<P>1. &#36890;&#36807;kmalloc&#33258;&#34892;&#20998;&#37197;&#65288;&#19968;&#33324;&#26159;&#36319;&#38543;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#20998;&#37197;&#65289;&#65292;&#24182;&#22312;&#21021;&#22987;&#21270;&#21518;&#28155;&#21152;&#21040;kernel&#12290;&#36825;&#31181;&#26041;&#27861;&#28041;&#21450;&#22914;&#19979;&#25509;&#21475;&#65306; </P>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 85 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> kobject_init(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_type *ktype);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> __printf(3, 4) __must_check</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> kobject_add(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *parent,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *fmt, ...);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> __printf(4, 5) __must_check</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> kobject_init_and_add(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_type *ktype, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *parent,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *fmt, ...);</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>kobject_init&#65292;&#21021;&#22987;&#21270;&#36890;&#36807;kmalloc&#31561;&#20869;&#23384;&#20998;&#37197;&#20989;&#25968;&#33719;&#24471;&#30340;struct kobject&#25351;&#38024;&#12290;&#20027;&#35201;&#25191;&#34892;&#36923;&#36753;&#20026;&#65306; </P>
<UL>
<LI>&#30830;&#35748;kobj&#21644;ktype&#19981;&#20026;&#31354; 
<LI>&#22914;&#26524;&#35813;&#25351;&#38024;&#24050;&#32463;&#21021;&#22987;&#21270;&#36807;&#65288;&#21028;&#26029;kobj-&gt;state_initialized&#65289;&#65292;&#25171;&#21360;&#38169;&#35823;&#25552;&#31034;&#21450;&#22534;&#26632;&#20449;&#24687;&#65288;&#20294;&#19981;&#26159;&#33268;&#21629;&#38169;&#35823;&#65292;&#25152;&#20197;&#36824;&#21487;&#20197;&#32487;&#32493;&#65289; 
<LI>&#21021;&#22987;&#21270;kobj&#20869;&#37096;&#30340;&#21442;&#25968;&#65292;&#21253;&#25324;&#24341;&#29992;&#35745;&#25968;&#12289;list&#12289;&#21508;&#31181;&#26631;&#24535;&#31561; 
<LI>&#26681;&#25454;&#36755;&#20837;&#21442;&#25968;&#65292;&#23558;ktype&#25351;&#38024;&#36171;&#20104;kobj-&gt;ktype </LI></UL>
<P>kobject_add&#65292;&#23558;&#21021;&#22987;&#21270;&#23436;&#25104;&#30340;kobject&#28155;&#21152;&#21040;kernel&#20013;&#65292;&#21442;&#25968;&#21253;&#25324;&#38656;&#35201;&#28155;&#21152;&#30340;kobject&#12289;&#35813;kobject&#30340;parent&#65288;&#29992;&#20110;&#24418;&#25104;&#23618;&#27425;&#32467;&#26500;&#65292;&#21487;&#20197;&#20026;&#31354;&#65289;&#12289;&#29992;&#20110;&#25552;&#20379;kobject name&#30340;&#26684;&#24335;&#21270;&#23383;&#31526;&#20018;&#12290;&#20027;&#35201;&#25191;&#34892;&#36923;&#36753;&#20026;&#65306; </P>
<UL>
<LI>&#30830;&#35748;kobj&#19981;&#20026;&#31354;&#65292;&#30830;&#35748;kobj&#24050;&#32463;&#21021;&#22987;&#21270;&#65292;&#21542;&#21017;&#38169;&#35823;&#36864;&#20986; 
<LI>&#35843;&#29992;&#20869;&#37096;&#25509;&#21475;kobject_add_varg&#65292;&#23436;&#25104;&#28155;&#21152;&#25805;&#20316; </LI></UL>
<P>kobject_init_and_add&#65292;&#26159;&#19978;&#38754;&#20004;&#20010;&#25509;&#21475;&#30340;&#32452;&#21512;&#65292;&#19981;&#20877;&#35828;&#26126;&#12290; </P>
<P>==========================&#20869;&#37096;&#25509;&#21475;====================================== </P>
<P>kobject_add_varg&#65292;&#35299;&#26512;&#26684;&#24335;&#21270;&#23383;&#31526;&#20018;&#65292;&#23558;&#32467;&#26524;&#36171;&#20104;kobj-&gt;name&#65292;&#20043;&#21518;&#35843;&#29992;kobject_add_internal&#25509;&#21475;&#65292;&#23436;&#25104;&#30495;&#27491;&#30340;&#28155;&#21152;&#25805;&#20316;&#12290; </P>
<P>kobject_add_internal&#65292;&#23558;kobject&#28155;&#21152;&#21040;kernel&#12290;&#20027;&#35201;&#25191;&#34892;&#36923;&#36753;&#20026;&#65306; </P>
<UL>
<LI>&#26657;&#39564;kobj&#20197;&#21450;kobj-&gt;name&#30340;&#21512;&#27861;&#24615;&#65292;&#33509;&#19981;&#21512;&#27861;&#25171;&#21360;&#38169;&#35823;&#20449;&#24687;&#24182;&#36864;&#20986; 
<LI>&#35843;&#29992;kobject_get&#22686;&#21152;&#35813;kobject&#30340;parent&#30340;&#24341;&#29992;&#35745;&#25968;&#65288;&#22914;&#26524;&#23384;&#22312;parent&#30340;&#35805;&#65289; 
<LI>&#22914;&#26524;&#23384;&#22312;kset&#65288;&#21363;kobj-&gt;kset&#19981;&#20026;&#31354;&#65289;&#65292;&#21017;&#35843;&#29992;kobj_kset_join&#25509;&#21475;&#21152;&#20837;kset&#12290;&#21516;&#26102;&#65292;&#22914;&#26524;&#35813;kobject&#27809;&#26377;parent&#65292;&#21364;&#23384;&#22312;kset&#65292;&#21017;&#23558;&#23427;&#30340;parent&#35774;&#20026;kset&#65288;kset&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;kobject&#65289;&#65292;&#24182;&#22686;&#21152;kset&#30340;&#24341;&#29992;&#35745;&#25968; 
<LI>&#36890;&#36807;create_dir&#25509;&#21475;&#65292;<SPAN style="WHITE-SPACE: normal">&#35843;&#29992;sysfs&#30340;&#30456;&#20851;&#25509;&#21475;&#65292;</SPAN>&#22312;sysfs&#19979;&#21019;&#24314;&#35813;kobject&#23545;&#24212;&#30340;&#30446;&#24405; 
<LI>&#22914;&#26524;&#21019;&#24314;&#22833;&#36133;&#65292;&#25191;&#34892;&#21518;&#32493;&#30340;&#22238;&#28378;&#25805;&#20316;&#65292;&#21542;&#21017;&#23558;kobj-&gt;state_in_sysfs&#32622;&#20026;1 </LI></UL>
<P>kobj_kset_join&#65292;&#36127;&#36131;&#23558;kobj&#21152;&#20837;&#21040;&#23545;&#24212;kset&#30340;&#38142;&#34920;&#20013;&#12290; </P></BLOCKQUOTE>
<P>&#36825;&#31181;&#26041;&#24335;&#20998;&#37197;&#30340;kobject&#65292;&#20250;&#22312;&#24341;&#29992;&#35745;&#25968;&#21464;&#20026;0&#26102;&#65292;&#30001;kobject_put&#35843;&#29992;&#20854;ktype&#30340;release&#25509;&#21475;&#65292;&#37322;&#25918;&#20869;&#23384;&#31354;&#38388;&#65292;&#20855;&#20307;&#21487;&#21442;&#32771;&#21518;&#38754;&#26377;&#20851;kobject_put&#30340;&#35762;&#35299;&#12290; </P>
<P>2. &#20351;&#29992;kobject_create&#21019;&#24314; </P>
<P>Kobject&#27169;&#22359;&#21487;&#20197;&#20351;&#29992;kobject_create&#33258;&#34892;&#20998;&#37197;&#31354;&#38388;&#65292;&#24182;&#20869;&#32622;&#20102;&#19968;&#20010;ktype&#65288;dynamic_kobj_ktype&#65289;&#65292;&#29992;&#20110;&#22312;&#35745;&#25968;&#20026;0&#26159;&#37322;&#25918;&#31354;&#38388;&#12290;&#20195;&#30721;&#22914;&#19979;&#65306; </P>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 96 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject * __must_check kobject_create(<SPAN style="COLOR: rgb(0,0,255)">void</SPAN>);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject * __must_check kobject_create_and_add(<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *name,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *parent);</PRE><!--CRLF--></DIV></DIV>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* lib/kobject.c, line 605 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">static</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> dynamic_kobj_release(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj)</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;pr_debug(<SPAN style="COLOR: rgb(0,96,128)">"kobject: (%p): %s\n"</SPAN>, kobj, __func__);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;kfree(kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> }</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN>&nbsp; </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">static</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_type dynamic_kobj_ktype = {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;.release    = dynamic_kobj_release,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum10 style="COLOR: rgb(96,96,96)"> 10:&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>.sysfs_ops  = &amp;kobj_sysfs_ops,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum11 style="COLOR: rgb(96,96,96)"> 11:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>kobject_create&#65292;&#35813;&#25509;&#21475;&#20026;kobj&#20998;&#37197;&#20869;&#23384;&#31354;&#38388;&#65292;&#24182;&#20197;dynamic_kobj_ktype&#20026;&#21442;&#25968;&#65292;&#35843;&#29992;kobject_init&#25509;&#21475;&#65292;&#23436;&#25104;&#21518;&#32493;&#30340;&#21021;&#22987;&#21270;&#25805;&#20316;&#12290; </P>
<P>kobject_create_and_add&#65292;&#26159;kobject_create&#21644;kobject_add&#30340;&#32452;&#21512;&#65292;&#19981;&#20877;&#35828;&#26126;&#12290; </P>
<P>dynamic_kobj_release&#65292;&#30452;&#25509;&#35843;&#29992;kfree&#37322;&#25918;kobj&#30340;&#31354;&#38388;&#12290; </P></BLOCKQUOTE>
<P><STRONG>3.3.3 Kobject&#24341;&#29992;&#35745;&#25968;&#30340;&#20462;&#25913;</STRONG> </P>
<P>&#36890;&#36807;kobject_get&#21644;kobject_put&#21487;&#20197;&#20462;&#25913;kobject&#30340;&#24341;&#29992;&#35745;&#25968;&#65292;&#24182;&#22312;&#35745;&#25968;&#20026;0&#26102;&#65292;&#35843;&#29992;ktype&#30340;release&#25509;&#21475;&#65292;&#37322;&#25918;&#21344;&#29992;&#31354;&#38388;&#12290; </P>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 103 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobject_get(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> kobject_put(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>kobject_get&#65292;&#35843;&#29992;kref_get&#65292;&#22686;&#21152;&#24341;&#29992;&#35745;&#25968;&#12290; </P>
<P>kobject_put&#65292;&#20197;&#20869;&#37096;&#25509;&#21475;kobject_release&#20026;&#21442;&#25968;&#65292;&#35843;&#29992;kref_put&#12290;kref&#27169;&#22359;&#20250;&#22312;&#24341;&#29992;&#35745;&#25968;&#20026;&#38646;&#26102;&#65292;&#35843;&#29992;kobject_release&#12290; </P>
<P>==========================&#20869;&#37096;&#25509;&#21475;====================================== </P>
<P>kobject_release&#65292;&#36890;&#36807;kref&#32467;&#26500;&#65292;&#33719;&#21462;kobject&#25351;&#38024;&#65292;&#24182;&#35843;&#29992;kobject_cleanup&#25509;&#21475;&#32487;&#32493;&#12290; </P>
<P>kobject_cleanup&#65292;&#36127;&#36131;&#37322;&#25918;kobject&#21344;&#29992;&#30340;&#31354;&#38388;&#65292;&#20027;&#35201;&#25191;&#34892;&#36923;&#36753;&#22914;&#19979;&#65306; </P>
<UL>
<LI>&#26816;&#26597;&#35813;kobject&#26159;&#21542;&#26377;ktype&#65292;&#22914;&#26524;&#27809;&#26377;&#65292;&#25171;&#21360;&#35686;&#21578;&#20449;&#24687; 
<LI>&#22914;&#26524;&#35813;kobject&#21521;&#29992;&#25143;&#31354;&#38388;&#21457;&#36865;&#20102;ADD uevent&#20294;&#27809;&#26377;&#21457;&#36865;REMOVE uevent&#65292;&#34917;&#21457;REMOVE uevent 
<LI>&#22914;&#26524;&#35813;kobject&#26377;&#22312;sysfs&#25991;&#20214;&#31995;&#32479;&#27880;&#20876;&#65292;&#35843;&#29992;kobject_del&#25509;&#21475;&#65292;&#21024;&#38500;&#23427;&#22312;sysfs&#20013;&#30340;&#27880;&#20876; 
<LI>&#35843;&#29992;&#35813;kobject&#30340;ktype&#30340;release&#25509;&#21475;&#65292;&#37322;&#25918;&#20869;&#23384;&#31354;&#38388; 
<LI>&#37322;&#25918;&#35813;kobject&#30340;name&#25152;&#21344;&#29992;&#30340;&#20869;&#23384;&#31354;&#38388; </LI></UL></BLOCKQUOTE>
<P><STRONG>3.3.4 Kset&#30340;&#21021;&#22987;&#21270;&#12289;&#27880;&#20876;</STRONG> </P>
<P>Kset&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;kobject&#65292;&#22240;&#27492;&#20854;&#21021;&#22987;&#21270;&#12289;&#27880;&#20876;&#31561;&#25805;&#20316;&#20063;&#20250;&#35843;&#29992;kobject&#30340;&#30456;&#20851;&#25509;&#21475;&#65292;&#38500;&#27492;&#20043;&#22806;&#65292;&#20250;&#26377;&#23427;&#29305;&#26377;&#30340;&#37096;&#20998;&#12290;&#21478;&#22806;&#65292;&#21644;Kobject&#19968;&#26679;&#65292;kset&#30340;&#20869;&#23384;&#20998;&#37197;&#65292;&#21487;&#20197;&#30001;&#19978;&#23618;&#36719;&#20214;&#36890;&#36807;kmalloc&#33258;&#34892;&#20998;&#37197;&#65292;&#20063;&#21487;&#20197;&#30001;Kobject&#27169;&#22359;&#36127;&#36131;&#20998;&#37197;&#65292;&#20855;&#20307;&#22914;&#19979;&#12290; </P>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 166 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> kset_init(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> __must_check kset_register(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> kset_unregister(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">extern</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset * __must_check kset_create_and_add(<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *name,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset_uevent_ops *u,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *parent_kobj);</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>kset_init&#65292;&#35813;&#25509;&#21475;&#29992;&#20110;&#21021;&#22987;&#21270;&#24050;&#20998;&#37197;&#30340;kset&#65292;&#20027;&#35201;&#21253;&#25324;&#35843;&#29992;kobject_init_internal&#21021;&#22987;&#21270;&#20854;kobject&#65292;&#28982;&#21518;&#21021;&#22987;&#21270;kset&#30340;&#38142;&#34920;&#12290;&#38656;&#35201;&#27880;&#24847;&#30340;&#26102;&#65292;&#22914;&#26524;&#20351;&#29992;&#27492;&#25509;&#21475;&#65292;&#19978;&#23618;&#36719;&#20214;&#24517;&#39035;&#25552;&#20379;&#35813;kset&#20013;&#30340;kobject&#30340;ktype&#12290; </P>
<P>kset_register&#65292;&#20808;&#35843;&#29992;kset_init&#65292;&#28982;&#21518;&#35843;&#29992;kobject_add_internal&#23558;&#20854;kobject&#28155;&#21152;&#21040;kernel&#12290; </P>
<P>kset_unregister&#65292;&#30452;&#25509;&#35843;&#29992;kobject_put&#37322;&#25918;&#20854;kobject&#12290;&#24403;&#20854;kobject&#30340;&#24341;&#29992;&#35745;&#25968;&#20026;0&#26102;&#65292;&#21363;&#35843;&#29992;ktype&#30340;release&#25509;&#21475;&#37322;&#25918;kset&#21344;&#29992;&#30340;&#31354;&#38388;&#12290; </P>
<P>kset_create_and_add&#65292;&#20250;&#35843;&#29992;&#20869;&#37096;&#25509;&#21475;kset_create&#21160;&#24577;&#21019;&#24314;&#19968;&#20010;kset&#65292;&#24182;&#35843;&#29992;kset_register&#23558;&#20854;&#27880;&#20876;&#21040;kernel&#12290; </P>
<P>==========================&#20869;&#37096;&#25509;&#21475;====================================== </P>
<P>kset_create&#65292;&#35813;&#25509;&#21475;&#20351;&#29992;kzalloc&#20998;&#37197;&#19968;&#20010;kset&#31354;&#38388;&#65292;&#24182;&#23450;&#20041;&#19968;&#20010;kset_ktype&#31867;&#22411;&#30340;ktype&#65292;&#29992;&#20110;&#37322;&#25918;&#25152;&#26377;&#30001;&#23427;&#20998;&#37197;&#30340;kset&#31354;&#38388;&#12290; </P></BLOCKQUOTE>
<P><SPAN style="COLOR: rgb(128,128,128)"><EM></EM></SPAN></P>
<P><SPAN style="COLOR: rgb(128,128,128)"><EM>&#21407;&#21019;&#25991;&#31456;&#65292;&#36716;&#21457;&#35831;&#27880;&#26126;&#20986;&#22788;&#12290;&#34583;&#31389;&#31185;&#25216;&#65292;<A href="http://www.wowotech.net/linux_kenrel/kobject.html">www.wowotech.net</A>&#12290;</EM></SPAN>