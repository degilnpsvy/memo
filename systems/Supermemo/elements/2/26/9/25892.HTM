<H2>Linux&#35774;&#22791;&#27169;&#22411;(3)_Uevent</H2>
<P class=date>&#20316;&#32773;&#65306;<A href="http://www.wowotech.net/author/2">&#34583;&#34583;</A> &#21457;&#24067;&#20110;&#65306;2014-3-10 20:39 &#20998;&#31867;&#65306;<A href="http://www.wowotech.net/sort/device_model">&#32479;&#19968;&#35774;&#22791;&#27169;&#22411;</A> </P>
<H4>1. Uevent&#30340;&#21151;&#33021; </H4>
<P>Uevent&#26159;Kobject&#30340;&#19968;&#37096;&#20998;&#65292;&#29992;&#20110;&#22312;Kobject&#29366;&#24577;&#21457;&#29983;&#25913;&#21464;&#26102;&#65292;&#20363;&#22914;&#22686;&#21152;&#12289;&#31227;&#38500;&#31561;&#65292;&#36890;&#30693;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#12290;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#25910;&#21040;&#36825;&#26679;&#30340;&#20107;&#20214;&#21518;&#65292;&#20250;&#20570;&#30456;&#24212;&#30340;&#22788;&#29702;&#12290; </P>
<P>&#35813;&#26426;&#21046;&#36890;&#24120;&#26159;&#29992;&#26469;&#25903;&#25345;&#28909;&#25300;&#25554;&#35774;&#22791;&#30340;&#65292;&#20363;&#22914;U&#30424;&#25554;&#20837;&#21518;&#65292;USB&#30456;&#20851;&#30340;&#39537;&#21160;&#36719;&#20214;&#20250;&#21160;&#24577;&#21019;&#24314;&#29992;&#20110;&#34920;&#31034;&#35813;U&#30424;&#30340;device&#32467;&#26500;&#65288;&#30456;&#24212;&#30340;&#20063;&#21253;&#25324;&#20854;&#20013;&#30340;kobject&#65289;&#65292;&#24182;&#21578;&#30693;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#65292;&#20026;&#35813;U&#30424;&#21160;&#24577;&#30340;&#21019;&#24314;/dev/&#30446;&#24405;&#19979;&#30340;&#35774;&#22791;&#33410;&#28857;&#65292;&#26356;&#36827;&#19968;&#27493;&#65292;&#21487;&#20197;&#36890;&#30693;&#20854;&#23427;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#23558;&#35813;U&#30424;&#35774;&#22791;mount&#21040;&#31995;&#32479;&#20013;&#65292;&#20174;&#32780;&#21160;&#24577;&#30340;&#25903;&#25345;&#35813;&#35774;&#22791;&#12290; </P>
<H4>2. Uevent&#22312;kernel&#20013;&#30340;&#20301;&#32622; </H4>
<P>&#19979;&#38754;&#22270;&#29255;&#25551;&#36848;&#20102;Uevent&#27169;&#22359;&#22312;&#20869;&#26680;&#20013;&#30340;&#20301;&#32622;&#65306; </P>
<P><A href="http://www.wowotech.net/content/uploadfile/201403/272229a8f5b5912c352e857e119e516320140311063951.gif"><IMG title=uevent style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; DISPLAY: inline; BORDER-TOP-WIDTH: 0px" border=0 alt=uevent src="http://www.wowotech.net/content/uploadfile/201403/430b8239af589fedfe6ecffbd26dcbae20140311063954.gif" width=359 height=409></A> </P>
<P>&#30001;&#27492;&#21487;&#30693;&#65292;Uevent&#30340;&#26426;&#21046;&#26159;&#27604;&#36739;&#31616;&#21333;&#30340;&#65292;&#35774;&#22791;&#27169;&#22411;&#20013;&#20219;&#20309;&#35774;&#22791;&#26377;&#20107;&#20214;&#38656;&#35201;&#19978;&#25253;&#26102;&#65292;&#20250;&#35302;&#21457;Uevent&#25552;&#20379;&#30340;&#25509;&#21475;&#12290;Uevent&#27169;&#22359;&#20934;&#22791;&#22909;&#19978;&#25253;&#20107;&#20214;&#30340;&#26684;&#24335;&#21518;&#65292;&#21487;&#20197;&#36890;&#36807;&#20004;&#20010;&#36884;&#24452;&#25226;&#20107;&#20214;&#19978;&#25253;&#21040;&#29992;&#25143;&#31354;&#38388;&#65306;&#19968;&#31181;&#26159;&#36890;&#36807;kmod&#27169;&#22359;&#65292;&#30452;&#25509;&#35843;&#29992;&#29992;&#25143;&#31354;&#38388;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#65307;&#21478;&#19968;&#31181;&#26159;&#36890;&#36807;netlink&#36890;&#20449;&#26426;&#21046;&#65292;&#23558;&#20107;&#20214;&#20174;&#20869;&#26680;&#31354;&#38388;&#20256;&#36882;&#32473;&#29992;&#25143;&#31354;&#38388;&#12290; </P>
<P><SPAN style="COLOR: rgb(255,0,0)">&#27880;1&#65306;&#26377;&#20851;kmod&#21644;netlink&#65292;&#20250;&#22312;&#20854;&#23427;&#25991;&#31456;&#20013;&#25551;&#36848;&#65292;&#22240;&#27492;&#26412;&#25991;&#23601;&#19981;&#20877;&#35814;&#32454;&#35828;&#26126;&#20102;&#12290;</SPAN> </P>
<H4>3. Uevent&#30340;&#20869;&#37096;&#36923;&#36753;&#35299;&#26512; </H4>
<H5>3.1 Source Code&#20301;&#32622; </H5>
<P>Uevent&#30340;&#20195;&#30721;&#27604;&#36739;&#31616;&#21333;&#65292;&#20027;&#35201;&#28041;&#21450;kobject.h&#21644;kobject_uevent.c&#20004;&#20010;&#25991;&#20214;&#65292;&#22914;&#19979;&#65306; </P>
<UL>
<LI>include/linux/kobject.h </LI>
<LI>lib/kobject_uevent.c </LI></UL>
<H5>3.2 &#25968;&#25454;&#32467;&#26500;&#25551;&#36848; </H5>
<P>kobject.h&#23450;&#20041;&#20102;uevent&#30456;&#20851;&#30340;&#24120;&#37327;&#21644;&#25968;&#25454;&#32467;&#26500;&#65292;&#22914;&#19979;&#65306; </P>
<UL>
<LI>kobject_action </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 50 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">enum</SPAN> kobject_action {   </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_ADD,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_REMOVE,    </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_CHANGE, </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_MOVE,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_ONLINE, </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_OFFLINE,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;KOBJ_MAX </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum10 style="COLOR: rgb(96,96,96)"> 10:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<P>kobject_action&#23450;&#20041;&#20102;event&#30340;&#31867;&#22411;&#65292;&#21253;&#25324;&#65306; </P>
<BLOCKQUOTE>
<P>ADD/REMOVE&#65292;Kobject&#65288;&#25110;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#65289;&#30340;&#28155;&#21152;/&#31227;&#38500;&#20107;&#20214;&#12290; </P>
<P>ONLINE/OFFLINE&#65292;Kobject&#65288;&#25110;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#65289;&#30340;&#19978;&#32447;/&#19979;&#32447;&#20107;&#20214;&#65292;&#20854;&#23454;&#26159;&#26159;&#21542;&#20351;&#33021;&#12290; </P>
<P>CHANGE&#65292;Kobject&#65288;&#25110;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#65289;&#30340;&#29366;&#24577;&#25110;&#32773;&#20869;&#23481;&#21457;&#29983;&#25913;&#21464;&#12290; </P>
<P>MOVE&#65292;Kobject&#65288;&#25110;&#19978;&#23618;&#25968;&#25454;&#32467;&#26500;&#65289;&#26356;&#25913;&#21517;&#31216;&#25110;&#32773;&#26356;&#25913;Parent&#65288;&#24847;&#21619;&#30528;&#22312;sysfs&#20013;&#26356;&#25913;&#20102;&#30446;&#24405;&#32467;&#26500;&#65289;&#12290; </P>
<P>CHANGE&#65292;&#22914;&#26524;&#35774;&#22791;&#39537;&#21160;&#38656;&#35201;&#19978;&#25253;&#30340;&#20107;&#20214;&#19981;&#20877;&#19978;&#38754;&#20107;&#20214;&#30340;&#33539;&#22260;&#20869;&#65292;&#25110;&#32773;&#26159;&#33258;&#23450;&#20041;&#30340;&#20107;&#20214;&#65292;&#21487;&#20197;&#20351;&#29992;&#35813;event&#65292;&#24182;&#25658;&#24102;&#30456;&#24212;&#30340;&#21442;&#25968;&#12290; </P></BLOCKQUOTE>
<UL>
<LI>kobj_uevent_env </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 31 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(204,102,51)">#define</SPAN> UEVENT_NUM_ENVP         32 <SPAN style="COLOR: rgb(0,128,0)">/* number of env pointers */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(204,102,51)">#define</SPAN> UEVENT_BUFFER_SIZE      2048 <SPAN style="COLOR: rgb(0,128,0)">/* buffer for the variables */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN>&nbsp; </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 116 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_uevent_env {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *envp[UEVENT_NUM_ENVP];</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">int</SPAN> envp_idx;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">char</SPAN> buf[UEVENT_BUFFER_SIZE];</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum10 style="COLOR: rgb(96,96,96)"> 10:&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: rgb(0,0,255)">int</SPAN> buflen;</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum11 style="COLOR: rgb(96,96,96)"> 11:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<P>&#21069;&#38754;&#26377;&#25552;&#21040;&#36807;&#65292;&#22312;&#21033;&#29992;Kmod&#21521;&#29992;&#25143;&#31354;&#38388;&#19978;&#25253;event&#20107;&#20214;&#26102;&#65292;&#20250;&#30452;&#25509;&#25191;&#34892;&#29992;&#25143;&#31354;&#38388;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#12290;&#32780;&#22312;Linux&#31995;&#32479;&#65292;&#21487;&#25191;&#34892;&#25991;&#20214;&#30340;&#25191;&#34892;&#65292;&#20381;&#36182;&#20110;&#29615;&#22659;&#21464;&#37327;&#65292;&#22240;&#27492;kobj_uevent_env&#29992;&#20110;&#32452;&#32455;&#27492;&#27425;&#20107;&#20214;&#19978;&#25253;&#26102;&#30340;&#29615;&#22659;&#21464;&#37327;&#12290; </P>
<BLOCKQUOTE>
<P>envp&#65292;&#25351;&#38024;&#25968;&#32452;&#65292;&#29992;&#20110;&#20445;&#23384;&#27599;&#20010;&#29615;&#22659;&#21464;&#37327;&#30340;&#22320;&#22336;&#65292;&#26368;&#22810;&#21487;&#25903;&#25345;&#30340;&#29615;&#22659;&#21464;&#37327;&#25968;&#37327;&#20026;UEVENT_NUM_ENVP&#12290; </P>
<P>envp_idx&#65292;&#29992;&#20110;&#35775;&#38382;&#29615;&#22659;&#21464;&#37327;&#25351;&#38024;&#25968;&#32452;&#30340;index&#12290; </P>
<P>buf&#65292;&#20445;&#23384;&#29615;&#22659;&#21464;&#37327;&#30340;buffer&#65292;&#26368;&#22823;&#20026;UEVENT_BUFFER_SIZE&#12290; </P>
<P>buflen&#65292;&#35775;&#38382;buf&#30340;&#21464;&#37327;&#12290; </P></BLOCKQUOTE>
<UL>
<LI>kset_uevent_ops </LI></UL>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 123 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset_uevent_ops {</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">int</SPAN> (* <SPAN style="COLOR: rgb(0,0,255)">const</SPAN> filter)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *(* <SPAN style="COLOR: rgb(0,0,255)">const</SPAN> name)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">int</SPAN> (* <SPAN style="COLOR: rgb(0,0,255)">const</SPAN> uevent)(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kset *kset, <SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_uevent_env *env);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> };</PRE><!--CRLF--></DIV></DIV>
<P>kset_uevent_ops&#26159;&#20026;kset&#37327;&#36523;&#35746;&#20570;&#30340;&#19968;&#20010;&#25968;&#25454;&#32467;&#26500;&#65292;&#37324;&#38754;&#21253;&#21547;filter&#21644;uevent&#20004;&#20010;&#22238;&#35843;&#20989;&#25968;&#65292;&#29992;&#22788;&#22914;&#19979;&#65306; </P>
<BLOCKQUOTE>
<P>filter&#65292;&#24403;&#20219;&#20309;Kobject&#38656;&#35201;&#19978;&#25253;uevent&#26102;&#65292;&#23427;&#25152;&#23646;&#30340;kset&#21487;&#20197;&#36890;&#36807;&#35813;&#25509;&#21475;&#36807;&#28388;&#65292;&#38459;&#27490;&#19981;&#24076;&#26395;&#19978;&#25253;&#30340;event&#65292;&#20174;&#32780;&#36798;&#21040;&#20174;&#25972;&#20307;&#19978;&#31649;&#29702;&#30340;&#30446;&#30340;&#12290; </P>
<P>name&#65292;&#35813;&#25509;&#21475;&#21487;&#20197;&#36820;&#22238;kset&#30340;&#21517;&#31216;&#12290;&#22914;&#26524;&#19968;&#20010;kset&#27809;&#26377;&#21512;&#27861;&#30340;&#21517;&#31216;&#65292;&#21017;&#20854;&#19979;&#30340;&#25152;&#26377;Kobject&#23558;&#19981;&#20801;&#35768;&#19978;&#25253;uvent </P>
<P>uevent&#65292;&#24403;&#20219;&#20309;Kobject&#38656;&#35201;&#19978;&#25253;uevent&#26102;&#65292;&#23427;&#25152;&#23646;&#30340;kset&#21487;&#20197;&#36890;&#36807;&#35813;&#25509;&#21475;&#32479;&#19968;&#20026;&#36825;&#20123;event&#28155;&#21152;&#29615;&#22659;&#21464;&#37327;&#12290;&#22240;&#20026;&#24456;&#22810;&#26102;&#20505;&#19978;&#25253;uevent&#26102;&#30340;&#29615;&#22659;&#21464;&#37327;&#37117;&#26159;&#30456;&#21516;&#30340;&#65292;&#22240;&#27492;&#21487;&#20197;&#30001;kset&#32479;&#19968;&#22788;&#29702;&#65292;&#23601;&#19981;&#38656;&#35201;&#35753;&#27599;&#20010;Kobject&#29420;&#33258;&#28155;&#21152;&#20102;&#12290; </P></BLOCKQUOTE>
<H5>3.3 &#20869;&#37096;&#21160;&#20316; </H5>
<P>&#36890;&#36807;kobject.h&#65292;uevent&#27169;&#22359;&#25552;&#20379;&#20102;&#22914;&#19979;&#30340;API&#65288;&#36825;&#20123;API&#30340;&#23454;&#29616;&#26159;&#22312;"lib/kobject_uevent.c&#8221;&#25991;&#20214;&#20013;&#65289;&#65306; </P>
<DIV id=codeSnippetWrapper style='FONT-FAMILY: "direction:ltr;max-height:200px;font-size:8pt;overflow:auto;border-top:silver 1px solid;cursor:text;border-right:silver 1px solid;padding-top:4px;"; WIDTH: 97.5%; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 4px; TEXT-ALIGN: left; PADDING-LEFT: 4px; MARGIN: 20px 0px 10px; BORDER-LEFT: silver 1px solid; LINE-HEIGHT: 12pt; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(244,244,244)'>
<DIV id=codeSnippet style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum1 style="COLOR: rgb(96,96,96)"> 1:</SPAN> <SPAN style="COLOR: rgb(0,128,0)">/* include/linux/kobject.h, line 206 */</SPAN></PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum2 style="COLOR: rgb(96,96,96)"> 2:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> kobject_uevent(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj, <SPAN style="COLOR: rgb(0,0,255)">enum</SPAN> kobject_action action);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum3 style="COLOR: rgb(96,96,96)"> 3:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> kobject_uevent_env(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobject *kobj, <SPAN style="COLOR: rgb(0,0,255)">enum</SPAN> kobject_action action,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum4 style="COLOR: rgb(96,96,96)"> 4:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *envp[]);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum5 style="COLOR: rgb(96,96,96)"> 5:</SPAN>&nbsp; </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum6 style="COLOR: rgb(96,96,96)"> 6:</SPAN> __printf(2, 3)</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum7 style="COLOR: rgb(96,96,96)"> 7:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> add_uevent_var(<SPAN style="COLOR: rgb(0,0,255)">struct</SPAN> kobj_uevent_env *env, <SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *format, ...);</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum8 style="COLOR: rgb(96,96,96)"> 8:</SPAN>&nbsp; </PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: white'><SPAN id=lnum9 style="COLOR: rgb(96,96,96)"> 9:</SPAN> <SPAN style="COLOR: rgb(0,0,255)">int</SPAN> kobject_action_type(<SPAN style="COLOR: rgb(0,0,255)">const</SPAN> <SPAN style="COLOR: rgb(0,0,255)">char</SPAN> *buf, size_t count,</PRE><!--CRLF--><PRE style='FONT-FAMILY: "direction:ltr;border-top-style:none;color:black;font-size:8pt;border-left-style:none;overflow:visible;padding-top:0px;"; WIDTH: 100%; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0px; TEXT-ALIGN: left; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0px; MARGIN: 0em; LINE-HEIGHT: 12pt; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(244,244,244)'><SPAN id=lnum10 style="COLOR: rgb(96,96,96)"> 10:</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: rgb(0,0,255)">enum</SPAN> kobject_action *type);</PRE><!--CRLF--></DIV></DIV>
<BLOCKQUOTE>
<P>kobject_uevent_env&#65292;&#20197;envp&#20026;&#29615;&#22659;&#21464;&#37327;&#65292;&#19978;&#25253;&#19968;&#20010;&#25351;&#23450;action&#30340;uevent&#12290;&#29615;&#22659;&#21464;&#37327;&#30340;&#20316;&#29992;&#26159;&#20026;&#25191;&#34892;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#25351;&#23450;&#36816;&#34892;&#29615;&#22659;&#12290;&#20855;&#20307;&#21160;&#20316;&#22914;&#19979;&#65306; </P>
<UL>
<LI>&#26597;&#25214;kobj&#26412;&#36523;&#25110;&#32773;&#20854;parent&#26159;&#21542;&#20174;&#23646;&#20110;&#26576;&#20010;kset&#65292;&#22914;&#26524;&#19981;&#26159;&#65292;&#21017;&#25253;&#38169;&#36820;&#22238;&#65288;<SPAN style="COLOR: rgb(255,0,0)">&#27880;2&#65306;&#30001;&#27492;&#21487;&#20197;&#35828;&#26126;&#65292;&#22914;&#26524;&#19968;&#20010;kobject&#27809;&#26377;&#21152;&#20837;kset&#65292;&#26159;&#19981;&#20801;&#35768;&#19978;&#25253;uevent&#30340;</SPAN>&#65289; </LI>
<LI>&#26597;&#30475;kobj-&gt;uevent_suppress&#26159;&#21542;&#35774;&#32622;&#65292;&#22914;&#26524;&#35774;&#32622;&#65292;&#21017;&#24573;&#30053;&#25152;&#26377;&#30340;uevent&#19978;&#25253;&#24182;&#36820;&#22238;&#65288;<SPAN style="COLOR: rgb(255,0,0)">&#27880;3&#65306;&#30001;&#27492;&#21487;&#30693;&#65292;&#21487;&#20197;&#36890;&#36807;Kobject&#30340;uevent_suppress&#26631;&#24535;&#65292;&#31649;&#25511;Kobject&#30340;uevent&#30340;&#19978;&#25253;</SPAN>&#65289; </LI>
<LI>&#22914;&#26524;&#25152;&#23646;&#30340;kset&#26377;uevent_ops-&gt;filter&#20989;&#25968;&#65292;&#21017;&#35843;&#29992;&#35813;&#20989;&#25968;&#65292;&#36807;&#28388;&#27492;&#27425;&#19978;&#25253;&#65288;<SPAN style="COLOR: rgb(255,0,0)">&#27880;4&#65306;&#36825;&#20304;&#35777;&#20102;3.2&#23567;&#33410;&#26377;&#20851;filter&#25509;&#21475;&#30340;&#35828;&#26126;&#65292;kset&#21487;&#20197;&#36890;&#36807;filter&#25509;&#21475;&#36807;&#28388;&#19981;&#24076;&#26395;&#19978;&#25253;&#30340;event&#65292;&#20174;&#32780;&#36798;&#21040;&#25972;&#20307;&#30340;&#31649;&#29702;&#25928;&#26524;</SPAN>&#65289; </LI>
<LI>&#21028;&#26029;&#25152;&#23646;&#30340;kset&#26159;&#21542;&#26377;&#21512;&#27861;&#30340;&#21517;&#31216;&#65288;&#31216;&#20316;subsystem&#65292;&#21644;&#21069;&#26399;&#30340;&#20869;&#26680;&#29256;&#26412;&#26377;&#21306;&#21035;&#65289;&#65292;&#21542;&#21017;&#19981;&#20801;&#35768;&#19978;&#25253;uevent </LI>
<LI>&#20998;&#37197;&#19968;&#20010;&#29992;&#20110;&#27492;&#27425;&#19978;&#25253;&#30340;&#12289;&#23384;&#20648;&#29615;&#22659;&#21464;&#37327;&#30340;buffer&#65288;&#32467;&#26524;&#20445;&#23384;&#22312;env&#25351;&#38024;&#20013;&#65289;&#65292;&#24182;&#33719;&#24471;&#35813;Kobject&#22312;sysfs&#20013;&#36335;&#24452;&#20449;&#24687;&#65288;&#29992;&#25143;&#31354;&#38388;&#36719;&#20214;&#38656;&#35201;&#20381;&#25454;&#35813;&#36335;&#24452;&#20449;&#24687;&#22312;sysfs&#20013;&#35775;&#38382;&#23427;&#65289; </LI>
<LI>&#35843;&#29992;add_uevent_var&#25509;&#21475;&#65288;&#19979;&#38754;&#20250;&#20171;&#32461;&#65289;&#65292;&#23558;Action&#12289;&#36335;&#24452;&#20449;&#24687;&#12289;subsystem&#31561;&#20449;&#24687;&#65292;&#28155;&#21152;&#21040;env&#25351;&#38024;&#20013; </LI>
<LI>&#22914;&#26524;&#20256;&#20837;&#30340;envp&#19981;&#31354;&#65292;&#21017;&#35299;&#26512;&#20256;&#20837;&#30340;&#29615;&#22659;&#21464;&#37327;&#20013;&#65292;&#21516;&#26679;&#35843;&#29992;add_uevent_var&#25509;&#21475;&#65292;&#28155;&#21152;&#21040;env&#25351;&#38024;&#20013; </LI>
<LI>&#22914;&#26524;&#25152;&#23646;&#30340;kset&#23384;&#22312;uevent_ops-&gt;uevent&#25509;&#21475;&#65292;&#35843;&#29992;&#35813;&#25509;&#21475;&#65292;&#28155;&#21152;kset&#32479;&#19968;&#30340;&#29615;&#22659;&#21464;&#37327;&#21040;env&#25351;&#38024; </LI>
<LI>&#26681;&#25454;ACTION&#30340;&#31867;&#22411;&#65292;&#35774;&#32622;kobj-&gt;state_add_uevent_sent&#21644;kobj-&gt;state_remove_uevent_sent&#21464;&#37327;&#65292;&#20197;&#35760;&#24405;&#27491;&#30830;&#30340;&#29366;&#24577; </LI>
<LI>&#35843;&#29992;add_uevent_var&#25509;&#21475;&#65292;&#28155;&#21152;&#26684;&#24335;&#20026;"SEQNUM=%llu&#8221;&#30340;&#24207;&#21015;&#21495; </LI>
<LI>&#22914;&#26524;&#23450;&#20041;&#20102;"CONFIG_NET&#8221;&#65292;&#21017;&#20351;&#29992;netlink&#21457;&#36865;&#35813;uevent </LI>
<LI>&#20197;uevent_helper&#12289;subsystem&#20197;&#21450;&#28155;&#21152;&#20102;&#26631;&#20934;&#29615;&#22659;&#21464;&#37327;&#65288;HOME=/&#65292;PATH=/sbin:/bin:/usr/sbin:/usr/bin&#65289;&#30340;env&#25351;&#38024;&#20026;&#21442;&#25968;&#65292;&#35843;&#29992;kmod&#27169;&#22359;&#25552;&#20379;&#30340;call_usermodehelper&#20989;&#25968;&#65292;&#19978;&#25253;uevent&#12290; <BR>&#20854;&#20013;uevent_helper&#30340;&#20869;&#23481;&#26159;&#30001;&#20869;&#26680;&#37197;&#32622;&#39033;CONFIG_UEVENT_HELPER_PATH(&#20301;&#20110;./drivers/base/Kconfig)&#20915;&#23450;&#30340;(&#21487;&#21442;&#32771;lib/kobject_uevent.c, line 32)&#65292;&#35813;&#37197;&#32622;&#39033;&#25351;&#23450;&#20102;&#19968;&#20010;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#65288;&#25110;&#32773;&#33050;&#26412;&#65289;&#65292;&#29992;&#20110;&#35299;&#26512;&#19978;&#25253;&#30340;uevent&#65292;&#20363;&#22914;"/sbin/hotplug&#8221;&#12290; <BR>call_usermodehelper&#30340;&#20316;&#29992;&#65292;&#23601;&#26159;fork&#19968;&#20010;&#36827;&#31243;&#65292;&#20197;uevent&#20026;&#21442;&#25968;&#65292;&#25191;&#34892;uevent_helper&#12290; </LI></UL>
<P>kobject_uevent&#65292;&#21644;kobject_uevent_env&#21151;&#33021;&#19968;&#26679;&#65292;&#21482;&#26159;&#27809;&#26377;&#25351;&#23450;&#20219;&#20309;&#30340;&#29615;&#22659;&#21464;&#37327;&#12290; </P>
<P>add_uevent_var&#65292;&#20197;&#26684;&#24335;&#21270;&#23383;&#31526;&#30340;&#24418;&#24335;&#65288;&#31867;&#20284;printf&#12289;printk&#31561;&#65289;&#65292;&#23558;&#29615;&#22659;&#21464;&#37327;copy&#21040;env&#25351;&#38024;&#20013;&#12290; </P>
<P>kobject_action_type&#65292;&#23558;enum kobject_action&#31867;&#22411;&#30340;Action&#65292;&#36716;&#25442;&#20026;&#23383;&#31526;&#20018;&#12290; </P></BLOCKQUOTE>
<P>&nbsp; </P>
<TABLE cellSpacing=0 cellPadding=2 width=658 border=1>
<TBODY>
<TR>
<TD vAlign=top width=656><STRONG>&#35828;&#26126;&#65306;&#24590;&#20040;&#25351;&#23450;&#22788;&#29702;uevent&#30340;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;(&#31616;&#31216;uevent helper)&#65311; <BR><BR>&#19978;&#38754;&#20171;&#32461;kobject_uevent_env&#30340;&#20869;&#37096;&#21160;&#20316;&#26102;&#65292;&#26377;&#25552;&#21040;&#65292;Uevent&#27169;&#22359;&#36890;&#36807;Kmod&#19978;&#25253;Uevent&#26102;&#65292;&#20250;&#36890;&#36807;call_usermodehelper&#20989;&#25968;&#65292;&#35843;&#29992;&#29992;&#25143;&#31354;&#38388;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#65288;&#25110;&#32773;&#33050;&#26412;&#65292;&#31616;&#31216;<STRONG>uevent helper</STRONG> &#65289;&#22788;&#29702;&#35813;event&#12290;&#32780;&#35813;uevent helper&#30340;&#36335;&#24452;&#20445;&#23384;&#22312;<STRONG>uevent_helper&#25968;&#32452;&#20013;&#12290; <BR><BR>&#21487;&#20197;&#22312;&#32534;&#35793;&#20869;&#26680;&#26102;&#65292;&#36890;&#36807;CONFIG_UEVENT_HELPER_PATH&#37197;&#32622;&#39033;&#65292;&#38745;&#24577;&#25351;&#23450;uevent helper&#12290;&#20294;&#36825;&#31181;&#26041;&#24335;&#20250;&#20026;&#27599;&#20010;event fork&#19968;&#20010;&#36827;&#31243;&#65292;&#38543;&#30528;&#20869;&#26680;&#25903;&#25345;&#30340;&#35774;&#22791;&#25968;&#37327;&#30340;&#22686;&#22810;&#65292;&#36825;&#31181;&#26041;&#24335;&#22312;&#31995;&#32479;&#21551;&#21160;&#26102;&#23558;&#20250;&#26159;&#33268;&#21629;&#30340;&#65288;&#21487;&#20197;&#23548;&#33268;&#20869;&#23384;&#28322;&#20986;&#31561;&#65289;&#12290;&#22240;&#27492;&#21482;&#26377;&#22312;&#26089;&#26399;&#30340;&#20869;&#26680;&#29256;&#26412;&#20013;&#20250;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#29616;&#22312;&#20869;&#26680;&#19981;&#20877;&#25512;&#33616;&#20351;&#29992;&#35813;&#26041;&#24335;&#12290;&#22240;&#27492;&#20869;&#26680;&#32534;&#35793;&#26102;&#65292;&#38656;&#35201;&#25226;&#35813;&#37197;&#32622;&#39033;&#30041;&#31354;&#12290; <BR><BR>&#22312;&#31995;&#32479;&#21551;&#21160;&#21518;&#65292;&#22823;&#37096;&#20998;&#30340;&#35774;&#22791;&#24050;&#32463;ready&#65292;&#21487;&#20197;&#26681;&#25454;&#38656;&#35201;&#65292;&#37325;&#26032;&#25351;&#23450;&#19968;&#20010;uevent helper&#65292;&#20197;&#20415;&#26816;&#27979;&#31995;&#32479;&#36816;&#34892;&#36807;&#31243;&#20013;&#30340;&#28909;&#25300;&#25554;&#20107;&#20214;&#12290;&#36825;&#21487;&#20197;&#36890;&#36807;&#25226;helper&#30340;&#36335;&#24452;&#20889;&#20837;&#21040;"/sys/kernel/uevent_helper&#8221;&#25991;&#20214;&#20013;&#23454;&#29616;&#12290;&#23454;&#38469;&#19978;&#65292;&#20869;&#26680;&#36890;&#36807;sysfs&#25991;&#20214;&#31995;&#32479;&#30340;&#24418;&#24335;&#65292;&#23558;<STRONG><STRONG>uevent_helper&#25968;&#32452;&#24320;&#25918;&#21040;&#29992;&#25143;&#31354;&#38388;&#65292;&#20379;&#29992;&#25143;&#31354;&#38388;&#31243;&#24207;&#20462;&#25913;&#35775;&#38382;&#65292;&#20855;&#20307;&#21487;&#21442;&#32771;"</STRONG></STRONG>./kernel/ksysfs.c&#8221;&#20013;&#30456;&#24212;&#30340;&#20195;&#30721;&#65292;&#36825;&#37324;&#19981;&#20877;&#35814;&#32454;&#25551;&#36848;&#12290;</STRONG></STRONG> </TD></TR></TBODY></TABLE>
<P>&nbsp; </P>
<P><SPAN style="COLOR: rgb(128,128,128)"><EM>&#21407;&#21019;&#25991;&#31456;&#65292;&#36716;&#21457;&#35831;&#27880;&#26126;&#20986;&#22788;&#12290;&#34583;&#31389;&#31185;&#25216;&#65292;<A href="http://www.wowotech.net/linux_kenrel/uevent.html">www.wowotech.net</A>&#12290;</EM></SPAN>