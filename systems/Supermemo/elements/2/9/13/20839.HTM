=== 5 Kbuild clean infrastructure 
<P><FONT class=extract>"make clean" deletes most generated files in the obj tree where the kernel<BR>is compiled. This includes generated files such as host programs.<BR>Kbuild knows targets listed in $(hostprogs-y), $(hostprogs-m), $(always),<BR>$(extra-y) and $(targets). They are all deleted during "make clean".<BR>Files matching the patterns "*.[oas]", "*.ko", plus some additional files<BR>generated by kbuild are deleted all over the kernel src tree when<BR>"make clean" is executed.</FONT></P>
<P><FONT class=extract>Additional files can be specified in kbuild makefiles by use of $(clean-files).</FONT></P>
<P><FONT class=extract>&nbsp;Example:<BR>&nbsp;&nbsp;#drivers/pci/Makefile<BR>&nbsp;&nbsp;clean-files := devlist.h classlist.h</FONT></P>
<P><FONT class=extract>When executing "make clean", the two files "devlist.h classlist.h" will<BR>be deleted. Kbuild will assume files to be in same relative directory as the<BR>Makefile except if an absolute path is specified (path starting with '/').</FONT></P>
<P><FONT class=extract>To delete a directory hierarchy use:</FONT></P>
<P><FONT class=extract>&nbsp;Example:<BR>&nbsp;&nbsp;#scripts/package/Makefile<BR>&nbsp;&nbsp;clean-dirs := $(objtree)/debian/</FONT></P>
<P><FONT class=extract>This will delete the directory debian, including all subdirectories.<BR>Kbuild will assume the directories to be in the same relative path as the<BR>Makefile if no absolute path is specified (path does not start with '/').</FONT></P>
<P><FONT class=extract>To exclude certain files from make clean, use the $(no-clean-files) variable.<BR>This is only a special case used in the top level Kbuild file:</FONT></P>
<P><FONT class=extract>&nbsp;Example:<BR>&nbsp;&nbsp;#Kbuild<BR>&nbsp;&nbsp;no-clean-files := $(bounds-file) $(offsets-file)</FONT></P>
<P><FONT class=extract>Usually kbuild descends down in subdirectories due to "obj-* := dir/",<BR>but in the architecture makefiles where the kbuild infrastructure<BR>is not sufficient this sometimes needs to be explicit.</FONT></P>
<P><FONT class=extract>&nbsp;Example:<BR>&nbsp;&nbsp;#arch/x86/boot/Makefile<BR>&nbsp;&nbsp;subdir- := compressed/</FONT></P>
<P><FONT class=extract>The above assignment instructs kbuild to descend down in the<BR>directory compressed/ when "make clean" is executed.</FONT></P>
<P><FONT class=extract>To support the clean infrastructure in the Makefiles that builds the<BR>final bootimage there is an optional target named archclean:</FONT></P>
<P><FONT class=extract>&nbsp;Example:<BR>&nbsp;&nbsp;#arch/x86/Makefile<BR>&nbsp;&nbsp;archclean:<BR>&nbsp;&nbsp;&nbsp;$(Q)$(MAKE) $(clean)=arch/x86/boot</FONT></P>
<P><FONT class=extract>When "make clean" is executed, make will descend down in arch/x86/boot,<BR>and clean as usual. The Makefile located in arch/x86/boot/ may use<BR>the subdir- trick to descend further down.</FONT></P>
<P><FONT class=extract>Note 1: arch/$(ARCH)/Makefile cannot use "subdir-", because that file is<BR>included in the top level makefile, and the kbuild infrastructure<BR>is not operational at that point.</FONT></P>
<P><FONT class=extract>Note 2: All directories listed in core-y, libs-y, drivers-y and net-y will<BR>be visited during "make clean".</FONT>