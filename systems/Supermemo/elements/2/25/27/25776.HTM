<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 22pt; FONT-FAMILY: 'Myriad-CnSemibold','sans-serif'; mso-bidi-font-size: 15.0pt; mso-bidi-font-family: Myriad-CnSemibold; mso-font-kerning: 0pt; mso-fareast-font-family: Birka">Remove a Driver</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">Removing a driver is a very simple action. For a PCI driver, the driver calls the </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">pci_unregister_driver </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">function. This function merely calls the driver core function </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka-Italic; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt">driver_unregister</SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">, with a pointer to the </SPAN><SPAN lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: TheSansMonoCondensed-SemiLight; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt">struct device_driver </SPAN><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">portion of the </SPAN><SPAN lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: TheSansMonoCondensed-SemiLight; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt">struct pci_driver </SPAN><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt">structure passed to it.</SPAN></FONT></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt"></SPAN></FONT>&nbsp;</P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: Birka; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt"><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1263" name=L1263><SPAN class=lit>1263</SPAN></A><SPAN class=pln> </SPAN><B><I><SPAN class=com>/**</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1264" name=L1264><SPAN class=com>1264</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * pci_unregister_driver - unregister a pci driver</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1265" name=L1265><SPAN class=com>1265</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * @drv: the driver structure to unregister</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1266" name=L1266><SPAN class=com>1266</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> *</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1267" name=L1267><SPAN class=com>1267</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * Deletes the driver structure from the list of registered PCI drivers,</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1268" name=L1268><SPAN class=com>1268</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * gives it a chance to clean up by calling its remove() function for</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1269" name=L1269><SPAN class=com>1269</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * each device it was responsible for, and marks those devices as</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1270" name=L1270><SPAN class=com>1270</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * driverless.</SPAN></I></B><SPAN class=com><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1271" name=L1271><SPAN class=com>1271</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> */</SPAN></I></B><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1272" name=L1272><SPAN class=lit>1272</SPAN></A><SPAN class=pln> <BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1273" name=L1273><SPAN class=lit>1273</SPAN></A><SPAN class=pln> </SPAN><SPAN class=kwd>void</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=pci_unregister_driver"><SPAN class=pln>pci_unregister_driver</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=pci_driver"><SPAN class=pln>pci_driver</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1274" name=L1274><SPAN class=lit>1274</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1275" name=L1275><SPAN class=lit>1275</SPAN></A><SPAN class=pln>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_unregister"><SPAN class=pln>driver_unregister</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=driver"><SPAN class=pln>driver</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1276" name=L1276><SPAN class=lit>1276</SPAN></A><SPAN class=pln>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><A href="http://lxr.oss.org.cn/ident?i=pci_free_dynids"><SPAN class=pln>pci_free_dynids</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1277" name=L1277><SPAN class=lit>1277</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln><BR></SPAN><A href="http://lxr.oss.org.cn/source/drivers/pci/pci-driver.c#L1278" name=L1278><SPAN class=lit>1278</SPAN></A><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=EXPORT_SYMBOL"><SPAN class=pln>EXPORT_SYMBOL</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=pci_unregister_driver"><SPAN class=pln>pci_unregister_driver</SPAN></A><SPAN class=pun>);</SPAN></P><PRE class="prettyprint lang-c"><SPAN class=pun></SPAN><SPAN class=pln><PRE class="prettyprint lang-c"><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L182" name=L182><SPAN class=lit>182</SPAN></A><SPAN class=pln> </SPAN><B><I><SPAN class=com>/**</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L183" name=L183><SPAN class=com>183</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * driver_unregister - remove driver from system.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L184" name=L184><SPAN class=com>184</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * @drv: driver.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L185" name=L185><SPAN class=com>185</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> *</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L186" name=L186><SPAN class=com>186</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * Again, we pass off most of the work to the bus-level call.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L187" name=L187><SPAN class=com>187</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> */</SPAN></I></B><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L188" name=L188><SPAN class=lit>188</SPAN></A><SPAN class=pln> </SPAN><SPAN class=kwd>void</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_unregister"><SPAN class=pln>driver_unregister</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_driver"><SPAN class=pln>device_driver</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L189" name=L189><SPAN class=lit>189</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L190" name=L190><SPAN class=lit>190</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN><SPAN class=pln>drv </SPAN><SPAN class=pun>||</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>!</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>)</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L191" name=L191><SPAN class=lit>191</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=WARN"><SPAN class=pln>WARN</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=lit>1</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN><I><SPAN class=str>"Unexpected driver unregister!\n"</SPAN></I><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L192" name=L192><SPAN class=lit>192</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L193" name=L193><SPAN class=lit>193</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L194" name=L194><SPAN class=lit>194</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_remove_groups"><SPAN class=pln>driver_remove_groups</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> drv</SPAN><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>groups</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L195" name=L195><SPAN class=lit>195</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=bus_remove_driver"><SPAN class=pln>bus_remove_driver</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L196" name=L196><SPAN class=lit>196</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/driver.c#L197" name=L197><SPAN class=lit>197</SPAN></A><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=EXPORT_SYMBOL_GPL"><SPAN class=pln>EXPORT_SYMBOL_GPL</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_unregister"><SPAN class=pln>driver_unregister</SPAN></A><SPAN class=pun>);</SPAN></PRE><PRE class="prettyprint lang-c"><SPAN class=pun></SPAN><SPAN class=pln><PRE class="prettyprint lang-c">&nbsp;</PRE><PRE class="prettyprint lang-c"><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L747" name=L747><SPAN class=lit>747</SPAN></A><SPAN class=pln> </SPAN><B><I><SPAN class=com>/**</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L748" name=L748><SPAN class=com>748</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * bus_remove_driver - delete driver from bus's knowledge.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L749" name=L749><SPAN class=com>749</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * @drv: driver.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L750" name=L750><SPAN class=com>750</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> *</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L751" name=L751><SPAN class=com>751</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * Detach the driver from the devices it controls, and remove</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L752" name=L752><SPAN class=com>752</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * it from its bus's list of drivers. Finally, we drop the reference</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L753" name=L753><SPAN class=com>753</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * to the bus we took in bus_add_driver().</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L754" name=L754><SPAN class=com>754</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> */</SPAN></I></B><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L755" name=L755><SPAN class=lit>755</SPAN></A><SPAN class=pln> </SPAN><SPAN class=kwd>void</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=bus_remove_driver"><SPAN class=pln>bus_remove_driver</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_driver"><SPAN class=pln>device_driver</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L756" name=L756><SPAN class=lit>756</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L757" name=L757><SPAN class=lit>757</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=bus"><SPAN class=pln>bus</SPAN></A><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L758" name=L758><SPAN class=lit>758</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>return</SPAN><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L759" name=L759><SPAN class=lit>759</SPAN></A><SPAN class=pln> 
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L760" name=L760><SPAN class=lit>760</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(!</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>suppress_bind_attrs</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L761" name=L761><SPAN class=lit>761</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=remove_bind_files"><SPAN class=pln>remove_bind_files</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L762" name=L762><SPAN class=lit>762</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_remove_groups"><SPAN class=pln>driver_remove_groups</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=bus"><SPAN class=pln>bus</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>drv_groups</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L763" name=L763><SPAN class=lit>763</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_remove_file"><SPAN class=pln>driver_remove_file</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>&amp;</SPAN><SPAN class=pln>driver_attr_uevent</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L764" name=L764><SPAN class=lit>764</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=klist_remove"><SPAN class=pln>klist_remove</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>knode_bus</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L765" name=L765><SPAN class=lit>765</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=pr_debug"><SPAN class=pln>pr_debug</SPAN></A><SPAN class=pun>(</SPAN><I><SPAN class=str>"bus: '%s': remove driver %s\n"</SPAN></I><SPAN class=pun>,</SPAN><SPAN class=pln> drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=bus"><SPAN class=pln>bus</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=name"><SPAN class=pln>name</SPAN></A><SPAN class=pun>,</SPAN><SPAN class=pln> drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=name"><SPAN class=pln>name</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L766" name=L766><SPAN class=lit>766</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_detach"><SPAN class=pln>driver_detach</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L767" name=L767><SPAN class=lit>767</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=module_remove_driver"><SPAN class=pln>module_remove_driver</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L768" name=L768><SPAN class=lit>768</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=kobject_put"><SPAN class=pln>kobject_put</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=kobj"><SPAN class=pln>kobj</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L769" name=L769><SPAN class=lit>769</SPAN></A><SPAN class=pln>         </SPAN><A href="http://lxr.oss.org.cn/ident?i=bus_put"><SPAN class=pln>bus_put</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=bus"><SPAN class=pln>bus</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/bus.c#L770" name=L770><SPAN class=lit>770</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>}</SPAN></PRE><PRE class="prettyprint lang-c"><SPAN class=pun></SPAN>&nbsp;</PRE><PRE class="prettyprint lang-c"><SPAN class=pun></SPAN><SPAN class=pln><PRE class="prettyprint lang-c"><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L698" name=L698><SPAN class=lit>698</SPAN></A><SPAN class=pln> </SPAN><B><I><SPAN class=com>/**</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L699" name=L699><SPAN class=com>699</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * driver_detach - detach driver from all devices it controls.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L700" name=L700><SPAN class=com>700</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> * @drv: driver.</SPAN></I></B><SPAN class=com>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L701" name=L701><SPAN class=com>701</SPAN></A><SPAN class=com> </SPAN><B><I><SPAN class=com> */</SPAN></I></B><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L702" name=L702><SPAN class=lit>702</SPAN></A><SPAN class=pln> </SPAN><SPAN class=kwd>void</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=driver_detach"><SPAN class=pln>driver_detach</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_driver"><SPAN class=pln>device_driver</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L703" name=L703><SPAN class=lit>703</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L704" name=L704><SPAN class=lit>704</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_private"><SPAN class=pln>device_private</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><SPAN class=pln>dev_prv</SPAN><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L705" name=L705><SPAN class=lit>705</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device"><SPAN class=pln>device</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>*</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L706" name=L706><SPAN class=lit>706</SPAN></A><SPAN class=pln> 
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L707" name=L707><SPAN class=lit>707</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=kwd>for</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(;;)</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L708" name=L708><SPAN class=lit>708</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=spin_lock"><SPAN class=pln>spin_lock</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>.</SPAN><A href="http://lxr.oss.org.cn/ident?i=k_lock"><SPAN class=pln>k_lock</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L709" name=L709><SPAN class=lit>709</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=list_empty"><SPAN class=typ>list</SPAN><SPAN class=pln>_empty</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>.</SPAN><SPAN class=pln>k_list</SPAN><SPAN class=pun>))</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>{</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L710" name=L710><SPAN class=lit>710</SPAN></A><SPAN class=pln>                         </SPAN><A href="http://lxr.oss.org.cn/ident?i=spin_unlock"><SPAN class=pln>spin_unlock</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>.</SPAN><A href="http://lxr.oss.org.cn/ident?i=k_lock"><SPAN class=pln>k_lock</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L711" name=L711><SPAN class=lit>711</SPAN></A><SPAN class=pln>                         </SPAN><SPAN class=kwd>break</SPAN><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L712" name=L712><SPAN class=lit>712</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L713" name=L713><SPAN class=lit>713</SPAN></A><SPAN class=pln>                 dev_prv </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=list_entry"><SPAN class=typ>list</SPAN><SPAN class=pln>_entry</SPAN></A><SPAN class=pun>(</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>.</SPAN><SPAN class=pln>k_list</SPAN><SPAN class=pun>.</SPAN><SPAN class=pln>prev</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L714" name=L714><SPAN class=lit>714</SPAN></A><SPAN class=pln>                                      </SPAN><SPAN class=kwd>struct</SPAN><SPAN class=pln> </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_private"><SPAN class=pln>device_private</SPAN></A><SPAN class=pun>,</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L715" name=L715><SPAN class=lit>715</SPAN></A><SPAN class=pln>                                      knode_driver</SPAN><SPAN class=pun>.</SPAN><SPAN class=pln>n_node</SPAN><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L716" name=L716><SPAN class=lit>716</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>=</SPAN><SPAN class=pln> dev_prv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=device"><SPAN class=pln>device</SPAN></A><SPAN class=pun>;</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L717" name=L717><SPAN class=lit>717</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=get_device"><SPAN class=pln>get_device</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L718" name=L718><SPAN class=lit>718</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=spin_unlock"><SPAN class=pln>spin_unlock</SPAN></A><SPAN class=pun>(&amp;</SPAN><SPAN class=pln>drv</SPAN><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=p"><SPAN class=pln>p</SPAN></A><SPAN class=pun>-&gt;</SPAN><SPAN class=pln>klist_devices</SPAN><SPAN class=pun>.</SPAN><A href="http://lxr.oss.org.cn/ident?i=k_lock"><SPAN class=pln>k_lock</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L719" name=L719><SPAN class=lit>719</SPAN></A><SPAN class=pln> 
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L720" name=L720><SPAN class=lit>720</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=parent"><SPAN class=pln>parent</SPAN></A><SPAN class=pun>)</SPAN><SPAN class=pln>        </SPAN><B><I><SPAN class=com>/* Needed for USB */</SPAN></I></B><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L721" name=L721><SPAN class=lit>721</SPAN></A><SPAN class=pln>                         </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_lock"><SPAN class=pln>device_lock</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=parent"><SPAN class=pln>parent</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L722" name=L722><SPAN class=lit>722</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_lock"><SPAN class=pln>device_lock</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L723" name=L723><SPAN class=lit>723</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=driver"><SPAN class=pln>driver</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>==</SPAN><SPAN class=pln> drv</SPAN><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L724" name=L724><SPAN class=lit>724</SPAN></A><SPAN class=pln>                         </SPAN><A href="http://lxr.oss.org.cn/ident?i=__device_release_driver"><SPAN class=pln>__device_release_driver</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L725" name=L725><SPAN class=lit>725</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_unlock"><SPAN class=pln>device_unlock</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L726" name=L726><SPAN class=lit>726</SPAN></A><SPAN class=pln>                 </SPAN><SPAN class=kwd>if</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=parent"><SPAN class=pln>parent</SPAN></A><SPAN class=pun>)</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L727" name=L727><SPAN class=lit>727</SPAN></A><SPAN class=pln>                         </SPAN><A href="http://lxr.oss.org.cn/ident?i=device_unlock"><SPAN class=pln>device_unlock</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>-&gt;</SPAN><A href="http://lxr.oss.org.cn/ident?i=parent"><SPAN class=pln>parent</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L728" name=L728><SPAN class=lit>728</SPAN></A><SPAN class=pln>                 </SPAN><A href="http://lxr.oss.org.cn/ident?i=put_device"><SPAN class=pln>put_device</SPAN></A><SPAN class=pun>(</SPAN><A href="http://lxr.oss.org.cn/ident?i=dev"><SPAN class=pln>dev</SPAN></A><SPAN class=pun>);</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L729" name=L729><SPAN class=lit>729</SPAN></A><SPAN class=pln>         </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln>
</SPAN><A href="http://lxr.oss.org.cn/source/drivers/base/dd.c#L730" name=L730><SPAN class=lit>730</SPAN></A><SPAN class=pln> </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln></SPAN></PRE></SPAN></PRE></SPAN></PRE></SPAN></PRE></SPAN></FONT>