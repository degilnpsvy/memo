/**<BR>&nbsp;* platform_device_add_data - add platform-specific data to a platform device<BR>&nbsp;* @pdev: platform device allocated by platform_device_alloc to add resources to<BR>&nbsp;* @data: platform specific data for this platform device<BR>&nbsp;* @size: size of platform specific data<BR>&nbsp;*<BR>&nbsp;* Add a copy of platform specific data to the platform device's<BR>&nbsp;* platform_data pointer.&nbsp; The memory associated with the platform data<BR>&nbsp;* will be freed when the platform device is released.<BR>&nbsp;*/<BR>int platform_device_add_data(struct platform_device *pdev, const void *data,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t size)<BR>{<BR>&nbsp;void *d = NULL;</P>
<P>&nbsp;if (data) {<BR>&nbsp;&nbsp;d = kmemdup(data, size, GFP_KERNEL);<BR>&nbsp;&nbsp;if (!d)<BR>&nbsp;&nbsp;&nbsp;return -ENOMEM;<BR>&nbsp;}</P>
<P>&nbsp;kfree(pdev-&gt;dev.platform_data);<BR>&nbsp;pdev-&gt;dev.platform_data = d;<BR>&nbsp;return 0;<BR>}<BR>EXPORT_SYMBOL_GPL(platform_device_add_data);