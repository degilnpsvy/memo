<P class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><SPAN lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 'TheSansMonoCondensed-SemiLight','serif'; mso-bidi-font-size: 8.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: TheSansMonoCondensed-SemiLight">int printk_ratelimit(void);</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">This function should be called before you consider printing a message that could be repeated often. If the function returns a nonzero value, go ahead and print your message, otherwise skip it. Thus, typical calls look like this:</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 'TheSansMonoCondensed-SemiLight','serif'; mso-bidi-font-size: 8.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: TheSansMonoCondensed-SemiLight">if (printk_ratelimit( ))</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 12pt; FONT-FAMILY: 'TheSansMonoCondensed-SemiLight','serif'; mso-bidi-font-size: 8.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: TheSansMonoCondensed-SemiLight">printk(KERN_NOTICE "The printer is still on fire\n");</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: 'Birka-Italic','serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt; mso-hansi-font-family: Birka">printk_ratelimit </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">works by tracking how many messages are sent to the console. When the level of output exceeds a threshold, </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: 'Birka-Italic','serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt; mso-hansi-font-family: Birka">printk_ratelimit </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">starts returning </SPAN><SPAN lang=EN-US style="FONT-SIZE: 14pt; FONT-FAMILY: 'TheSansMonoCondensed-SemiLight','serif'; mso-bidi-font-size: 9.0pt; mso-bidi-font-family: TheSansMonoCondensed-SemiLight; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: TheSansMonoCondensed-SemiLight">0 </SPAN><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">and causing messages to be dropped.</SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">The behavior of </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: 'Birka-Italic','serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt; mso-hansi-font-family: Birka">printk_ratelimit </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">can be customized by modifying </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: 'Birka-Italic','serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt; mso-hansi-font-family: Birka">/proc/sys/kernel/ printk_ratelimit </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">(the number of seconds to wait before re-enabling messages) and are </SPAN><I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: 'Birka-Italic','serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka-Italic; mso-font-kerning: 0pt; mso-hansi-font-family: Birka">/proc/sys/kernel/printk_ratelimit_burst </SPAN></I><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast">(the number of messages accepted before ratelimiting).</SPAN> 
<P class=MsoNormal style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" align=left><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast"></SPAN>&nbsp;</P><SPAN lang=EN-US style="FONT-SIZE: 16pt; FONT-FAMILY: '&#24494;&#36719;&#38597;&#40657;','sans-serif'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: Birka; mso-font-kerning: 0pt; mso-fareast-font-family: &#23435;&#20307;; mso-fareast-theme-font: minor-fareast"><PRE><A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#2734" name=2734>2734</A><B>int</B> <A class=xf name=__printk_ratelimit></A><A class=xf href="http://172.21.12.145:8080/source/s?refs=__printk_ratelimit&amp;project=linux-4.3">__printk_ratelimit</A>(<B>const</B> <B>char</B> *<A class=xa name=func></A><A class=xa href="http://172.21.12.145:8080/source/s?refs=func&amp;project=linux-4.3">func</A>)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#2735" name=2735>2735</A>{
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#2736" name=2736>2736</A>	<B>return</B> <A href="http://172.21.12.145:8080/source/s?defs=___ratelimit&amp;project=linux-4.3">___ratelimit</A>(&amp;<A href="http://172.21.12.145:8080/source/s?defs=printk_ratelimit_state&amp;project=linux-4.3">printk_ratelimit_state</A>, <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#func">func</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#2737" name=2737>2737</A>}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/kernel/printk/printk.c#2738" name=2738>2738</A><A href="http://172.21.12.145:8080/source/s?defs=EXPORT_SYMBOL&amp;project=linux-4.3">EXPORT_SYMBOL</A>(<A class=xv name=__printk_ratelimit></A><A class=xv href="http://172.21.12.145:8080/source/s?refs=__printk_ratelimit&amp;project=linux-4.3">__printk_ratelimit</A>);</PRE><PRE>&nbsp;</PRE><PRE><PRE><A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#1" name=1>1</A><SPAN class=c>/*
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#2" name=2>2</A> * <A href="http://172.21.12.145:8080/source/s?path=ratelimit.c&amp;project=linux-4.3">ratelimit.c</A> - Do something with rate limit.
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#3" name=3>3</A> *
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#4" name=4>4</A> * Isolated from <A href="http://172.21.12.145:8080/source/s?path=kernel/">kernel</A>/<A href="http://172.21.12.145:8080/source/s?path=kernel/printk.c">printk.c</A> by Dave Young &lt;hidave.darkstar@gmail.com&gt;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#5" name=5>5</A> *
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#6" name=6>6</A> * 2008-05-01 rewrite the function and use a ratelimit_state data struct as
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#7" name=7>7</A> * parameter. Now every user can use their own standalone ratelimit_state.
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#8" name=8>8</A> *
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#9" name=9>9</A> * This file is released under the GPLv2.
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#10" name=10>10</A> */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#11" name=11>11</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#12" name=12>12</A>#<B>include</B> &lt;<A href="http://172.21.12.145:8080/source/s?path=linux/">linux</A>/<A href="http://172.21.12.145:8080/source/s?path=linux/ratelimit.h">ratelimit.h</A>&gt;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#13" name=13>13</A>#<B>include</B> &lt;<A href="http://172.21.12.145:8080/source/s?path=linux/">linux</A>/<A href="http://172.21.12.145:8080/source/s?path=linux/jiffies.h">jiffies.h</A>&gt;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#14" name=14>14</A>#<B>include</B> &lt;<A href="http://172.21.12.145:8080/source/s?path=linux/">linux</A>/<A href="http://172.21.12.145:8080/source/s?path=linux/export.h">export.h</A>&gt;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#15" name=15>15</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#16" name=16>16</A><SPAN class=c>/*
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#17" name=17>17</A> * __ratelimit - rate limiting
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#18" name=18>18</A> * @rs: ratelimit_state data
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#19" name=19>19</A> * @func: name of calling function
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#20" name=20>20</A> *
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#21" name=21>21</A> * This enforces a rate limit: not more than @rs-&gt;burst callbacks
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#22" name=22>22</A> * in every @rs-&gt;interval
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#23" name=23>23</A> *
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#24" name=24>24</A> * RETURNS:
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#25" name=25>25</A> * 0 means callbacks will be suppressed.
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#26" name=26>26</A> * 1 means go ahead and do it.
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#27" name=27>27</A> */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#28" name=28>28</A><B>int</B> <A class=xf name=___ratelimit></A><A class=xf href="http://172.21.12.145:8080/source/s?refs=___ratelimit&amp;project=linux-4.3">___ratelimit</A>(<B>struct</B> <A href="http://172.21.12.145:8080/source/s?defs=ratelimit_state&amp;project=linux-4.3">ratelimit_state</A> *<A class=xa name=rs></A><A class=xa href="http://172.21.12.145:8080/source/s?refs=rs&amp;project=linux-4.3">rs</A>, <B>const</B> <B>char</B> *<A class=xa name=func></A><A class=xa href="http://172.21.12.145:8080/source/s?refs=func&amp;project=linux-4.3">func</A>)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#29" name=29>29</A>{
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#30" name=30>30</A>	<B>unsigned</B> <B>long</B> <A class=xl name=flags></A><A class=xl href="http://172.21.12.145:8080/source/s?refs=flags&amp;project=linux-4.3">flags</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#31" name=31>31</A>	<B>int</B> <A class=xl name=ret></A><A class=xl href="http://172.21.12.145:8080/source/s?refs=ret&amp;project=linux-4.3">ret</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#32" name=32>32</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#33" name=33>33</A>	<B>if</B> (!<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=interval&amp;project=linux-4.3">interval</A>)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#34" name=34>34</A>		<B>return</B> <SPAN class=n>1</SPAN>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#35" name=35>35</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#36" name=36>36</A>	<SPAN class=c>/*
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#37" name=37>37</A>	 * If we contend on this state's lock then almost
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#38" name=38>38</A>	 * by definition we are too busy to print a message,
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#39" name=39>39</A>	 * in addition to the one that will be printed by
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#40" name=40>40</A>	 * the entity that is holding the lock already:
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#41" name=41>41</A>	 */</SPAN>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#42" name=42>42</A>	<B>if</B> (!<A href="http://172.21.12.145:8080/source/s?defs=raw_spin_trylock_irqsave&amp;project=linux-4.3">raw_spin_trylock_irqsave</A>(&amp;<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=lock&amp;project=linux-4.3">lock</A>, <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#flags">flags</A>))
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#43" name=43>43</A>		<B>return</B> 0;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#44" name=44>44</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#45" name=45>45</A>	<B>if</B> (!<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=begin&amp;project=linux-4.3">begin</A>)
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#46" name=46>46</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=begin&amp;project=linux-4.3">begin</A> = <A href="http://172.21.12.145:8080/source/s?defs=jiffies&amp;project=linux-4.3">jiffies</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#47" name=47>47</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#48" name=48>48</A>	<B>if</B> (<A href="http://172.21.12.145:8080/source/s?defs=time_is_before_jiffies&amp;project=linux-4.3">time_is_before_jiffies</A>(<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=begin&amp;project=linux-4.3">begin</A> + <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=interval&amp;project=linux-4.3">interval</A>)) {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#49" name=49>49</A>		<B>if</B> (<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=missed&amp;project=linux-4.3">missed</A>)
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#50" name=50>50</A>			<A href="http://172.21.12.145:8080/source/s?defs=printk&amp;project=linux-4.3">printk</A>(<A href="http://172.21.12.145:8080/source/s?defs=KERN_WARNING&amp;project=linux-4.3">KERN_WARNING</A> <SPAN class=s>"%s: %d callbacks suppressed\n"</SPAN>,
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#51" name=51>51</A>				<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#func">func</A>, <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=missed&amp;project=linux-4.3">missed</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#52" name=52>52</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=begin&amp;project=linux-4.3">begin</A>   = 0;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#53" name=53>53</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=printed&amp;project=linux-4.3">printed</A> = 0;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#54" name=54>54</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=missed&amp;project=linux-4.3">missed</A>  = 0;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#55" name=55>55</A>	}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#56" name=56>56</A>	<B>if</B> (<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=burst&amp;project=linux-4.3">burst</A> &amp;&amp; <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=burst&amp;project=linux-4.3">burst</A> &gt; <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=printed&amp;project=linux-4.3">printed</A>) {
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#57" name=57>57</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=printed&amp;project=linux-4.3">printed</A>++;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#58" name=58>58</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#ret">ret</A> = <SPAN class=n>1</SPAN>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#59" name=59>59</A>	} <B>else</B> {
<A class=hl href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#60" name=60>60</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=missed&amp;project=linux-4.3">missed</A>++;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#61" name=61>61</A>		<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#ret">ret</A> = 0;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#62" name=62>62</A>	}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#63" name=63>63</A>	<A href="http://172.21.12.145:8080/source/s?defs=raw_spin_unlock_irqrestore&amp;project=linux-4.3">raw_spin_unlock_irqrestore</A>(&amp;<A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#rs">rs</A>-&gt;<A href="http://172.21.12.145:8080/source/s?defs=lock&amp;project=linux-4.3">lock</A>, <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#flags">flags</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#64" name=64>64</A>
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#65" name=65>65</A>	<B>return</B> <A class=d href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#ret">ret</A>;
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#66" name=66>66</A>}
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#67" name=67>67</A><A href="http://172.21.12.145:8080/source/s?defs=EXPORT_SYMBOL&amp;project=linux-4.3">EXPORT_SYMBOL</A>(<A class=xv name=___ratelimit></A><A class=xv href="http://172.21.12.145:8080/source/s?refs=___ratelimit&amp;project=linux-4.3">___ratelimit</A>);
<A class=l href="http://172.21.12.145:8080/source/xref/linux-4.3/lib/ratelimit.c#68" name=68>68</A></PRE></PRE></SPAN>