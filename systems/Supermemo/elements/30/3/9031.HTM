<H5 class=subsubsection style="WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; LINE-HEIGHT: normal; FONT-STYLE: normal; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; FONT-VARIANT: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">2.17.3.2 Relocating the section contents</H5>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>_bfd_final_link</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>function should look through the<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>structures attached to each section of the output file. Each<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>structure should either be handled specially, or it should be passed to the function<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>_bfd_default_link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>which will do the right thing (<CODE>_bfd_default_link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>is defined in<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>linker.c</CODE>).</P>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">For efficiency, a<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>of type<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>bfd_indirect_link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>whose associated section belongs to a BFD of the same format as the output BFD must be handled specially. This type of<CODE>link_order</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>describes part of an output section in terms of a section belonging to one of the input files. The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>_bfd_final_link</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>function should read the contents of the section and any associated relocs, apply the relocs to the section contents, and write out the modified section contents. If performing a relocatable link, the relocs themselves must also be modified and written out.</P>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px"><A name=index-g_t_005fbfd_005frelocate_005fcontents-1918></A><A name=index-g_t_005fbfd_005ffinal_005flink_005frelocate-1919></A>The functions<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>_bfd_relocate_contents</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>_bfd_final_link_relocate</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>provide some general support for performing the actual relocations, notably overflow checking. Their arguments include information about the symbol the relocation is against and a<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>reloc_howto_type</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>argument which describes the relocation to perform. These functions are defined in<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>reloc.c</CODE>.</P>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">The a.out function which handles reading, relocating, and writing section contents is<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>aout_link_input_section</CODE>. The actual relocation is done in<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>aout_link_input_section_std</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>and<CODE>aout_link_input_section_ext</CODE>.