/* Return the current xPSR value.&nbsp; */<BR>static inline uint32_t <SPAN class=cloze>[...]</SPAN>(CPUARMState *env)<BR>{<BR>&nbsp;&nbsp;&nbsp; int ZF;<BR>&nbsp;&nbsp;&nbsp; ZF = (env-&gt;ZF == 0);<BR>&nbsp;&nbsp;&nbsp; return (env-&gt;NF &amp; 0x80000000) | (ZF &lt;&lt; 30)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | (env-&gt;CF &lt;&lt; 29) | ((env-&gt;VF &amp; 0x80000000) &gt;&gt; 3) | (env-&gt;QF &lt;&lt; 27)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | (env-&gt;thumb &lt;&lt; 24) | ((env-&gt;condexec_bits &amp; 3) &lt;&lt; 25)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | ((env-&gt;condexec_bits &amp; 0xfc) &lt;&lt; 8)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | env-&gt;v7m.exception;<BR>} 
<P></P>
<P>/* Set the xPSR.&nbsp; Note that some bits of mask must be all-set or all-clear.&nbsp; */<BR>static inline void <SPAN class=cloze><FONT color=#000000>[...]</FONT></SPAN>(CPUARMState *env, uint32_t val, uint32_t mask)<BR>{<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; CPSR_NZCV) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;ZF = (~val) &amp; CPSR_Z;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;NF = val;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;CF = (val &gt;&gt; 29) &amp; 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;VF = (val &lt;&lt; 3) &amp; 0x80000000;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; CPSR_Q)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;QF = ((val &amp; CPSR_Q) != 0);<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; (1 &lt;&lt; 24))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;thumb = ((val &amp; (1 &lt;&lt; 24)) != 0);<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; CPSR_IT_0_1) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;condexec_bits &amp;= ~3;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;condexec_bits |= (val &gt;&gt; 25) &amp; 3;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; CPSR_IT_2_7) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;condexec_bits &amp;= 3;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;condexec_bits |= (val &gt;&gt; 8) &amp; 0xfc;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; if (mask &amp; 0x1ff) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env-&gt;v7m.exception = val &amp; 0x1ff;<BR>&nbsp;&nbsp;&nbsp; }<BR>}