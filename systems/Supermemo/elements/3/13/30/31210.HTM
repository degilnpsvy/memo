The following integrity checks on exception return are performed on every exception return:<BR>1. In a PE with the Security Extension, the integrity check that is called the EXC_RETURN.ES validation check, as follows:<BR>&nbsp;&nbsp; &#8226; If the PE was in Non-secure state when EXC_RETURN was loaded into the PC and either EXC_RETURN.DCRS is 0 or EXC_RETURN.ES is 1, an INVER SecureFault is generated and the PE sets EXC_RETURN.ES to 0.<BR>2. A check that the exception number being returned from, as held in the IPSR, is shown as active in the SHCSR or NVIC_IABR&lt;n&gt;. If this check fails:<BR>&nbsp;&nbsp; &#8226; In a PE with the Main Extension, an INVPC UsageFault is generated. If the PE includes the Security Extension, the INVPC UsageFault targets the Security state that the exception return instruction was executed in.<BR>&nbsp;&nbsp; &#8226; In a PE without the Main Extension, a HardFault is generated. If the PE includes the Security Extension, the HardFault targets the Security state that EXC_RETURN.S specifies.<BR>3. In a PE with the Main Extension, an INVPC UsageFault is generated if EXC_RETURN[1] is 1. If the PE includes the Security Extension, the INVPC UsageFault targets the Security state that the exception return instruction was executed in.<BR>4. A check that if the return is to Thread mode, the value restored to the IPSR from the RETPSR is zero, or that if the return is to Handler mode, the value restored to the IPSR from the RETPSR is non zero. If this check fails:<BR>&nbsp;&nbsp; &#8226; In a PE with the Main Extension, an INVPC UsageFault is generated. If the PE includes the Security Extension, the INVPC UsageFault targets the Background Security state.<BR>&nbsp;&nbsp; &#8226; In a PE without the Main Extension, a HardFault is generated. If the PE includes the Security Extension, the HardFault targets the Security state that EXC_RETURN.S specifies.<BR>RJMJC In a PE with the Security Extension, after the EXC_RETURN.ES validation check has been performed on an exception return:<BR>&#8226; If EXC_RETURN.ES is 1, EXC_RETURN.SPSEL is written to CONTROL_S.SPSEL.<BR>&#8226; If EXC_RETURN.ES is 0, EXC_RETURN.SPSEL is written to CONTROL_NS.SPSEL.