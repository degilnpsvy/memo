DerivedLateArrival() Handles a derived late arriving exception Derived exceptions on exception entry on page B1-663<BR>// DerivedLateArrival()<BR>// ====================<BR>DerivedLateArrival()</P>
<P>// xEpriority: the lower the value, the higher the priority<BR>// PE: the pre-empted exception - before exception entry<BR>// OE: the original exception - exception entry<BR>// DE: the derived exception - fault on exception entry</P>
<P>integer PEpriority; // pre-empted exception group priority<BR>integer OEpriority; // group priority of the original exception<BR>integer DEpriority; // derived exception group priority</P>
<P>integer PEnumber; // ExceptionNumber for PE<BR>integer OEnumber; // ExceptionNumber for OE<BR>integer DEnumber; // ExceptionNumber for DE</P>
<P>boolean DEisDbgMonFault; // DE is a DebugMonitorFault</P>
<P>if DEpriority &gt;= PEpriority &amp;&amp; DEisDbgMonFault then<BR>&nbsp;&nbsp;&nbsp; ExceptionTaken(OEnumber); // ignore the DebugMonitorFault<BR>if DEpriority &gt;= PEpriority &amp;&amp; !DEisDbgMonFault then<BR>&nbsp;&nbsp;&nbsp; DEpriority = -1; // escalate DE to HardFault<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (incl. BKPT with DebugMonitor disabled)<BR>&nbsp;&nbsp;&nbsp; SetPending(OEnumber); // OE to Pending state<BR>&nbsp;&nbsp;&nbsp; ExceptionTaken(HardFault);<BR>else<BR>&nbsp;&nbsp;&nbsp; if DEpriority &lt; OEpriority then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetPending(OEnumber); // OE to Pending state<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExceptionTaken(DEnumber); // start execution of the DE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // tail-chaining IMPLEMENTATION DEFINED<BR>&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp; SetPending(DEnumber); // DE to Pending state<BR>&nbsp;&nbsp;&nbsp; ExceptionTaken(OEnumber); // start execution of the OE