&nbsp;if (res) {<BR>&nbsp;&nbsp;r = kmemdup(res, sizeof(struct resource) * num, GFP_KERNEL);<BR>&nbsp;&nbsp;if (!r)<BR>&nbsp;&nbsp;&nbsp;return -ENOMEM;<BR>&nbsp;} 
<P></P>
<P>&nbsp;kfree(pdev-&gt;resource);<BR>&nbsp;pdev-&gt;resource = r;<BR>&nbsp;pdev-&gt;num_resources = num;<BR>&nbsp;return 0;