/**<BR>&nbsp;* down - acquire the semaphore<BR>&nbsp;* @sem: the semaphore to be acquired<BR>&nbsp;*<BR>&nbsp;* Acquires the semaphore.&nbsp; If no more tasks are allowed to acquire the<BR>&nbsp;* semaphore, calling this function will put the task to sleep until the<BR>&nbsp;* semaphore is released.<BR>&nbsp;*<BR>&nbsp;* <FONT class=clozed>Use of this function is deprecated, please use down_interruptible() or<BR>&nbsp;* down_killable() instead</FONT>.<BR>&nbsp;*/<BR>void down(struct semaphore *sem)<BR>{<BR>&nbsp;unsigned long flags; 
<P></P>
<P>&nbsp;raw_spin_lock_irqsave(&amp;sem-&gt;lock, flags);<BR>&nbsp;if (likely(sem-&gt;count &gt; 0))<BR>&nbsp;&nbsp;sem-&gt;count--;<BR>&nbsp;else<BR>&nbsp;&nbsp;__down(sem);<BR>&nbsp;raw_spin_unlock_irqrestore(&amp;sem-&gt;lock, flags);<BR>}<BR>EXPORT_SYMBOL(down);