int driver_register(struct device_driver * drv);</P>
<P><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#140" name=140>140</A><SPAN class=c>/**
<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#141" name=141>141</A> * driver_register - register driver with bus<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#142" name=142>142</A> * @drv: driver to register<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#143" name=143>143</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#144" name=144>144</A> * We pass off most of the work to the bus_add_driver() call,<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#145" name=145>145</A> * since most of the things we have to do deal with the bus<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#146" name=146>146</A> * structures.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#147" name=147>147</A> */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#148" name=148>148</A><B>int</B> <A class=xf name=driver_register></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=driver_register&amp;project=Linux-v4.6">driver_register</A>(<B>struct</B> <A href="http://172.29.26.110:8080/source/s?defs=device_driver&amp;project=Linux-v4.6">device_driver</A> *<A class=xa name=drv></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=drv&amp;project=Linux-v4.6">drv</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#149" name=149>149</A>{<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#150" name=150>150</A>	<B>int</B> <A class=xl name=ret></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=ret&amp;project=Linux-v4.6">ret</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#151" name=151>151</A>	<B>struct</B> <A href="http://172.29.26.110:8080/source/s?defs=device_driver&amp;project=Linux-v4.6">device_driver</A> *<A class=xl name=other></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=other&amp;project=Linux-v4.6">other</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#152" name=152>152</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#153" name=153>153</A>	<A href="http://172.29.26.110:8080/source/s?defs=BUG_ON&amp;project=Linux-v4.6">BUG_ON</A>(!<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#bus">bus</A>-&gt;p);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#154" name=154>154</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#155" name=155>155</A>	<B>if</B> ((<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#bus">bus</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=probe&amp;project=Linux-v4.6">probe</A> &amp;&amp; <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=probe&amp;project=Linux-v4.6">probe</A>) ||<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#156" name=156>156</A>	&nbsp;&nbsp;&nbsp; (<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#bus">bus</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=remove&amp;project=Linux-v4.6">remove</A> &amp;&amp; <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=remove&amp;project=Linux-v4.6">remove</A>) ||<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#157" name=157>157</A>	&nbsp;&nbsp;&nbsp; (<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#bus">bus</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=shutdown&amp;project=Linux-v4.6">shutdown</A> &amp;&amp; <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=shutdown&amp;project=Linux-v4.6">shutdown</A>))<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#158" name=158>158</A>		<A href="http://172.29.26.110:8080/source/s?defs=printk&amp;project=Linux-v4.6">printk</A>(<A href="http://172.29.26.110:8080/source/s?defs=KERN_WARNING&amp;project=Linux-v4.6">KERN_WARNING</A> <SPAN class=s>"Driver '%s' needs updating - please use "</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#159" name=159>159</A>			<SPAN class=s>"bus_type methods\n"</SPAN>, <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#name">name</A>);<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#160" name=160>160</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#161" name=161>161</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#other">other</A> = <A href="http://172.29.26.110:8080/source/s?defs=driver_find&amp;project=Linux-v4.6">driver_find</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#name">name</A>, <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#bus">bus</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#162" name=162>162</A>	<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#other">other</A>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#163" name=163>163</A>		<A href="http://172.29.26.110:8080/source/s?defs=printk&amp;project=Linux-v4.6">printk</A>(<A href="http://172.29.26.110:8080/source/s?defs=KERN_ERR&amp;project=Linux-v4.6">KERN_ERR</A> <SPAN class=s>"Error: Driver '%s' is already registered, "</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#164" name=164>164</A>			<SPAN class=s>"aborting...\n"</SPAN>, <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#name">name</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#165" name=165>165</A>		<B>return</B> -<A href="http://172.29.26.110:8080/source/s?defs=EBUSY&amp;project=Linux-v4.6">EBUSY</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#166" name=166>166</A>	}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#167" name=167>167</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#168" name=168>168</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A> = <A href="http://172.29.26.110:8080/source/s?defs=bus_add_driver&amp;project=Linux-v4.6">bus_add_driver</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#169" name=169>169</A>	<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A>)<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#170" name=170>170</A>		<B>return</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#171" name=171>171</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#driver_add_groups">driver_add_groups</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>, <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=groups&amp;project=Linux-v4.6">groups</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#172" name=172>172</A>	<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#173" name=173>173</A>		<A href="http://172.29.26.110:8080/source/s?defs=bus_remove_driver&amp;project=Linux-v4.6">bus_remove_driver</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#174" name=174>174</A>		<B>return</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#175" name=175>175</A>	}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#176" name=176>176</A>	<A href="http://172.29.26.110:8080/source/s?defs=kobject_uevent&amp;project=Linux-v4.6">kobject_uevent</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;p-&gt;<A href="http://172.29.26.110:8080/source/s?defs=kobj&amp;project=Linux-v4.6">kobj</A>, <A href="http://172.29.26.110:8080/source/s?defs=KOBJ_ADD&amp;project=Linux-v4.6">KOBJ_ADD</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#177" name=177>177</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#178" name=178>178</A>	<B>return</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#ret">ret</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#179" name=179>179</A>}<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#180" name=180>180</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL_GPL&amp;project=Linux-v4.6">EXPORT_SYMBOL_GPL</A>(<A class=xv name=driver_register></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=driver_register&amp;project=Linux-v4.6">driver_register</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#181" name=181>181</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#182" name=182>182</A><SPAN class=c>/**<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#183" name=183>183</A> * driver_unregister - remove driver from system.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#184" name=184>184</A> * @drv: driver.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#185" name=185>185</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#186" name=186>186</A> * Again, we pass off most of the work to the bus-level call.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#187" name=187>187</A> */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#188" name=188>188</A><B>void</B> <A class=xf name=driver_unregister></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=driver_unregister&amp;project=Linux-v4.6">driver_unregister</A>(<B>struct</B> <A href="http://172.29.26.110:8080/source/s?defs=device_driver&amp;project=Linux-v4.6">device_driver</A> *<A class=xa name=drv></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=drv&amp;project=Linux-v4.6">drv</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#189" name=189>189</A>{<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#190" name=190>190</A>	<B>if</B> (!<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A> || !<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;p) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#191" name=191>191</A>		<A href="http://172.29.26.110:8080/source/s?defs=WARN&amp;project=Linux-v4.6">WARN</A>(<SPAN class=n>1</SPAN>, <SPAN class=s>"Unexpected driver unregister!\n"</SPAN>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#192" name=192>192</A>		<B>return</B>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#193" name=193>193</A>	}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#194" name=194>194</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#driver_remove_groups">driver_remove_groups</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>, <A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=groups&amp;project=Linux-v4.6">groups</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#195" name=195>195</A>	<A href="http://172.29.26.110:8080/source/s?defs=bus_remove_driver&amp;project=Linux-v4.6">bus_remove_driver</A>(<A href="http://172.29.26.110:8080/source/s?defs=drv&amp;project=Linux-v4.6">drv</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#196" name=196>196</A>}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.6/drivers/base/driver.c#197" name=197>197</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL_GPL&amp;project=Linux-v4.6">EXPORT_SYMBOL_GPL</A>(<A class=xv name=driver_unregister></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=driver_unregister&amp;project=Linux-v4.6">driver_unregister</A>);