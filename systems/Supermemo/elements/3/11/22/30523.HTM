<B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>E3.1.145 IsActiveForState</FONT></SPAN></B>
<P></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>// IsActiveForState()</FONT></SPAN></I></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>// ==================</FONT></SPAN></I></P>
<P><FONT face=Calibri><B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt">boolean </SPAN></B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt">IsActiveForState(<B>integer </B>exception, <B>boolean </B>isSecure)</SPAN></FONT></P>
<P><FONT face=Calibri><B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt">&nbsp;&nbsp;&nbsp; if </SPAN></B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt">!HaveSecurityExt() <B>then</B></SPAN></FONT></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN></SPAN>isSecure = FALSE;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><EM>// If the exception is configurable then we need to check which domain it</EM></FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><EM>// currently targets. If its not configurable then the active flags can be</EM></FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><EM>// used directly.</EM></FONT></SPAN></P>
<P><FONT face=Calibri><SPAN><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><STRONG>if </STRONG>IsExceptionTargetConfigurable(exception) <B>then</B></SPAN></FONT></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN></SPAN>active = ((ExceptionActive[exception] != '00') &amp;&amp;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG></SPAN></SPAN></SPAN></SPAN></SPAN><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN>(ExceptionTargetsSecure(exception, isSecure) == isSecure));</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><STRONG>else</STRONG></FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN></SPAN>idx = <B>if </B>isSecure <B>then </B>0 <B>else </B>1;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;</STRONG><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN></SPAN>active = ExceptionActive[exception]&lt;idx&gt; == '1';</FONT></SPAN></P>
<P><FONT face=Calibri><SPAN><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></SPAN><STRONG>return </STRONG>active;</SPAN></FONT>