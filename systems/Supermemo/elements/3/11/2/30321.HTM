static int exception_target_el(CPUARMState *env)<BR>{<BR>&nbsp;&nbsp;&nbsp; int target_el = MAX(1, arm_current_el(env));</P>
<P>&nbsp;&nbsp;&nbsp; /* No such thing as secure EL1 if EL3 is aarch32, so update the target EL<BR>&nbsp;&nbsp;&nbsp;&nbsp; * to EL3 in this case.<BR>&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp;&nbsp;&nbsp; if (arm_is_secure(env) &amp;&amp; !arm_el_is_aa64(env, 3) &amp;&amp; target_el == 1) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target_el = 3;<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; return target_el;<BR>}