CheckVFPEnabled() Generate Undefined Instruction exception if the FP extension is not enabled Checks on FP instruction execution on page B1-686<BR>The CheckVFPEnabled() pseudocode procedure takes appropriate action if software uses a floating-point instruction when the Floating-point extension is not enabled:
<P></P>
<P>// CheckVFPEnabled()<BR>// =================</P>
<P>CheckVFPEnabled()<BR>&nbsp;&nbsp;&nbsp; // Check Coprocessor Access Control Register for permission to use CP10/11.<BR>&nbsp;&nbsp;&nbsp; if CPACR.cp10 != CPACR.cp11 then UNPREDICTABLE;<BR>&nbsp;&nbsp;&nbsp; case CPACR.cp10 of<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when &#8216;00&#8217;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UFSR.NOCP = &#8216;1&#8217;;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExceptionTaken(UsageFault);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when &#8216;01&#8217;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if !CurrentModeIsPrivileged()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UFSR.NOCP = &#8216;1&#8217;;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExceptionTaken(UsageFault);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when &#8216;10&#8217;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNPREDICTABLE;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // when &#8216;11&#8217; // access permitted by CPACR<BR>&nbsp;&nbsp;&nbsp; return;