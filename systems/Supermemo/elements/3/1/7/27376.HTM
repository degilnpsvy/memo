ExecuteFPCheck() On FP instruction execution, checks whether FP functionality is enabled, and if so, saves FP state if necessary. Checks on FP instruction execution on page B1-686<BR>// ExecuteFPCheck()<BR>// ================</P>
<P>ExecuteFPCheck()<BR>&nbsp;&nbsp;&nbsp; // Check access to FP coprocessor is enabled<BR>&nbsp;&nbsp;&nbsp; CheckVFPEnabled();<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // If FP lazy context save is enabled then save state<BR>&nbsp;&nbsp;&nbsp; if FPCCR.LSPACT == &#8216;1&#8217; then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PreserveFPState();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // Update CONTROL.FPCA, and create new FP context<BR>&nbsp;&nbsp;&nbsp; // if this has been enabled by setting FPCCR.ASPEN to 1<BR>&nbsp;&nbsp;&nbsp; if FPCCR.ASPEN == &#8216;1&#8217; AND CONTROL.FPCA = &#8216;0&#8217; then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FPSCR&lt;26:22&gt; = FPDSCR&lt;26:22&gt;;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CONTROL.FPCA = &#8216;1&#8217;;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; return;