Integrity checks on exception return<BR>RTRFJ <FONT class=extract>A fault generated by a failed integrity check on exception return is generated after either the active bit for the returning exception, or the active bit for NMI or HardFault, has been cleared to 0, and if applicable, after FAULTMASK has also been cleared to 0. A fault generated by a failed integrity check on exception return causes lockup when:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8226; The exception would escalate to a Secure HardFault and any of the following is true:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; Secure HardFault is already active.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; NMI is active and AIRCR.BFHFNMINS is 0.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; FAULTMASK_S.FM is 1.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; Non-secure Hardfault is active and AIRCR.BFHFNMINS is 0.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8226; The exception would escalate to a Non-secure HardFault and any of the following is true:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; Non-secure HardFault or Secure HardFault is already active.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; NMI is active.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8213; FAULTMASK_NS.FM or FAULTMASK_S.FM is 1.</FONT><BR>RWBVC <FONT class=extract>The target Security state of an INVPC UsageFault generated because of a failed integrity check on exception return is the Security state that the exception return instruction was executed in.</FONT><BR>RDFKP <FONT class=extract>When the PE enters lockup because of a fault generated by a failed integrity check, the PE:<BR>&#8226; Updates any Fault Status Registers associated with the error.<BR>&#8226; Sets IPSR to 0, if EXC_RETURN for the returning exception indicated a return to Thread mode.<BR>&#8226; Sets IPSR to 3, if EXC_RETURN for the returning exception indicated a return to Handler mode.<BR>&#8226; Sets the stack pointer used for unstacking to the value it would have had if the fault had not occurred.<BR>&nbsp; &#8213; If the XPSR load faults, the SP is 64-bit aligned.<BR>&#8226; Updates CONTROL.FPCA, based on EXC_RETURN.FType.<BR>&#8226; Sets the PC to 0xEFFFFFFE.<BR>In addition, the APSR, EPSR, FPSCR, R0-R12, LR, and S0-S31 are UNKNOWN.</FONT>