down_trylock() and up()</P>
<P><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#117" name=117>117</A><SPAN class=c>/**
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#118" name=118>118</A> * down_trylock - try to acquire the semaphore, without waiting<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#119" name=119>119</A> * @sem: the semaphore to be acquired<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#120" name=120>120</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#121" name=121>121</A> * Try to acquire the semaphore atomically.&nbsp; Returns 0 if the semaphore has<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#122" name=122>122</A> * been acquired successfully or 1 if it it cannot be acquired.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#123" name=123>123</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#124" name=124>124</A> * NOTE: This return value is inverted from both spin_trylock and<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#125" name=125>125</A> * mutex_trylock!&nbsp; Be careful about this when converting code.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#126" name=126>126</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#127" name=127>127</A> * Unlike mutex_trylock, this function can be used from interrupt context,<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#128" name=128>128</A> * and the semaphore can be released by any task or interrupt.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#129" name=129>129</A> */</SPAN><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#130" name=130>130</A><B>int</B> <A class=xf name=down_trylock></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=down_trylock&amp;project=Linux-v4.7">down_trylock</A>(<B>struct</B> <A href="http://172.29.26.110:8080/source/s?defs=semaphore&amp;project=Linux-v4.7">semaphore</A> *<A class=xa name=sem></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=sem&amp;project=Linux-v4.7">sem</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#131" name=131>131</A>{<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#132" name=132>132</A>	<B>unsigned</B> <B>long</B> <A class=xl name=flags></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=flags&amp;project=Linux-v4.7">flags</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#133" name=133>133</A>	<B>int</B> <A class=xl name=count></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=count&amp;project=Linux-v4.7">count</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#134" name=134>134</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#135" name=135>135</A>	<A href="http://172.29.26.110:8080/source/s?defs=raw_spin_lock_irqsave&amp;project=Linux-v4.7">raw_spin_lock_irqsave</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lock&amp;project=Linux-v4.7">lock</A>, <A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#136" name=136>136</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A> = <A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A> - <SPAN class=n>1</SPAN>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#137" name=137>137</A>	<B>if</B> (<A href="http://172.29.26.110:8080/source/s?defs=likely&amp;project=Linux-v4.7">likely</A>(<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A> &gt;= 0))<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#138" name=138>138</A>		<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#139" name=139>139</A>	<A href="http://172.29.26.110:8080/source/s?defs=raw_spin_unlock_irqrestore&amp;project=Linux-v4.7">raw_spin_unlock_irqrestore</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lock&amp;project=Linux-v4.7">lock</A>, <A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A>);<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#140" name=140>140</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#141" name=141>141</A>	<B>return</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A> &lt; 0);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#142" name=142>142</A>}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#143" name=143>143</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL&amp;project=Linux-v4.7">EXPORT_SYMBOL</A>(<A class=xv name=down_trylock></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=down_trylock&amp;project=Linux-v4.7">down_trylock</A>);</P>
<P><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#171" name=171>171</A><SPAN class=c>/**
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#172" name=172>172</A> * up - release the semaphore<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#173" name=173>173</A> * @sem: the semaphore to release<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#174" name=174>174</A> *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#175" name=175>175</A> * Release the semaphore.&nbsp; Unlike mutexes, up() may be called from any<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#176" name=176>176</A> * context and even by tasks which have never called down().<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#177" name=177>177</A> */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#178" name=178>178</A><B>void</B> <A class=xf name=up></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=up&amp;project=Linux-v4.7">up</A>(<B>struct</B> <A href="http://172.29.26.110:8080/source/s?defs=semaphore&amp;project=Linux-v4.7">semaphore</A> *<A class=xa name=sem></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=sem&amp;project=Linux-v4.7">sem</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#179" name=179>179</A>{<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#180" name=180>180</A>	<B>unsigned</B> <B>long</B> <A class=xl name=flags></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=flags&amp;project=Linux-v4.7">flags</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#181" name=181>181</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#182" name=182>182</A>	<A href="http://172.29.26.110:8080/source/s?defs=raw_spin_lock_irqsave&amp;project=Linux-v4.7">raw_spin_lock_irqsave</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lock&amp;project=Linux-v4.7">lock</A>, <A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#183" name=183>183</A>	<B>if</B> (<A href="http://172.29.26.110:8080/source/s?defs=likely&amp;project=Linux-v4.7">likely</A>(<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=wait_list&amp;project=Linux-v4.7">wait_list</A>)))<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#184" name=184>184</A>		<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#count">count</A>++;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#185" name=185>185</A>	<B>else</B><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#186" name=186>186</A>		<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#__up">__up</A>(<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#187" name=187>187</A>	<A href="http://172.29.26.110:8080/source/s?defs=raw_spin_unlock_irqrestore&amp;project=Linux-v4.7">raw_spin_unlock_irqrestore</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=sem&amp;project=Linux-v4.7">sem</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lock&amp;project=Linux-v4.7">lock</A>, <A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#188" name=188>188</A>}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/locking/semaphore.c#189" name=189>189</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL&amp;project=Linux-v4.7">EXPORT_SYMBOL</A>(<A class=xv name=up></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=up&amp;project=Linux-v4.7">up</A>);