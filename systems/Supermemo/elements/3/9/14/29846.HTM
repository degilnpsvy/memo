<A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2459" name=2459><FONT size=4>2459</FONT></A><SPAN class=c style="COLOR: rgb(102,102,102)"><FONT size=4>/**<BR></FONT><A class=hl style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(0,0,0); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2460" name=2460><FONT size=4>2460</FONT></A><FONT size=4> * flush_workqueue - ensure that any scheduled work has run to completion.<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2461" name=2461><FONT size=4>2461</FONT></A><FONT size=4> * @wq: workqueue to flush<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2462" name=2462><FONT size=4>2462</FONT></A><FONT size=4> *<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2463" name=2463><FONT size=4>2463</FONT></A><FONT size=4> * This function sleeps until all work items which were queued on entry<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2464" name=2464><FONT size=4>2464</FONT></A><FONT size=4> * have finished execution, but it is not livelocked by new incoming ones.<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2465" name=2465><FONT size=4>2465</FONT></A><FONT size=4> */</FONT></SPAN>
<P></P>
<P>&nbsp;</P>
<P><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2612" name=2612><FONT size=4>2612</FONT></A><SPAN class=c style="COLOR: rgb(102,102,102)"><FONT size=4>/**<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2613" name=2613><FONT size=4>2613</FONT></A><FONT size=4> * drain_workqueue - drain a workqueue<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2614" name=2614><FONT size=4>2614</FONT></A><FONT size=4> * @wq: workqueue to drain<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2615" name=2615><FONT size=4>2615</FONT></A><FONT size=4> *<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2616" name=2616><FONT size=4>2616</FONT></A><FONT size=4> * Wait until the workqueue becomes empty.&nbsp; While draining is in progress,<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2617" name=2617><FONT size=4>2617</FONT></A><FONT size=4> * only chain queueing is allowed.&nbsp; IOW, only currently pending or running<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2618" name=2618><FONT size=4>2618</FONT></A><FONT size=4> * work items on @wq can queue further work items on it.&nbsp; @wq is flushed<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2619" name=2619><FONT size=4>2619</FONT></A><FONT size=4> * repeatedly until it becomes empty.&nbsp; The number of flushing is detemined<BR></FONT><A class=hl style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(0,0,0); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2620" name=2620><FONT size=4>2620</FONT></A><FONT size=4> * by the depth of chaining and should be relatively short.&nbsp; Whine if it<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2621" name=2621><FONT size=4>2621</FONT></A><FONT size=4> * takes too long.<BR></FONT><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.21.12.145:8080/source/xref/linux-4.1/kernel/workqueue.c#2622" name=2622><FONT size=4>2622</FONT></A><FONT size=4> */</FONT></SPAN></P>
<P>&nbsp;</P>
<P><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2577" name=2577>2577</A><B>void</B> <A class=xf name=flush_workqueue></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=flush_workqueue&amp;project=Linux-v4.7">flush_workqueue</A>(<B>struct</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#workqueue_struct">workqueue_struct</A> *<A class=xa name=wq></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=wq&amp;project=Linux-v4.7">wq</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2578" name=2578>2578</A>{<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2579" name=2579>2579</A>	<B>struct</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#wq_flusher">wq_flusher</A> <A class=xl name=this_flusher></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=this_flusher&amp;project=Linux-v4.7">this_flusher</A> = {<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2580" name=2580>2580</A>		.<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A> = <A href="http://172.29.26.110:8080/source/s?defs=LIST_HEAD_INIT&amp;project=Linux-v4.7">LIST_HEAD_INIT</A>(<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>),<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2581" name=2581>2581</A>		.<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> = -<SPAN class=n>1</SPAN>,<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2582" name=2582>2582</A>		.<A href="http://172.29.26.110:8080/source/s?defs=done&amp;project=Linux-v4.7">done</A> = <A href="http://172.29.26.110:8080/source/s?defs=COMPLETION_INITIALIZER_ONSTACK&amp;project=Linux-v4.7">COMPLETION_INITIALIZER_ONSTACK</A>(<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=done&amp;project=Linux-v4.7">done</A>),<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2583" name=2583>2583</A>	};<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2584" name=2584>2584</A>	<B>int</B> <A class=xl name=next_color></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=next_color&amp;project=Linux-v4.7">next_color</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2585" name=2585>2585</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2586" name=2586>2586</A>	<A href="http://172.29.26.110:8080/source/s?defs=lock_map_acquire&amp;project=Linux-v4.7">lock_map_acquire</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lockdep_map&amp;project=Linux-v4.7">lockdep_map</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2587" name=2587>2587</A>	<A href="http://172.29.26.110:8080/source/s?defs=lock_map_release&amp;project=Linux-v4.7">lock_map_release</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=lockdep_map&amp;project=Linux-v4.7">lockdep_map</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2588" name=2588>2588</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2589" name=2589>2589</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_lock&amp;project=Linux-v4.7">mutex_lock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2590" name=2590>2590</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2591" name=2591>2591</A>	<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2592" name=2592>2592</A>	 * Start-to-wait phase<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2593" name=2593>2593</A>	 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2594" name=2594>2594</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next_color">next_color</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#work_next_color">work_next_color</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2595" name=2595>2595</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2596" name=2596>2596</A>	<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next_color">next_color</A> != <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2597" name=2597>2597</A>		<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2598" name=2598>2598</A>		 * Color space is not full.&nbsp; The current work_color<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2599" name=2599>2599</A>		 * becomes our flush_color and work_color is advanced<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2600" name=2600>2600</A>		 * by one.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2601" name=2601>2601</A>		 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2602" name=2602>2602</A>		<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(!<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>));<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2603" name=2603>2603</A>		<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> = <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2604" name=2604>2604</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next_color">next_color</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2605" name=2605>2605</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2606" name=2606>2606</A>		<B>if</B> (!<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2607" name=2607>2607</A>			<SPAN class=c>/* no flush in progress, become the first flusher */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2608" name=2608>2608</A>			<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2609" name=2609>2609</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2610" name=2610>2610</A>			<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> = &amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2611" name=2611>2611</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2612" name=2612>2612</A>			<B>if</B> (!<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_workqueue_prep_pwqs">flush_workqueue_prep_pwqs</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>, <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>,<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2613" name=2613>2613</A>						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>)) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2614" name=2614>2614</A>				<SPAN class=c>/* nothing to flush, done */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2615" name=2615>2615</A>				<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next_color">next_color</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2616" name=2616>2616</A>				<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> = <A href="http://172.29.26.110:8080/source/s?defs=NULL&amp;project=Linux-v4.7">NULL</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2617" name=2617>2617</A>				<B>goto</B> <A href="http://172.29.26.110:8080/source/s?defs=out_unlock&amp;project=Linux-v4.7">out_unlock</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2618" name=2618>2618</A>			}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2619" name=2619>2619</A>		} <B>else</B> {<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2620" name=2620>2620</A>			<SPAN class=c>/* wait in queue */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2621" name=2621>2621</A>			<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> == <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2622" name=2622>2622</A>			<A href="http://172.29.26.110:8080/source/s?defs=list_add_tail&amp;project=Linux-v4.7">list_add_tail</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>, &amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_queue">flusher_queue</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2623" name=2623>2623</A>			<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_workqueue_prep_pwqs">flush_workqueue_prep_pwqs</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>, -<SPAN class=n>1</SPAN>, <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2624" name=2624>2624</A>		}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2625" name=2625>2625</A>	} <B>else</B> {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2626" name=2626>2626</A>		<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2627" name=2627>2627</A>		 * Oops, color space is full, wait on overflow queue.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2628" name=2628>2628</A>		 * The next flush completion will assign us<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2629" name=2629>2629</A>		 * flush_color and transfer to flusher_queue.<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2630" name=2630>2630</A>		 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2631" name=2631>2631</A>		<A href="http://172.29.26.110:8080/source/s?defs=list_add_tail&amp;project=Linux-v4.7">list_add_tail</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>, &amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2632" name=2632>2632</A>	}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2633" name=2633>2633</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2634" name=2634>2634</A>	<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#check_flush_dependency">check_flush_dependency</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>, <A href="http://172.29.26.110:8080/source/s?defs=NULL&amp;project=Linux-v4.7">NULL</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2635" name=2635>2635</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2636" name=2636>2636</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_unlock&amp;project=Linux-v4.7">mutex_unlock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2637" name=2637>2637</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2638" name=2638>2638</A>	<A href="http://172.29.26.110:8080/source/s?defs=wait_for_completion&amp;project=Linux-v4.7">wait_for_completion</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=done&amp;project=Linux-v4.7">done</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2639" name=2639>2639</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2640" name=2640>2640</A>	<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2641" name=2641>2641</A>	 * Wake-up-and-cascade phase<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2642" name=2642>2642</A>	 *<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2643" name=2643>2643</A>	 * First flushers are responsible for cascading flushes and<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2644" name=2644>2644</A>	 * handling overflow.  Non-first flushers can simply return.</P>
<P>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2645" name=2645>2645</A>	 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2646" name=2646>2646</A>	<B>if</B> (<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> != &amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2647" name=2647>2647</A>		<B>return</B>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2648" name=2648>2648</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2649" name=2649>2649</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_lock&amp;project=Linux-v4.7">mutex_lock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2650" name=2650>2650</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2651" name=2651>2651</A>	<SPAN class=c>/* we might have raced, check again with mutex held */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2652" name=2652>2652</A>	<B>if</B> (<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> != &amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2653" name=2653>2653</A>		<B>goto</B> <A href="http://172.29.26.110:8080/source/s?defs=out_unlock&amp;project=Linux-v4.7">out_unlock</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2654" name=2654>2654</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2655" name=2655>2655</A>	<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> = <A href="http://172.29.26.110:8080/source/s?defs=NULL&amp;project=Linux-v4.7">NULL</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2656" name=2656>2656</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2657" name=2657>2657</A>	<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(!<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>));<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2658" name=2658>2658</A>	<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#this_flusher">this_flusher</A>.<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2659" name=2659>2659</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2660" name=2660>2660</A>	<B>while</B> (<B>true</B>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2661" name=2661>2661</A>		<B>struct</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#wq_flusher">wq_flusher</A> *<A class=xl name=next></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=next&amp;project=Linux-v4.7">next</A>, *<A class=xl name=tmp></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=tmp&amp;project=Linux-v4.7">tmp</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2662" name=2662>2662</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2663" name=2663>2663</A>		<SPAN class=c>/* complete all the flushers sharing the current flush color */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2664" name=2664>2664</A>		<A href="http://172.29.26.110:8080/source/s?defs=list_for_each_entry_safe&amp;project=Linux-v4.7">list_for_each_entry_safe</A>(<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>, <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#tmp">tmp</A>, &amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_queue">flusher_queue</A>, <A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2665" name=2665>2665</A>			<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2666" name=2666>2666</A>				<B>break</B>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2667" name=2667>2667</A>			<A href="http://172.29.26.110:8080/source/s?defs=list_del_init&amp;project=Linux-v4.7">list_del_init</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2668" name=2668>2668</A>			<A href="http://172.29.26.110:8080/source/s?defs=complete&amp;project=Linux-v4.7">complete</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=done&amp;project=Linux-v4.7">done</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2669" name=2669>2669</A>		}<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2670" name=2670>2670</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2671" name=2671>2671</A>		<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(!<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>) &amp;&amp;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2672" name=2672>2672</A>			&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#work_next_color">work_next_color</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>));<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2673" name=2673>2673</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2674" name=2674>2674</A>		<SPAN class=c>/* this flush_color is finished, advance by one */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2675" name=2675>2675</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#work_next_color">work_next_color</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2676" name=2676>2676</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2677" name=2677>2677</A>		<SPAN class=c>/* one color has been freed, handle overflow queue */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2678" name=2678>2678</A>		<B>if</B> (!<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>)) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2679" name=2679>2679</A>			<SPAN class=c>/*<BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2680" name=2680>2680</A>			 * Assign the same color to all overflowed<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2681" name=2681>2681</A>			 * flushers, advance work_color and append to<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2682" name=2682>2682</A>			 * flusher_queue.&nbsp; This is the start-to-wait<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2683" name=2683>2683</A>			 * phase for these overflowed flushers.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2684" name=2684>2684</A>			 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2685" name=2685>2685</A>			<A href="http://172.29.26.110:8080/source/s?defs=list_for_each_entry&amp;project=Linux-v4.7">list_for_each_entry</A>(<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#tmp">tmp</A>, &amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>, <A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>)<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2686" name=2686>2686</A>				<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#tmp">tmp</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> = <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2687" name=2687>2687</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2688" name=2688>2688</A>			<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#work_next_color">work_next_color</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2689" name=2689>2689</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2690" name=2690>2690</A>			<A href="http://172.29.26.110:8080/source/s?defs=list_splice_tail_init&amp;project=Linux-v4.7">list_splice_tail_init</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_overflow">flusher_overflow</A>,<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2691" name=2691>2691</A>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_queue">flusher_queue</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2692" name=2692>2692</A>			<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_workqueue_prep_pwqs">flush_workqueue_prep_pwqs</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>, -<SPAN class=n>1</SPAN>, <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2693" name=2693>2693</A>		}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2694" name=2694>2694</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2695" name=2695>2695</A>		<B>if</B> (<A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flusher_queue">flusher_queue</A>)) {<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2696" name=2696>2696</A>			<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2697" name=2697>2697</A>			<B>break</B>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2698" name=2698>2698</A>		}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2699" name=2699>2699</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2700" name=2700>2700</A>		<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2701" name=2701>2701</A>		 * Need to flush more colors.&nbsp; Make the next flusher<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2702" name=2702>2702</A>		 * the new first flusher and arm pwqs.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2703" name=2703>2703</A>		 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2704" name=2704>2704</A>		<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> == <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=work_color&amp;project=Linux-v4.7">work_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2705" name=2705>2705</A>		<A href="http://172.29.26.110:8080/source/s?defs=WARN_ON_ONCE&amp;project=Linux-v4.7">WARN_ON_ONCE</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A> != <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2706" name=2706>2706</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2707" name=2707>2707</A>		<A href="http://172.29.26.110:8080/source/s?defs=list_del_init&amp;project=Linux-v4.7">list_del_init</A>(&amp;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=list&amp;project=Linux-v4.7">list</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2708" name=2708>2708</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> = <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#next">next</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2709" name=2709>2709</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2710" name=2710>2710</A>		<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_workqueue_prep_pwqs">flush_workqueue_prep_pwqs</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>, <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flush_color&amp;project=Linux-v4.7">flush_color</A>, -<SPAN class=n>1</SPAN>))<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2711" name=2711>2711</A>			<B>break</B>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2712" name=2712>2712</A><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2713" name=2713>2713</A>		<SPAN class=c>/*<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2714" name=2714>2714</A>		 * Meh... this color is already done, clear first<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2715" name=2715>2715</A>		 * flusher and repeat cascading.<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2716" name=2716>2716</A>		 */</SPAN><BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2717" name=2717>2717</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#first_flusher">first_flusher</A> = <A href="http://172.29.26.110:8080/source/s?defs=NULL&amp;project=Linux-v4.7">NULL</A>;<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2718" name=2718>2718</A>	}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2719" name=2719>2719</A><BR><A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2720" name=2720>2720</A><A href="http://172.29.26.110:8080/source/s?defs=out_unlock&amp;project=Linux-v4.7">out_unlock</A>:<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2721" name=2721>2721</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_unlock&amp;project=Linux-v4.7">mutex_unlock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2722" name=2722>2722</A>}<BR><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2723" name=2723>2723</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL&amp;project=Linux-v4.7">EXPORT_SYMBOL</A>(<A class=xv name=flush_workqueue></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=flush_workqueue&amp;project=Linux-v4.7">flush_workqueue</A>);</P>
<P>&nbsp;</P><PRE><A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2736" name=2736>2736</A><B>void</B> <A class=xf name=drain_workqueue></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=drain_workqueue&amp;project=Linux-v4.7">drain_workqueue</A>(<B>struct</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#workqueue_struct">workqueue_struct</A> *<A class=xa name=wq></A><A class=xa href="http://172.29.26.110:8080/source/s?refs=wq&amp;project=Linux-v4.7">wq</A>)
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2737" name=2737>2737</A>{
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2738" name=2738>2738</A>	<B>unsigned</B> <B>int</B> <A class=xl name=flush_cnt></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=flush_cnt&amp;project=Linux-v4.7">flush_cnt</A> = 0;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2739" name=2739>2739</A>	<B>struct</B> <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#pool_workqueue">pool_workqueue</A> *<A class=xl name=pwq></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=pwq&amp;project=Linux-v4.7">pwq</A>;
<A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2740" name=2740>2740</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2741" name=2741>2741</A>	<SPAN class=c>/*
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2742" name=2742>2742</A>	 * __queue_work() needs to test whether there are drainers, is much
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2743" name=2743>2743</A>	 * hotter than drain_workqueue() and already looks at @wq-&gt;flags.
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2744" name=2744>2744</A>	 * Use __WQ_DRAINING so that queue doesn't have to check nr_drainers.
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2745" name=2745>2745</A>	 */</SPAN>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2746" name=2746>2746</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_lock&amp;project=Linux-v4.7">mutex_lock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2747" name=2747>2747</A>	<B>if</B> (!<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#nr_drainers">nr_drainers</A>++)
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2748" name=2748>2748</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A> |= <A href="http://172.29.26.110:8080/source/s?defs=__WQ_DRAINING&amp;project=Linux-v4.7">__WQ_DRAINING</A>;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2749" name=2749>2749</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_unlock&amp;project=Linux-v4.7">mutex_unlock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);
<A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2750" name=2750>2750</A><A href="http://172.29.26.110:8080/source/s?defs=reflush&amp;project=Linux-v4.7">reflush</A>:
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2751" name=2751>2751</A>	<A href="http://172.29.26.110:8080/source/s?defs=flush_workqueue&amp;project=Linux-v4.7">flush_workqueue</A>(<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2752" name=2752>2752</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2753" name=2753>2753</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_lock&amp;project=Linux-v4.7">mutex_lock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2754" name=2754>2754</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2755" name=2755>2755</A>	<A class=xf name=for_each_pwq></A><A class=xf href="http://172.29.26.110:8080/source/s?refs=for_each_pwq&amp;project=Linux-v4.7">for_each_pwq</A>(<A href="http://172.29.26.110:8080/source/s?defs=pwq&amp;project=Linux-v4.7">pwq</A>, <A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>) {
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2756" name=2756>2756</A>		<B>bool</B> <A class=xl name=drained></A><A class=xl href="http://172.29.26.110:8080/source/s?refs=drained&amp;project=Linux-v4.7">drained</A>;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2757" name=2757>2757</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2758" name=2758>2758</A>		<A href="http://172.29.26.110:8080/source/s?defs=spin_lock_irq&amp;project=Linux-v4.7">spin_lock_irq</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=pwq&amp;project=Linux-v4.7">pwq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=pool&amp;project=Linux-v4.7">pool</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#lock">lock</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2759" name=2759>2759</A>		<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#drained">drained</A> = !<A href="http://172.29.26.110:8080/source/s?defs=pwq&amp;project=Linux-v4.7">pwq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#nr_active">nr_active</A> &amp;&amp; <A href="http://172.29.26.110:8080/source/s?defs=list_empty&amp;project=Linux-v4.7">list_empty</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=pwq&amp;project=Linux-v4.7">pwq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#delayed_works">delayed_works</A>);
<A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2760" name=2760>2760</A>		<A href="http://172.29.26.110:8080/source/s?defs=spin_unlock_irq&amp;project=Linux-v4.7">spin_unlock_irq</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=pwq&amp;project=Linux-v4.7">pwq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=pool&amp;project=Linux-v4.7">pool</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#lock">lock</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2761" name=2761>2761</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2762" name=2762>2762</A>		<B>if</B> (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#drained">drained</A>)
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2763" name=2763>2763</A>			<B>continue</B>;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2764" name=2764>2764</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2765" name=2765>2765</A>		<B>if</B> (++<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_cnt">flush_cnt</A> == <SPAN class=n>10</SPAN> ||
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2766" name=2766>2766</A>		    (<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_cnt">flush_cnt</A> % <SPAN class=n>100</SPAN> == 0 &amp;&amp; <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_cnt">flush_cnt</A> &lt;= <SPAN class=n>1000</SPAN>))
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2767" name=2767>2767</A>			<A href="http://172.29.26.110:8080/source/s?defs=pr_warn&amp;project=Linux-v4.7">pr_warn</A>(<SPAN class=s>"workqueue %s: drain_workqueue() isn't complete after %u tries\n"</SPAN>,
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2768" name=2768>2768</A>				<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=name&amp;project=Linux-v4.7">name</A>, <A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#flush_cnt">flush_cnt</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2769" name=2769>2769</A>
<A class=hl href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2770" name=2770>2770</A>		<A href="http://172.29.26.110:8080/source/s?defs=mutex_unlock&amp;project=Linux-v4.7">mutex_unlock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2771" name=2771>2771</A>		<B>goto</B> <A href="http://172.29.26.110:8080/source/s?defs=reflush&amp;project=Linux-v4.7">reflush</A>;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2772" name=2772>2772</A>	}
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2773" name=2773>2773</A>
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2774" name=2774>2774</A>	<B>if</B> (!--<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#nr_drainers">nr_drainers</A>)
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2775" name=2775>2775</A>		<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A href="http://172.29.26.110:8080/source/s?defs=flags&amp;project=Linux-v4.7">flags</A> &amp;= ~<A href="http://172.29.26.110:8080/source/s?defs=__WQ_DRAINING&amp;project=Linux-v4.7">__WQ_DRAINING</A>;
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2776" name=2776>2776</A>	<A href="http://172.29.26.110:8080/source/s?defs=mutex_unlock&amp;project=Linux-v4.7">mutex_unlock</A>(&amp;<A href="http://172.29.26.110:8080/source/s?defs=wq&amp;project=Linux-v4.7">wq</A>-&gt;<A class=d href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#mutex">mutex</A>);
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2777" name=2777>2777</A>}
<A class=l href="http://172.29.26.110:8080/source/xref/Linux-v4.7/kernel/workqueue.c#2778" name=2778>2778</A><A href="http://172.29.26.110:8080/source/s?defs=EXPORT_SYMBOL_GPL&amp;project=Linux-v4.7">EXPORT_SYMBOL_GPL</A>(<A class=xv name=drain_workqueue></A><A class=xv href="http://172.29.26.110:8080/source/s?refs=drain_workqueue&amp;project=Linux-v4.7">drain_workqueue</A>);</PRE>