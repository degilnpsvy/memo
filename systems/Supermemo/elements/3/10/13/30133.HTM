<H5>platform device&#21644;platform driver&#30340;&#27880;&#20876; </H5>
<P>&#32467;&#21512;&#31532;3&#31456;&#30340;&#25551;&#36848;&#65292;platform device&#21644;platform driver&#30340;&#27880;&#20876;&#65292;&#30001;platform_device_add&#21644;platform_driver_register&#20004;&#20010;&#25509;&#21475;&#23454;&#38469;&#23454;&#29616;&#12290;&#20854;&#20869;&#37096;&#21160;&#20316;&#20998;&#21035;&#22914;&#19979;&#12290; </P>
<P>platform_device_add&#30340;&#20869;&#37096;&#21160;&#20316;&#65306; </P>
<BLOCKQUOTE>
<P>&#22914;&#26524;&#35813;&#35774;&#22791;&#27809;&#26377;&#25351;&#23450;&#29238;&#35774;&#22791;&#65292;&#23558;&#20854;&#29238;&#35774;&#22791;&#35774;&#32622;&#20026;platform_bus&#65292;&#21363;&#8220;/sys/devices/platform/&#8221;&#25152;&#20195;&#34920;&#30340;&#35774;&#22791;&#65292;&#36825;&#26102;&#35813;&#35774;&#22791;&#30340;sysfs&#30446;&#24405;&#21363;&#20026;&#8220;/sys/devices/platform/xxx_device&#8221;&#12290; </P>
<P>&#23558;&#35813;&#35774;&#22791;&#30340;bus&#25351;&#23450;&#20026;platform_bus_type&#65288;pdev-&gt;dev.bus = &amp;platform_bus_type&#65289;&#12290; </P>
<P>&#26681;&#25454;&#35774;&#22791;&#30340;ID&#65292;&#20462;&#25913;&#25110;&#32773;&#35774;&#32622;&#35774;&#22791;&#30340;&#21517;&#31216;&#12290;&#23545;&#20110;&#22810;&#20010;&#21516;&#21517;&#30340;&#35774;&#22791;&#65292;&#21487;&#20197;&#20351;&#29992;ID&#21306;&#20998;&#65292;&#22312;&#36825;&#37324;&#23558;&#23454;&#38469;&#21517;&#31216;&#20462;&#25913;&#20026;&#8220;name.id&#8221;&#30340;&#24418;&#24335;&#12290; </P>
<P>&#35843;&#29992;resource&#27169;&#22359;&#30340;insert_resource&#25509;&#21475;&#65292;&#23558;&#35813;&#35774;&#22791;&#38656;&#35201;&#20351;&#29992;&#30340;resource&#32479;&#19968;&#31649;&#29702;&#36215;&#26469;&#65288;<SPAN style="COLOR: rgb(255,0,0)">&#25105;&#20204;&#30693;&#36947;&#65292;&#22312;&#36825;&#20043;&#21069;&#65292;&#21482;&#26159;&#22768;&#26126;&#20102;&#26412;&#35774;&#22791;&#38656;&#35201;&#20351;&#29992;&#21738;&#20123;resource&#65292;&#20294;resource&#27169;&#22359;&#24182;&#19981;&#30693;&#24773;&#65292;&#20063;&#23601;&#26080;&#20174;&#31649;&#29702;&#65292;&#22240;&#27492;&#38656;&#35201;&#21578;&#30693;</SPAN>&#65289;&#12290; </P>
<P>&#35843;&#29992;device_add&#25509;&#21475;&#65292;&#23558;&#20869;&#23884;&#30340;struct device&#21464;&#37327;&#28155;&#21152;&#21040;&#20869;&#26680;&#20013;&#12290; </P></BLOCKQUOTE>
<P>platform_driver_register&#30340;&#20869;&#37096;&#21160;&#20316;&#65306; </P>
<BLOCKQUOTE>
<P>&#23558;&#35813;driver&#30340;bus&#25351;&#23450;&#20026;platform_bus_type&#65288;drv-&gt;driver.bus = &amp;platform_bus_type&#65289;&#12290; </P>
<P>&#22914;&#26524;&#35813;platform driver&#25552;&#20379;&#20102;probe&#12289;remove&#12289;shutdown&#31561;&#22238;&#35843;&#20989;&#25968;&#65292;&#23558;&#35813;&#23427;&#20869;&#23884;&#30340;struct driver&#21464;&#37327;&#30340;probe&#12289;remove&#12289;shutdown&#31561;&#25351;&#38024;&#65292;&#35774;&#32622;&#20026;platform&#27169;&#22359;&#25552;&#20379;&#20989;&#25968;&#65292;&#21253;&#25324;platform_drv_probe&#12289;platform_drv_remove&#21644;platform_drv_shutdown&#12290;&#22240;&#20026;probe&#31561;&#21160;&#20316;&#20250;&#20174;struct driver&#21464;&#37327;&#24320;&#22987;&#65292;&#32463;&#36807;platform_drv_xxx&#31561;&#25509;&#21475;&#30340;&#36716;&#25509;&#65292;&#23601;&#21487;&#20197;&#21040;&#36798;platform diver&#33258;&#36523;&#30340;&#22238;&#35843;&#20989;&#25968;&#20013;&#12290; </P>
<P>&#35843;&#29992;driver_register&#25509;&#21475;&#65292;&#23558;&#20869;&#23884;&#30340;struct driver&#21464;&#37327;&#28155;&#21152;&#21040;&#20869;&#26680;&#20013;&#12290;</P></BLOCKQUOTE>