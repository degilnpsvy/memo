#define tcg_qemu_tb_exec(...){/tcg/tcg.g}: Once the next TB is obtained, through all the processes as detailed above, the TB need to be executed. The TB is executed through tcg_qemu_tb_exec() in /exec-cpu.c. <BR>:644 <BR>next_tb = tcg_qemu_tb_exec(tc_ptr) <BR>:<BR>Infact tcg_qemu_tb_exec() is a macro function defined in /tcg/tcg.h<BR>:484 (in /tcg/tcg.h) <BR>extern uint8_t code_gen_prologue[]; <BR>:<BR>#define tcg_qemu_tb_exec(tb_ptr) ((long REGPARM(*)(void *)) code_gen_prologue)(tb_ptr) <BR>: <BR>To understand what happens in the above line of code, a good knowledge of function pointers is required. The following lines will elaborate on understanding this. <BR>It is well known that (int) var will explicitly convert a variable to type int. In the same sense ((long REGPARM (*)(void *)) is a type - pointer to a function that takes in void * parameter and returns a long. Here REGPARAM(*) is a GCC compiler-directive that causes parameter of a function to be passed through Registers instead of through the Stack.&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;... <BR>The intention of ((long REGPARM (*)(void *)) would have been clear if the functions name appeared in it as ((long REGPARM (*func_name)(void *)). However it was used here without a function name (but serves the purpose). When an array name is used, the array base address is obtained, and thus points (pointer) to the array. Therefore (function_pointer) array_name will cast the array pointer as function pointer.<BR>A function is called through its pointer as (*pointer_to_func)(args) therefore ((long REGPARM (*)(void *))code_gen_prologue)(tc_ptr) does a function call. <BR>It is seen that a &#8216;*' is missing in the above function call, but one can test to see that (*pointer_to_func)(args) and (pointer_to_func)(args) are equivalent. <BR>So the above explanation clarifies that code_gen_prologue, an array, is cast as function and executed. code_gen_prologue holds in it a function in binary form that takes in an argument tc_ptr and return a long which is the next TB. The function in code_gen_prologue is the Function Prologue (discussed in a previous section) that transfers control to the generated Host code pointed to by tc_ptr.
<P></P>
<P><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1114" name=1114>1114</A>#<B>ifdef</B> <A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=HAVE_TCG_QEMU_TB_EXEC&amp;project=qemu-latest">HAVE_TCG_QEMU_TB_EXEC</A><BR><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1115" name=1115>1115</A><A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=uintptr_t&amp;project=qemu-latest">uintptr_t</A> <A class=d style="TEXT-DECORATION: none; FONT-WEIGHT: bold; COLOR: rgb(153,0,153)" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#tcg_qemu_tb_exec">tcg_qemu_tb_exec</A>(<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=CPUArchState&amp;project=qemu-latest">CPUArchState</A> *<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=env&amp;project=qemu-latest">env</A>, <A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=uint8_t&amp;project=qemu-latest">uint8_t</A> *<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=tb_ptr&amp;project=qemu-latest">tb_ptr</A>);<BR><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1116" name=1116>1116</A>#<B>else</B><BR><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; BACKGROUND: orange; COLOR: yellow; TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1117" name=1117>1117</A># <B>define</B> <A class=xm style="TEXT-DECORATION: none; FONT-WEIGHT: bold; COLOR: rgb(204,102,102)" name=tcg_qemu_tb_exec></A><A class=xm style="TEXT-DECORATION: none; FONT-WEIGHT: bold; COLOR: rgb(204,102,102)" href="http://172.29.26.110:8080/source/s?refs=tcg_qemu_tb_exec&amp;project=qemu-latest">tcg_qemu_tb_exec</A>(<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=env&amp;project=qemu-latest">env</A>, <A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=tb_ptr&amp;project=qemu-latest">tb_ptr</A>) \<BR><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1118" name=1118>1118</A>&nbsp;&nbsp;&nbsp; ((<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=uintptr_t&amp;project=qemu-latest">uintptr_t</A> (*)(<B>void</B> *, <B>void</B> *))<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=tcg_ctx&amp;project=qemu-latest">tcg_ctx</A>.<A class=d style="TEXT-DECORATION: none; FONT-WEIGHT: bold; COLOR: rgb(153,0,153)" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#code_gen_prologue">code_gen_prologue</A>)(<A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=env&amp;project=qemu-latest">env</A>, <A style="TEXT-DECORATION: none; COLOR: rgb(32,32,98)" href="http://172.29.26.110:8080/source/s?defs=tb_ptr&amp;project=qemu-latest">tb_ptr</A>)<BR><A class=l style="TEXT-DECORATION: none; WIDTH: 6ex; COLOR: rgb(102,102,102); TEXT-ALIGN: right; DISPLAY: inline-block; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(221,221,221); MARGIN-RIGHT: 0.5ex" href="http://172.29.26.110:8080/source/xref/qemu-latest/tcg/tcg.h#1119" name=1119>1119</A>#<B>endif</B>