<B><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>E3.1.257 Vector</FONT></SPAN></B> 
<P></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>// Vector[]</FONT></SPAN></I></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>// ========</FONT></SPAN></I></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>(ExcInfo, <B>bits</B>(32)) Vector[<B>integer </B>exceptionNumber, <B>boolean </B>isSecure]</FONT></SPAN></P>
<P><I><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri>&nbsp;&nbsp;&nbsp; // Calculate the address of the entry in the vector table</FONT></SPAN></I></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN>vtor = <B>if </B>isSecure <B>then </B>VTOR_S <B>else </B>VTOR_NS;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN>addr = (vtor.TBLOFF:'0000000') + 4 * exceptionNumber;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN><EM>// Fetch the vector with the correct privilege and security</EM></FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN>(exc, vector) = MemA_with_priv_security(addr,4,AccType_VECTABLE,TRUE,isSecure);</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN><EM>// Faults that prevent the vector being fetched are terminal and prevent</EM></FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN><EM>// the exception being entered. They are therefore treated as HardFaults</EM></FONT></SPAN></P>
<P><FONT face=Calibri><SPAN><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN><STRONG>if </STRONG>exc.fault != NoFault <B>then</B></SPAN></FONT></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp;&nbsp;</EM><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN></FONT></SPAN>exc.isTerminal = TRUE;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp;&nbsp;</EM><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN></FONT></SPAN>exc.fault = HardFault;</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp;&nbsp;</EM><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN></FONT></SPAN>exc.isSecure = exc.isSecure || AIRCR.BFHFNMINS == '0';</FONT></SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp;&nbsp;</EM><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN></FONT></SPAN>HFSR.VECTTBL = '1';</FONT></SPAN></P>
<P><FONT face=Calibri><SPAN><SPAN lang=EN-US style="FONT-SIZE: 17.5pt; mso-bidi-font-size: 11.0pt"><FONT face=Calibri><EM>&nbsp;&nbsp;&nbsp; </EM></FONT></SPAN><STRONG>return </STRONG>(exc, vector);</SPAN></FONT>