<H3 class=section style="WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; LINE-HEIGHT: normal; FONT-STYLE: normal; FONT-FAMILY: Simsun; WHITE-SPACE: normal; LETTER-SPACING: normal; FONT-VARIANT: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">8.10<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_lock</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_unlock</CODE>&#8212;lock time zone global variables</H3>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px"><A name=index-g_t_005f_005ftz_005flock-441></A><A name=index-g_t_005f_005ftz_005funlock-442></A><STRONG>Synopsis</STRONG></P><PRE class=example style="FONT-WEIGHT: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; LINE-HEIGHT: normal; FONT-STYLE: normal; LETTER-SPACING: normal; FONT-VARIANT: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">     #include "local.h"
     void __tz_lock (void);
     void __tz_unlock (void);
     
</PRE>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px"><STRONG>Description</STRONG><BR>The<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>tzset</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>facility functions call these functions when they need to ensure the values of global variables. The version of these routines supplied in the library use the lock API defined in sys/lock.h. If multiple threads of execution can call the time functions and give up scheduling in the middle, then you you need to define your own versions of these functions in order to safely lock the time zone variables during a call. If you do not, the results of<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>localtime</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>mktime</CODE>,<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>ctime</CODE>, and<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>strftime</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>are undefined.</P>
<P style="WORD-SPACING: 0px; FONT: medium Simsun; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: auto; -webkit-text-stroke-width: 0px">The lock<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_lock</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>may not be called recursively; that is, a call<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_lock</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>will always lock all subsequent<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_lock</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>calls until the corresponding<SPAN class=Apple-converted-space>&nbsp;</SPAN><CODE>__tz_unlock</CODE><SPAN class=Apple-converted-space>&nbsp;</SPAN>call on the same thread is made.</P><BR class=Apple-interchange-newline>